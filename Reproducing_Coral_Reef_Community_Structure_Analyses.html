<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Reproducing Coral Reef Community Structure Analyses</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/clipboard/clipboard.min.js"></script>
<script src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/quarto-html/quarto.js"></script>
<script src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/quarto-html/popper.min.js"></script>
<script src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/quarto-html/anchor.min.js"></script>
<link href="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="Reproducing_Coral_Reef_Community_Structure_Analyses_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">



</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Reproducing Coral Reef Community Structure Analyses</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="installing-missing-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-missing-packages">Installing Missing Packages</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 70 - 85</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## install packages from source code</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("devtools") # if you need to install this package</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library("devtools")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install_github("vqv/ggbiplot")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Used packages that need to be installed to run code (and can be sourced easier from CRAN):</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>needed_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"devtools"</span>, <span class="st">"knitr"</span>, <span class="st">"readr"</span>, <span class="st">"broom"</span>, <span class="st">"ggplot2"</span>, <span class="st">"dplyr"</span>, <span class="st">"ggbiplot"</span>, <span class="st">"tidyr"</span>, <span class="st">"corrgram"</span>, <span class="st">"openxlsx"</span>, <span class="st">"plotly"</span>, <span class="st">"tidyverse"</span>, <span class="st">"vegan"</span>, <span class="st">"shiny"</span>, <span class="st">"Rmisc"</span>, <span class="st">"cowplot"</span>, <span class="st">"ggfortify"</span>, <span class="st">"finalfit"</span>, <span class="st">"kableExtra"</span>, <span class="st">"readr"</span>, <span class="st">"lmerTest"</span>, <span class="st">"vroom"</span>, <span class="st">"ggpubr"</span>, <span class="st">"magick"</span>, <span class="st">"Hmisc"</span>, <span class="st">"corrplot"</span>, <span class="st">"gridGraphics"</span>, <span class="st">"grid"</span>, <span class="st">"RColorBrewer"</span>, <span class="st">"wesanderson"</span>, <span class="st">"performance"</span>, <span class="st">"MASS"</span>, <span class="st">"png"</span>, <span class="st">"car"</span>, <span class="st">"rcompanion"</span>, <span class="st">"janitor"</span>, <span class="st">"ncdf4"</span>, <span class="st">"raster"</span>, <span class="st">"xts"</span>, <span class="st">"ggrepel"</span>) <span class="co"># Specify necessary packages</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>not_installed <span class="ot">&lt;-</span> needed_packages[<span class="sc">!</span>(needed_packages <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[ , <span class="st">"Package"</span>])] <span class="co"># Extract not installed packages) # Install not installed packages</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(not_installed)) <span class="fu">install.packages</span>(not_installed) <span class="co"># Install not installed packages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No issues to report, all packages installed as expected. When run a second time, not_installed list was empty and no packages attempted to install.</p>
</section>
<section id="loading-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-packages">Loading Packages</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 87 - 133</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Packages to load</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrgram)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalfit)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vroom)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridGraphics)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wesanderson)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(png)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ncdf4)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Source the custom functions necessary for running this script</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a> <span class="fu">source</span>(<span class="st">"Code/CustomFunctions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All libraries loaded correctly. As this file is not connected to the GitHub repository at the moment, the source for the custom functions did not load. I have two options to contine: I can load the functions in directly, or I can directly source from the GitHub Repository. The latter is preferred, so I will proceed with that method.</p>
<p>First, I cloned the github repository to my local environment with the following line:</p>
<p>git clone https://github.com/seabove7/Bove_CoralPhysiology/</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Packages to load</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrgram)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalfit)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vroom)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridGraphics)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wesanderson)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(png)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ncdf4)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Source the custom functions necessary for running this script</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Bove_CoralPhysiology/Code/CustomFunctions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After cloning and adding the downloaded respository Bove_CoralPhysiology before the line, I have successfully sourced the code.</p>
</section>
<section id="formatting" class="level2">
<h2 class="anchored" data-anchor-id="formatting">Formatting</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 163 - 229</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set some standards and units</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dodge width</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>dodge<span class="ot">=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.3</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>dodge2<span class="ot">=</span><span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.6</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>jitter<span class="ot">=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># set figure theme</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_pubr</span>())</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># set parameter labels</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>Tlab<span class="ot">&lt;-</span><span class="st">"Temperature (°C)"</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>alab<span class="ot">&lt;-</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"p"</span>),<span class="st">"CO"</span> [<span class="dv">2</span>]<span class="sc">~</span> <span class="st">"("</span><span class="sc">*</span>mu,<span class="st">'atm)'</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>dlab<span class="ot">&lt;-</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Cell density (10"</span><span class="sc">^</span><span class="dv">6</span>,<span class="st">"cells cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>plab<span class="ot">&lt;-</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Total protein (mg cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>calab<span class="ot">&lt;-</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Carbohydrate (mg cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>clab<span class="ot">&lt;-</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Chlorophyll a ("</span><span class="sc">*</span>mu,<span class="st">"g cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>rlab<span class="ot">&lt;-</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Calcification rate (mg cm"</span><span class="sc">^-</span><span class="dv">2</span><span class="sc">~</span><span class="st">"day"</span><span class="sc">^-</span><span class="dv">1</span>,<span class="st">")"</span>))</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>llab<span class="ot">&lt;-</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Total Lipid (mg cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>hlab<span class="ot">&lt;-</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Total Host (mg cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># set the current date</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>date <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything performs as expected</p>
</section>
<section id="reading-in-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-in-data">Reading in data</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 135 - 161</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a> df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Raw_data/phys_all_23March2021.csv"</span>)[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># read in full dataframe</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rename a couple columns</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">38</span>]<span class="ot">&lt;-</span><span class="st">"carb"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">39</span>]<span class="ot">&lt;-</span><span class="st">"lipid"</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">17</span>]<span class="ot">&lt;-</span><span class="st">"sum"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">34</span>]<span class="ot">&lt;-</span><span class="st">"red"</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set columns as factors</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ftemp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>ftemp)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>fpco2)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>colony <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>colony)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>species, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"P"</span>, <span class="st">"A"</span>, <span class="st">"T"</span>)) <span class="co"># and reorder these</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># replace some pCO2 values with ones we will use moving forward</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"2800"</span>, <span class="st">"3290"</span>, df<span class="sc">$</span>fpco2)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"280"</span>, <span class="st">"300"</span>, df<span class="sc">$</span>fpco2)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"400"</span>, <span class="st">"420"</span>, df<span class="sc">$</span>fpco2)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"700"</span>, <span class="st">"680"</span>, df<span class="sc">$</span>fpco2)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder factors for pCO2 and temp</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>fpco2, <span class="fu">c</span>(<span class="st">"420"</span>, <span class="st">"T0"</span>, <span class="st">"300"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ftemp <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>ftemp, <span class="fu">c</span>(<span class="st">"28"</span>, <span class="st">"T0"</span>, <span class="st">"31"</span>))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate phys parameters</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>den <span class="ot">&lt;-</span> (df<span class="sc">$</span>den <span class="sc">/</span> <span class="dv">1000000</span>) <span class="co"># adjust symbiont density to display 10^6 cells</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>chla <span class="ot">&lt;-</span> (df<span class="sc">$</span>chla <span class="sc">/</span> df<span class="sc">$</span>SA) <span class="co"># standardize chla to surface area</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>host <span class="ot">&lt;-</span> df<span class="sc">$</span>pro <span class="sc">+</span> df<span class="sc">$</span>carb <span class="sc">+</span> df<span class="sc">$</span>lipid <span class="co"># calculate total host energy reserves (sum of carb, protein, lipids)</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat[df<span class="sc">$</span>T0_T90 <span class="sc">==</span> <span class="st">"T0"</span>] <span class="ot">&lt;-</span> <span class="st">"T0"</span> <span class="co"># replace T0 'treat' with T0 text</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>treat, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"T0"</span>, <span class="st">"288_28"</span>, <span class="st">"311_31"</span>, <span class="st">"447_28"</span>, <span class="st">"405_31"</span>, <span class="st">"673_28"</span>, <span class="st">"701_31"</span>, <span class="st">"3285_28"</span>, <span class="st">"3309_31"</span>),</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"T0"</span>, <span class="st">"300_28"</span>, <span class="st">"300_31"</span>, <span class="st">"420_28"</span>, <span class="st">"420_31"</span>, <span class="st">"680_28"</span>, <span class="st">"680_31"</span>, <span class="st">"3290_28"</span>, <span class="st">"3290_31"</span>)) <span class="co"># adjust treatment levels</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co"># add a new treat column for plotting (replacing actual treatment with number for better plotting - see plot XX)</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> df<span class="sc">$</span>treat</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"T0"</span>, <span class="dv">2</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"300_28"</span>, <span class="dv">4</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"300_31"</span>, <span class="dv">4</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"420_28"</span>, <span class="dv">6</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"420_31"</span>, <span class="dv">6</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"680_28"</span>, <span class="dv">8</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"680_31"</span>, <span class="dv">8</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"3290_28"</span>, <span class="dv">10</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"3290_31"</span>, <span class="dv">10</span>, df<span class="sc">$</span>treat)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>treat) <span class="co"># convert 'treat' column to numerics (again, this is for plotting only)</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse of colors (so lower color depicts more bleached coral)</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sum <span class="ot">&lt;-</span> (df<span class="sc">$</span>sum <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>red <span class="ot">&lt;-</span> (df<span class="sc">$</span>red <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>blue_bw5 <span class="ot">&lt;-</span> (df<span class="sc">$</span>blue_bw5 <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>green_bw5 <span class="ot">&lt;-</span> (df<span class="sc">$</span>green_bw5 <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="do">## modify dataframe for simplified version</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="dv">41</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">37</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">42</span><span class="sc">:</span><span class="dv">43</span>, <span class="dv">17</span>)] <span class="co"># select columns of interest only</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">gather</span>(df2, param, value, den<span class="sc">:</span>sum) <span class="co"># make column of parameter and value</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>param <span class="ot">&lt;-</span> <span class="fu">factor</span>(df2<span class="sc">$</span>param, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pro"</span>, <span class="st">"carb"</span>, <span class="st">"lipid"</span>, <span class="st">"den"</span>, <span class="st">"chla"</span>, <span class="st">"host"</span>, <span class="st">"count"</span>)) <span class="co"># reorder parameters</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">revalue</span>(<span class="at">x =</span> df2<span class="sc">$</span>species, <span class="fu">c</span>(<span class="st">"S"</span> <span class="ot">=</span> <span class="st">"SSID"</span>, <span class="st">"P"</span> <span class="ot">=</span> <span class="st">"PSTR"</span>, <span class="st">"A"</span> <span class="ot">=</span> <span class="st">"PAST"</span>, <span class="st">"T"</span> <span class="ot">=</span> <span class="st">"UTEN"</span>)) <span class="co"># rename the species codes</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2, species <span class="sc">!=</span> <span class="st">"UTEN"</span>) <span class="co"># remove UTEN (omitted due to high mortality in some treatments)</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="do">## remote T0 samples from dataframe for models</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>df2_T90 <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2, T0_T90 <span class="sc">==</span> <span class="st">"T90"</span>)</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="do">## add treatment column</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>df2_T90<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(df2_T90<span class="sc">$</span>fpco2, df2_T90<span class="sc">$</span>temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dataframe was not read in. The initial directory must be added because of the cloning process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Bove_CoralPhysiology/Data/Raw_data/phys_all_23March2021.csv"</span>)[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># read in full dataframe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 310 Columns: 42
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(10): coral, tank, treat, T0_T90, reef, species, col, fpco2, ftemp, colony dbl
(32): ...1, pco2, temp, SA, den, pro, chla, sum_bw5, red_bw1, green_bw1,...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename a couple columns</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">38</span>]<span class="ot">&lt;-</span><span class="st">"carb"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">39</span>]<span class="ot">&lt;-</span><span class="st">"lipid"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">17</span>]<span class="ot">&lt;-</span><span class="st">"sum"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">34</span>]<span class="ot">&lt;-</span><span class="st">"red"</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set columns as factors</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ftemp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>ftemp)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>fpco2)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>colony <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>colony)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>species, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"P"</span>, <span class="st">"A"</span>, <span class="st">"T"</span>)) <span class="co"># and reorder these</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># replace some pCO2 values with ones we will use moving forward</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"2800"</span>, <span class="st">"3290"</span>, df<span class="sc">$</span>fpco2)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"280"</span>, <span class="st">"300"</span>, df<span class="sc">$</span>fpco2)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"400"</span>, <span class="st">"420"</span>, df<span class="sc">$</span>fpco2)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"700"</span>, <span class="st">"680"</span>, df<span class="sc">$</span>fpco2)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder factors for pCO2 and temp</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>fpco2, <span class="fu">c</span>(<span class="st">"420"</span>, <span class="st">"T0"</span>, <span class="st">"300"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ftemp <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>ftemp, <span class="fu">c</span>(<span class="st">"28"</span>, <span class="st">"T0"</span>, <span class="st">"31"</span>))</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate phys parameters</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>den <span class="ot">&lt;-</span> (df<span class="sc">$</span>den <span class="sc">/</span> <span class="dv">1000000</span>) <span class="co"># adjust symbiont density to display 10^6 cells</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>chla <span class="ot">&lt;-</span> (df<span class="sc">$</span>chla <span class="sc">/</span> df<span class="sc">$</span>SA) <span class="co"># standardize chla to surface area</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>host <span class="ot">&lt;-</span> df<span class="sc">$</span>pro <span class="sc">+</span> df<span class="sc">$</span>carb <span class="sc">+</span> df<span class="sc">$</span>lipid <span class="co"># calculate total host energy reserves (sum of carb, protein, lipids)</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat[df<span class="sc">$</span>T0_T90 <span class="sc">==</span> <span class="st">"T0"</span>] <span class="ot">&lt;-</span> <span class="st">"T0"</span> <span class="co"># replace T0 'treat' with T0 text</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>treat, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"T0"</span>, <span class="st">"288_28"</span>, <span class="st">"311_31"</span>, <span class="st">"447_28"</span>, <span class="st">"405_31"</span>, <span class="st">"673_28"</span>, <span class="st">"701_31"</span>, <span class="st">"3285_28"</span>, <span class="st">"3309_31"</span>),</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"T0"</span>, <span class="st">"300_28"</span>, <span class="st">"300_31"</span>, <span class="st">"420_28"</span>, <span class="st">"420_31"</span>, <span class="st">"680_28"</span>, <span class="st">"680_31"</span>, <span class="st">"3290_28"</span>, <span class="st">"3290_31"</span>)) <span class="co"># adjust treatment levels</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># add a new treat column for plotting (replacing actual treatment with number for better plotting - see plot XX)</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> df<span class="sc">$</span>treat</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"T0"</span>, <span class="dv">2</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"300_28"</span>, <span class="dv">4</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"300_31"</span>, <span class="dv">4</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"420_28"</span>, <span class="dv">6</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"420_31"</span>, <span class="dv">6</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"680_28"</span>, <span class="dv">8</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"680_31"</span>, <span class="dv">8</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"3290_28"</span>, <span class="dv">10</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"3290_31"</span>, <span class="dv">10</span>, df<span class="sc">$</span>treat)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>treat) <span class="co"># convert 'treat' column to numerics (again, this is for plotting only)</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse of colors (so lower color depicts more bleached coral)</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sum <span class="ot">&lt;-</span> (df<span class="sc">$</span>sum <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>red <span class="ot">&lt;-</span> (df<span class="sc">$</span>red <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>blue_bw5 <span class="ot">&lt;-</span> (df<span class="sc">$</span>blue_bw5 <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>green_bw5 <span class="ot">&lt;-</span> (df<span class="sc">$</span>green_bw5 <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="do">## modify dataframe for simplified version</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="dv">41</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">37</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">42</span><span class="sc">:</span><span class="dv">43</span>, <span class="dv">17</span>)] <span class="co"># select columns of interest only</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">gather</span>(df2, param, value, den<span class="sc">:</span>sum) <span class="co"># make column of parameter and value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>param <span class="ot">&lt;-</span> <span class="fu">factor</span>(df2<span class="sc">$</span>param, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pro"</span>, <span class="st">"carb"</span>, <span class="st">"lipid"</span>, <span class="st">"den"</span>, <span class="st">"chla"</span>, <span class="st">"host"</span>, <span class="st">"count"</span>)) <span class="co"># reorder parameters</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">revalue</span>(<span class="at">x =</span> df2<span class="sc">$</span>species, <span class="fu">c</span>(<span class="st">"S"</span> <span class="ot">=</span> <span class="st">"SSID"</span>, <span class="st">"P"</span> <span class="ot">=</span> <span class="st">"PSTR"</span>, <span class="st">"A"</span> <span class="ot">=</span> <span class="st">"PAST"</span>, <span class="st">"T"</span> <span class="ot">=</span> <span class="st">"UTEN"</span>)) <span class="co"># rename the species codes</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2, species <span class="sc">!=</span> <span class="st">"UTEN"</span>) <span class="co"># remove UTEN (omitted due to high mortality in some treatments)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">## remote T0 samples from dataframe for models</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df2_T90 <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2, T0_T90 <span class="sc">==</span> <span class="st">"T90"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="do">## add treatment column</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>df2_T90<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(df2_T90<span class="sc">$</span>fpco2, df2_T90<span class="sc">$</span>temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With that adjustment, all errors are solved.</p>
</section>
<section id="bootstrap-model-setup" class="level2">
<h2 class="anchored" data-anchor-id="bootstrap-model-setup">Bootstrap model setup</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 231 - 238</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Performing the parametric bootstrapping of the model:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>bootnum <span class="ot">=</span> <span class="dv">1500</span> <span class="co"># set number of iterations (we used 2000) between 999 and 9999</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">=</span> <span class="dv">30</span> <span class="co"># seed to make results replicatable (our seed was 3)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Unclear on whether seeds and bootnumbers need to be changed. Based on the information given, I will redefine them to what the notes suggest and edit again if results are not identical.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Performing the parametric bootstrapping of the model:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>bootnum <span class="ot">=</span> <span class="dv">2000</span> <span class="co"># set number of iterations (we used 2000) between 999 and 9999</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">=</span> <span class="dv">3</span> <span class="co"># seed to make results replicatable (our seed was 3)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="separating-data-by-parameter" class="level2">
<h2 class="anchored" data-anchor-id="separating-data-by-parameter">Separating data by parameter</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 231 - 238</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a forloop to subset the data by each parameter and save as individual dataframes </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># make a list of parameter names</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>param_list <span class="ot">&lt;-</span> <span class="fu">levels</span>(df2_T90<span class="sc">$</span>param)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># forloop for dataframes</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(param_list)) {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  param_select <span class="ot">&lt;-</span> param_list[p]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  df_subset <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2_T90, param <span class="sc">==</span> param_select) <span class="co"># subset the dataframe for only one parameter</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  df_subset <span class="ot">&lt;-</span> <span class="fu">completeFun</span>(df_subset, <span class="st">"value"</span>) <span class="co"># run function to remove any missing values</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  df_subset<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(df_subset<span class="sc">$</span>value)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  df_subset<span class="sc">$</span>ftemp <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_subset<span class="sc">$</span>ftemp)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  df_subset<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_subset<span class="sc">$</span>fpco2)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  df_subset<span class="sc">$</span>colony <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_subset<span class="sc">$</span>colony)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  df_subset<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df_subset<span class="sc">$</span>species)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste</span>(param_select, <span class="st">"mod_df"</span>, <span class="at">sep =</span> <span class="st">"_"</span>), df_subset) <span class="co"># assign the data to dataframe named for each parameter </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected.</p>
</section>
<section id="creating-dataframes-for-sample-size-calculations" class="level2">
<h2 class="anchored" data-anchor-id="creating-dataframes-for-sample-size-calculations">Creating Dataframes (for Sample Size Calculations)</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 262 - 278</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_withT <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(T0_T90 <span class="sc">==</span> <span class="st">"T90"</span>) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df_90 <span class="ot">&lt;-</span> <span class="fu">subset</span>(df_withT, species <span class="sc">!=</span> <span class="st">"T"</span>) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df_90 <span class="ot">&lt;-</span> df_90[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">18</span><span class="sc">:</span><span class="dv">33</span>)]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>df_90 <span class="ot">&lt;-</span> <span class="fu">completeFun</span>(df_90, <span class="st">"den"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>df_90 <span class="ot">&lt;-</span> <span class="fu">completeFun</span>(df_90, <span class="st">"host"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>df_90 <span class="ot">&lt;-</span> <span class="fu">completeFun</span>(df_90, <span class="st">"lipid"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>df_90 <span class="ot">&lt;-</span> <span class="fu">completeFun</span>(df_90, <span class="st">"carb"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>df_90_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(df_90, param, value, <span class="dv">14</span><span class="sc">:</span><span class="dv">23</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="do">## specific species dataframes</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>s_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df_90, species <span class="sc">==</span> <span class="st">"S"</span>) </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>p_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df_90, species <span class="sc">==</span> <span class="st">"P"</span>) </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>a_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df_90, species <span class="sc">==</span> <span class="st">"A"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expectede</p>
</section>
<section id="pca" class="level2">
<h2 class="anchored" data-anchor-id="pca">PCA</h2>
<section id="pca-for-species-siderastrea-siderea" class="level3">
<h3 class="anchored" data-anchor-id="pca-for-species-siderastrea-siderea">PCA for species Siderastrea Siderea</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 290 - 315</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the dataframe</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>s_df <span class="ot">&lt;-</span> <span class="fu">unique</span>(s_df) <span class="co"># remove any duplicate rows</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>s_df_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(s_df, param, value, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>s_df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(s_df<span class="sc">$</span>fpco2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>sid_pca_df <span class="ot">&lt;-</span> s_df[,<span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>sid_pca_df <span class="ot">&lt;-</span> <span class="fu">rename</span>(sid_pca_df, <span class="at">colour =</span> sum) <span class="co"># renaming the 'sum' column to 'colour'</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run the adonis</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>s_pca_mod_full <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(sid_pca_df <span class="sc">~</span> reef <span class="sc">*</span> ftemp <span class="sc">*</span> fpco2, <span class="at">data =</span> s_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum) <span class="co"># below is the model with non sig interactions removed:</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>s_pca_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(sid_pca_df <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef, <span class="at">data =</span> s_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum, <span class="at">by =</span> <span class="st">"margin"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>s_pca_mod <span class="co"># view SSID adonis output</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># pull AIC from the full and reduced PERMANOVA models</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>s_pca_aic_full <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(s_pca_mod_full)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>s_pca_aic_final <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(s_pca_mod)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pvalues</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>s_pval <span class="ot">&lt;-</span> s_pca_mod[<span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># perform principal component analysis (PCA)</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>s_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(sid_pca_df, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Error caught in line 297 of renaming column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the dataframe</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>s_df <span class="ot">&lt;-</span> <span class="fu">unique</span>(s_df) <span class="co"># remove any duplicate rows</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>s_df_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(s_df, param, value, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>s_df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(s_df<span class="sc">$</span>fpco2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>sid_pca_df <span class="ot">&lt;-</span> s_df[,<span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>sid_pca_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(sid_pca_df, <span class="at">colour =</span> sum) <span class="co"># renaming the 'sum' column to 'colour'</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run the adonis</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>s_pca_mod_full <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(sid_pca_df <span class="sc">~</span> reef <span class="sc">*</span> ftemp <span class="sc">*</span> fpco2, <span class="at">data =</span> s_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum) <span class="co"># below is the model with non sig interactions removed:</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>s_pca_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(sid_pca_df <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef, <span class="at">data =</span> s_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum, <span class="at">by =</span> <span class="st">"margin"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>s_pca_mod <span class="co"># view SSID adonis output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 2000

adonis2(formula = sid_pca_df ~ fpco2 + ftemp + reef, data = s_df, permutations = bootnum, method = "eu", by = "margin")
         Df SumOfSqs      R2      F    Pr(&gt;F)    
fpco2     3    59423 0.20282 7.9334 0.0004998 ***
ftemp     1     9320 0.03181 3.7329 0.0459770 *  
reef      1    24705 0.08432 9.8948 0.0019990 ** 
Residual 80   199740 0.68174                     
Total    85   292988 1.00000                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pull AIC from the full and reduced PERMANOVA models</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>s_pca_aic_full <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(s_pca_mod_full)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>s_pca_aic_final <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(s_pca_mod)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pvalues</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>s_pval <span class="ot">&lt;-</span> s_pca_mod[<span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># perform principal component analysis (PCA)</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>s_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(sid_pca_df, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Specified dplyr package in case it used a different rename function. This renamed the variable in the dataframe so the change was successful. Everything runs as expected.</p>
<section id="pca-plot" class="level4">
<h4 class="anchored" data-anchor-id="pca-plot">PCA Plot</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 317 - 426</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create labels for p values calculated above</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>s_pco2_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[pCO[<span class="dv">2</span>]])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(s_pval[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>s_temp_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[temp])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(s_pval[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>s_reef_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[reef])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(s_pval[<span class="dv">3</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature = shape; pco2 = colours</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>s_pca_plot <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca, <span class="at">data =</span> s_df, </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame =</span> <span class="cn">FALSE</span>, </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_ellipse</span>(<span class="at">type =</span> <span class="st">"t"</span>, <span class="fu">aes</span>(<span class="at">colour =</span> fpco2)) <span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28 C"</span>, <span class="st">"31 C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>)) <span class="sc">+</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.7</span>, <span class="at">keywidth =</span> <span class="fl">0.1</span>, <span class="at">order =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.7</span>, <span class="at">keywidth =</span> <span class="fl">0.1</span>, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.338</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.39</span>, <span class="at">label =</span> <span class="fu">deparse</span>(s_temp_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.33</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.345</span>, <span class="at">label =</span> <span class="fu">deparse</span>(s_pco2_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.08</span>, <span class="fl">0.97</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>guide_pco2_color <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(s_pca_plot <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">shape =</span> <span class="st">"none"</span>)) <span class="co"># extract the temp colour legend</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>s_pca_plot <span class="ot">&lt;-</span> s_pca_plot <span class="sc">+</span> <span class="co"># add colour guide to new location and save</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(guide_pco2_color, <span class="at">xmax =</span> <span class="fl">0.78</span>, <span class="at">ymax =</span> <span class="sc">-</span><span class="fl">0.28</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># reef</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>s_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca, <span class="at">data =</span> s_df, </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.38</span>, <span class="at">label =</span> <span class="fu">deparse</span>(s_reef_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"A)   "</span>), <span class="fu">italic</span>(<span class="st">"S. siderea"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as
of ggplot2 3.3.4.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pco2 * temp</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>s_df<span class="sc">$</span>pco2_f <span class="ot">&lt;-</span> <span class="fu">factor</span>(s_df<span class="sc">$</span>pco2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial; 28C"</span>, <span class="st">"pre industrial; 31C"</span>, <span class="st">"current; 31C"</span>, <span class="st">"current; 28C"</span>, <span class="st">"end-of-century; 28C"</span>, <span class="st">"end-of-century; 31C"</span>, <span class="st">"extreme; 28C"</span>, <span class="st">"extreme; 31C"</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>s_pt_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca, <span class="at">data =</span> s_df, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.size =</span> <span class="dv">5</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#d1e5f0"</span>, <span class="st">"#fddbc7"</span>, <span class="st">"#f4a582"</span>, <span class="st">"#92c5de"</span>, <span class="st">"#4393c3"</span>, <span class="st">"#d6604d"</span>, <span class="st">"#2166ac"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#d1e5f0"</span>, <span class="st">"#fddbc7"</span>, <span class="st">"#f4a582"</span>, <span class="st">"#92c5de"</span>, <span class="st">"#4393c3"</span>, <span class="st">"#d6604d"</span>, <span class="st">"#2166ac"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="do">### Trying a single PCA with colour for pCO2 and shape for temp:</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ellipse by temp, points by pCO2</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="co"># s_temp_pca2 &lt;- autoplot(s_pca, data = s_df, </span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="co">#          colour = "fpco2",</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co">#          shape = "ftemp",</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co">#          frame = FALSE, </span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings = TRUE, </span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.colour = "grey29", </span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label = TRUE,</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.colour = "black",         </span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.size = 4, </span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.hjust = 1.5, </span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.vjust = 0.5,</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.repel = TRUE) +</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     stat_ellipse(type = "t", aes(lty = ftemp, colour = ftemp)) +</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_linetype_manual(values = c("solid", "dashed")) +</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_shape_manual("temperature", labels = c("28 C", "31 C"), values = c(19, 1)) +</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_color_manual("", labels = c("28 C", "31 C", "pre industrial", "current", "end-of-century", "extreme"), values = c("#4393c3", "#b2abd2", "#b2182b", "#5e3c99", "#fdb863", "#e66101")) +</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="co">#     guides(linetype = "none", shape = "none") +</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     guides(color = guide_legend(nrow = 2, override.aes = list(linetype = c(1, 2, 0, 0, 0, 0), shape = c(19, 1, 19, 19, 19, 19), colour = c("#4393c3", "#b2182b", "#b2abd2", "#5e3c99", "#fdb863", "#e66101")))) +</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.background = element_rect(fill = "transparent", color = NA), legend.position = "bottom")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="pca-for-species-pseudodiploria-strigosa" class="level3">
<h3 class="anchored" data-anchor-id="pca-for-species-pseudodiploria-strigosa">PCA for species Pseudodiploria strigosa</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 436 - 459</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the dataframe</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>p_df <span class="ot">&lt;-</span> <span class="fu">unique</span>(p_df) <span class="co"># remove duplicate rows</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>p_df_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(p_df, param, value, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>p_df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(p_df<span class="sc">$</span>fpco2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>dip_pca_df <span class="ot">&lt;-</span> p_df[,<span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)]</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>dip_pca_df <span class="ot">&lt;-</span> <span class="fu">rename</span>(dip_pca_df, <span class="at">colour =</span> sum) <span class="co"># renaming the 'sum' column to 'colour'</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run the adonis</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>p_pca_mod_full <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(dip_pca_df <span class="sc">~</span> reef <span class="sc">*</span> ftemp <span class="sc">*</span> fpco2, <span class="at">data =</span> p_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> <span class="dv">1000</span>) <span class="co"># below is the model with non sig interactions removed:</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>p_pca_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(dip_pca_df <span class="sc">~</span> reef <span class="sc">+</span> ftemp <span class="sc">+</span> fpco2, <span class="at">data =</span> p_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum, <span class="at">by =</span> <span class="st">"margin"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>p_pca_mod <span class="co"># view PSTR adonis output</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># pull AIC from the full and reduced PERMANOVA models</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>p_pca_aic_full <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(p_pca_mod_full)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>p_pca_aic_final <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(p_pca_mod)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pvalues</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>p_pval <span class="ot">&lt;-</span> p_pca_mod[<span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># perform principal component analysis (PCA)</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>p_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(dip_pca_df, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Error in rename function as before. Will specify dplyr package and that should solve the error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the dataframe</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>p_df <span class="ot">&lt;-</span> <span class="fu">unique</span>(p_df) <span class="co"># remove duplicate rows</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>p_df_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(p_df, param, value, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>p_df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(p_df<span class="sc">$</span>fpco2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>dip_pca_df <span class="ot">&lt;-</span> p_df[,<span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>dip_pca_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(dip_pca_df, <span class="at">colour =</span> sum) <span class="co"># renaming the 'sum' column to 'colour'</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># run the adonis</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>p_pca_mod_full <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(dip_pca_df <span class="sc">~</span> reef <span class="sc">*</span> ftemp <span class="sc">*</span> fpco2, <span class="at">data =</span> p_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> <span class="dv">1000</span>) <span class="co"># below is the model with non sig interactions removed:</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>p_pca_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(dip_pca_df <span class="sc">~</span> reef <span class="sc">+</span> ftemp <span class="sc">+</span> fpco2, <span class="at">data =</span> p_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum, <span class="at">by =</span> <span class="st">"margin"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>p_pca_mod <span class="co"># view PSTR adonis output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 2000

adonis2(formula = dip_pca_df ~ reef + ftemp + fpco2, data = p_df, permutations = bootnum, method = "eu", by = "margin")
         Df SumOfSqs      R2       F    Pr(&gt;F)    
reef      1   101796 0.09008 14.8653 0.0009995 ***
ftemp     1   519372 0.45958 75.8438 0.0004998 ***
fpco2     3    30444 0.02694  1.4819 0.2228886    
Residual 71   486202 0.43023                      
Total    76  1130099 1.00000                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pull AIC from the full and reduced PERMANOVA models</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>p_pca_aic_full <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(p_pca_mod_full)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>p_pca_aic_final <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(p_pca_mod)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pvalues</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>p_pval <span class="ot">&lt;-</span> p_pca_mod[<span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># perform principal component analysis (PCA)</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>p_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(dip_pca_df, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="pca-plot-1" class="level4">
<h4 class="anchored" data-anchor-id="pca-plot-1">PCA Plot</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 461 - 571</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create labels for p values calculated above</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>p_reef_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[reef])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(p_pval[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>p_temp_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[temp])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(p_pval[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>p_pco2_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[pCO[<span class="dv">2</span>]])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(p_pval[<span class="dv">3</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature = colour; pco2 = shape</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>p_pca_plot <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca, <span class="at">data =</span> p_df, </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame =</span> <span class="cn">FALSE</span>, </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">type =</span> <span class="st">"t"</span>, <span class="fu">aes</span>(<span class="at">colour =</span> ftemp)) <span class="sc">+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28 C"</span>, <span class="st">"31 C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.7</span>, <span class="at">keywidth =</span> <span class="fl">0.1</span>, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.7</span>, <span class="at">keywidth =</span> <span class="fl">0.1</span>, <span class="at">order =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.150</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.39</span>, <span class="at">label =</span> <span class="fu">deparse</span>(p_temp_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.155</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.33</span>, <span class="at">label =</span> <span class="fu">deparse</span>(p_pco2_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.08</span>, <span class="fl">0.97</span>))</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>guide_temp_color <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(p_pca_plot <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>)) <span class="co"># extract the temp colour legend</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>p_pca_plot <span class="ot">&lt;-</span> p_pca_plot <span class="sc">+</span> <span class="co"># add colour guide to new location and save</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">shape =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(guide_temp_color, <span class="at">xmax =</span> <span class="fl">0.7</span>, <span class="at">ymax =</span> <span class="sc">-</span><span class="fl">0.24</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co"># reef</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>p_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca, <span class="at">data =</span> p_df, </span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.38</span>, <span class="at">label =</span> <span class="fu">deparse</span>(p_reef_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"A)   "</span>), <span class="fu">italic</span>(<span class="st">"S. siderea"</span>))))</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a><span class="co"># pco2 * temp</span></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>p_df<span class="sc">$</span>pco2_f <span class="ot">&lt;-</span> <span class="fu">factor</span>(p_df<span class="sc">$</span>pco2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial; 28C"</span>, <span class="st">"pre industrial; 31C"</span>, <span class="st">"current; 31C"</span>, <span class="st">"current; 28C"</span>, <span class="st">"end-of-century; 28C"</span>, <span class="st">"end-of-century; 31C"</span>, <span class="st">"extreme; 28C"</span>, <span class="st">"extreme; 31C"</span>))</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>p_pt_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca, <span class="at">data =</span> p_df, </span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>                     <span class="at">shape =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame.size =</span> <span class="dv">5</span>,</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#d1e5f0"</span>, <span class="st">"#fddbc7"</span>, <span class="st">"#f4a582"</span>, <span class="st">"#92c5de"</span>, <span class="st">"#4393c3"</span>, <span class="st">"#d6604d"</span>, <span class="st">"#2166ac"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#d1e5f0"</span>, <span class="st">"#fddbc7"</span>, <span class="st">"#f4a582"</span>, <span class="st">"#92c5de"</span>, <span class="st">"#4393c3"</span>, <span class="st">"#d6604d"</span>, <span class="st">"#2166ac"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a><span class="do">### Trying a single PCA with colour for pCO2 and shape for temp:</span></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a><span class="co"># ellipse by temp, points by pCO2</span></span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a><span class="co"># p_temp_pca2 &lt;- autoplot(p_pca, data = p_df, </span></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a><span class="co">#          colour = "fpco2",</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a><span class="co">#          shape = "ftemp",</span></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a><span class="co">#          frame = FALSE, </span></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings = TRUE, </span></span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.colour = "grey29", </span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label = TRUE,</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.colour = "black",         </span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.size = 4, </span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.hjust = 1.5, </span></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.vjust = 0.5,</span></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.repel = TRUE) +</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a><span class="co">#     stat_ellipse(type = "t", aes(lty = ftemp, colour = ftemp)) +</span></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_linetype_manual(values = c("solid", "dashed")) +</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_shape_manual("temperature", labels = c("28 C", "31 C"), values = c(19, 1)) +</span></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_color_manual("", labels = c("28 C", "31 C", "pre industrial", "current", "end-of-century", "extreme"), values = c("#4393c3", "#b2abd2", "#b2182b", "#5e3c99", "#fdb863", "#e66101")) +</span></span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a><span class="co">#     guides(linetype = "none", shape = "none") +</span></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a><span class="co">#     guides(color = guide_legend(nrow = 2, override.aes = list(linetype = c(1, 2, 0, 0, 0, 0), shape = c(19, 1, 19, 19, 19, 19), colour = c("#4393c3", "#b2182b", "#b2abd2", "#5e3c99", "#fdb863", "#e66101")))) +</span></span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.background = element_rect(fill = "transparent", color = NA), legend.position = "bottom")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="pca-for-species-porites-astreoides" class="level3">
<h3 class="anchored" data-anchor-id="pca-for-species-porites-astreoides">PCA for species Porites astreoides</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 579 - 605</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the dataframe</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>a_df <span class="ot">&lt;-</span> <span class="fu">unique</span>(a_df)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>a_df <span class="ot">&lt;-</span> a_df[<span class="sc">-</span><span class="dv">17</span>,] <span class="co"># we have two from the same colony in 400_28 that are performing similarly so one is being removed (CFAD12)</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>a_df_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(a_df, param, value, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>a_df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(a_df<span class="sc">$</span>fpco2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>por_pca_df <span class="ot">&lt;-</span> a_df[,<span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>por_pca_df <span class="ot">&lt;-</span> <span class="fu">rename</span>(por_pca_df, <span class="at">colour =</span> red) <span class="co"># renaming the 'sum' column to 'colour'</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># run the adonis</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>a_pca_mod_full <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(por_pca_df <span class="sc">~</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">*</span> reef, <span class="at">data =</span> a_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> <span class="dv">1000</span>) <span class="co"># below is the model with non sig interactions removed:</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>a_pca_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(por_pca_df <span class="sc">~</span> reef <span class="sc">+</span> ftemp <span class="sc">+</span> fpco2, <span class="at">data =</span> a_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum, <span class="at">by =</span> <span class="st">"margin"</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>a_pca_mod <span class="co"># view PAST adonis output</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># pull AIC from the full and reduced PERMANOVA models</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>a_pca_aic_full <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(a_pca_mod_full)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>a_pca_aic_final <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(a_pca_mod)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pvalues</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>a_pval <span class="ot">&lt;-</span> a_pca_mod[<span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co"># perform principal component analysis (PCA)</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>a_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(por_pca_df, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Error will be solved with dplyr specification</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the dataframe</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>a_df <span class="ot">&lt;-</span> <span class="fu">unique</span>(a_df)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>a_df <span class="ot">&lt;-</span> a_df[<span class="sc">-</span><span class="dv">17</span>,] <span class="co"># we have two from the same colony in 400_28 that are performing similarly so one is being removed (CFAD12)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>a_df_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(a_df, param, value, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>a_df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(a_df<span class="sc">$</span>fpco2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>por_pca_df <span class="ot">&lt;-</span> a_df[,<span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>por_pca_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(por_pca_df, <span class="at">colour =</span> red) <span class="co"># renaming the 'sum' column to 'colour'</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># run the adonis</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>a_pca_mod_full <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(por_pca_df <span class="sc">~</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">*</span> reef, <span class="at">data =</span> a_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> <span class="dv">1000</span>) <span class="co"># below is the model with non sig interactions removed:</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>a_pca_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(por_pca_df <span class="sc">~</span> reef <span class="sc">+</span> ftemp <span class="sc">+</span> fpco2, <span class="at">data =</span> a_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum, <span class="at">by =</span> <span class="st">"margin"</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>a_pca_mod <span class="co"># view PAST adonis output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Marginal effects of terms
Permutation: free
Number of permutations: 2000

adonis2(formula = por_pca_df ~ reef + ftemp + fpco2, data = a_df, permutations = bootnum, method = "eu", by = "margin")
         Df SumOfSqs      R2       F    Pr(&gt;F)    
reef      1      724 0.00512  0.5264 0.4717641    
ftemp     1    27051 0.19129 19.6601 0.0004998 ***
fpco2     3    30537 0.21594  7.3978 0.0004998 ***
Residual 62    85309 0.60325                      
Total    67   141417 1.00000                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pull AIC from the full and reduced PERMANOVA models</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>a_pca_aic_full <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(a_pca_mod_full)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>a_pca_aic_final <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">AICc.PERMANOVA2</span>(a_pca_mod)[[<span class="dv">1</span>]], <span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pvalues</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>a_pval <span class="ot">&lt;-</span> a_pca_mod[<span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># perform principal component analysis (PCA)</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>a_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(por_pca_df, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="pca-plot-2" class="level4">
<h4 class="anchored" data-anchor-id="pca-plot-2">PCA Plot</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 607 - 714</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create labels for p values calculated above</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>a_reef_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[reef])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(a_pval[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>a_temp_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[temp])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(a_pval[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>a_pco2_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[pCO[<span class="dv">2</span>]])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(a_pval[<span class="dv">3</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature = shape; pco2 = colours</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>a_pca_plot <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca, <span class="at">data =</span> a_df, </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame =</span> <span class="cn">FALSE</span>, </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">type =</span> <span class="st">"t"</span>, <span class="fu">aes</span>(<span class="at">colour =</span> fpco2)) <span class="sc">+</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28 C"</span>, <span class="st">"31 C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>)) <span class="sc">+</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.41</span>, <span class="fl">0.4</span>), <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.7</span>, <span class="at">keywidth =</span> <span class="fl">0.1</span>, <span class="at">order =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.7</span>, <span class="at">keywidth =</span> <span class="fl">0.1</span>, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.235</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.408</span>, <span class="at">label =</span> <span class="fu">deparse</span>(a_temp_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.235</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.358</span>, <span class="at">label =</span> <span class="fu">deparse</span>(a_pco2_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.08</span>, <span class="fl">0.97</span>))</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>a_pca_plot <span class="ot">&lt;-</span> a_pca_plot <span class="sc">+</span> <span class="co"># add colour guide to new location and save</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(guide_pco2_color, <span class="at">xmax =</span> <span class="fl">0.98</span>, <span class="at">ymax =</span> <span class="sc">-</span><span class="fl">0.28</span>)</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="co"># reef</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>a_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca, <span class="at">data =</span> a_df, </span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.38</span>, <span class="at">label =</span> <span class="fu">deparse</span>(a_reef_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"A)   "</span>), <span class="fu">italic</span>(<span class="st">"S. siderea"</span>))))</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a><span class="co"># pco2 * temp</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>a_df<span class="sc">$</span>pco2_f <span class="ot">&lt;-</span> <span class="fu">factor</span>(a_df<span class="sc">$</span>pco2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial; 28C"</span>, <span class="st">"pre industrial; 31C"</span>, <span class="st">"current; 31C"</span>, <span class="st">"current; 28C"</span>, <span class="st">"end-of-century; 28C"</span>, <span class="st">"end-of-century; 31C"</span>, <span class="st">"extreme; 28C"</span>, <span class="st">"extreme; 31C"</span>))</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>a_pt_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca, <span class="at">data =</span> a_df, </span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>                     <span class="at">shape =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>                     <span class="at">frame.size =</span> <span class="dv">5</span>,</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#d1e5f0"</span>, <span class="st">"#fddbc7"</span>, <span class="st">"#f4a582"</span>, <span class="st">"#92c5de"</span>, <span class="st">"#4393c3"</span>, <span class="st">"#d6604d"</span>, <span class="st">"#2166ac"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#d1e5f0"</span>, <span class="st">"#fddbc7"</span>, <span class="st">"#f4a582"</span>, <span class="st">"#92c5de"</span>, <span class="st">"#4393c3"</span>, <span class="st">"#d6604d"</span>, <span class="st">"#2166ac"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a><span class="do">### Trying a single PCA with colour for pCO2 and shape for temp:</span></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a><span class="co"># ellipse by temp, points by pCO2</span></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a><span class="co"># a_temp_pca2 &lt;- autoplot(a_pca, data = a_df, </span></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a><span class="co">#          colour = "fpco2",</span></span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a><span class="co">#          shape = "ftemp",</span></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a><span class="co">#          frame = FALSE, </span></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings = TRUE, </span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.colour = "grey29", </span></span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label = TRUE,</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.colour = "black",         </span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.size = 4, </span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.hjust = 1.5, </span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.vjust = 0.5,</span></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a><span class="co">#          loadings.label.repel = TRUE) +</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a><span class="co">#     stat_ellipse(type = "t", aes(lty = ftemp, colour = ftemp)) +</span></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_linetype_manual(values = c("solid", "dashed")) +</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_shape_manual("temperature", labels = c("28 C", "31 C"), values = c(19, 1)) +</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_color_manual("", labels = c("28 C", "31 C", "pre industrial", "current", "end-of-century", "extreme"), values = c("#4393c3", "#b2abd2", "#b2182b", "#5e3c99", "#fdb863", "#e66101")) +</span></span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a><span class="co">#     guides(linetype = "none", shape = "none") +</span></span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a><span class="co">#     guides(color = guide_legend(nrow = 2, override.aes = list(linetype = c(1, 2, 0, 0, 0, 0), shape = c(19, 1, 19, 19, 19, 19), colour = c("#4393c3", "#b2182b", "#b2abd2", "#5e3c99", "#fdb863", "#e66101")))) +</span></span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.background = element_rect(fill = "transparent", color = NA), legend.position = "bottom")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="figure-1" class="level3">
<h3 class="anchored" data-anchor-id="figure-1">Figure 1</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 722 - 733</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(s_pca_plot, p_pca_plot, a_pca_plot, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)) <span class="sc">+</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/PCA%20plot-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure1_PhysPCA.pdf"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure1_PhysPCA.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure1_PhysPCA.tiff"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These figures are identical to those in the paper.</p>
</section>
<section id="total-pca" class="level3">
<h3 class="anchored" data-anchor-id="total-pca">Total PCA</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 741 - 760</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the dataframe</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>all_df <span class="ot">&lt;-</span> <span class="fu">unique</span>(df_90) <span class="co"># remove any duplicate rows</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>all_df_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(all_df, param, value, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>all_df<span class="sc">$</span>fpco2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_df<span class="sc">$</span>fpco2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"680"</span>, <span class="st">"3290"</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>all_pca_df <span class="ot">&lt;-</span> all_df[,<span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run the adonis</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#all_pca_mod &lt;- adonis2(all_pca_df ~ reef * ftemp * fpco2 * species, data = all_df, method = 'eu', permutations = bootnum) # below is the model with non sig interactions removed:</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>all_pca_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(all_pca_df <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef <span class="sc">+</span> species <span class="sc">+</span> ftemp<span class="sc">:</span>species <span class="sc">+</span> fpco2<span class="sc">:</span>species <span class="sc">+</span> reef<span class="sc">:</span>species, <span class="at">data =</span> all_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>all_pca_mod <span class="co"># view all adonis output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Permutation: free
Number of permutations: 2000

adonis2(formula = all_pca_df ~ fpco2 + ftemp + reef + species + ftemp:species + fpco2:species + reef:species, data = all_df, permutations = bootnum, method = "eu")
          Df SumOfSqs      R2    F    Pr(&gt;F)    
Model     17  2588852 0.66688 25.2 0.0004998 ***
Residual 214  1293204 0.33312                   
Total    231  3882055 1.00000                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pvalues</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>all_pval <span class="ot">&lt;-</span> all_pca_mod[<span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># perform principal component analysis (PCA)</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>all_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(all_pca_df, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="total-pca-plot" class="level4">
<h4 class="anchored" data-anchor-id="total-pca-plot">Total PCA Plot</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 762 - 849</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create labels for p values calculated above</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>all_pco2_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[pCO[<span class="dv">2</span>]])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(all_pval[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>all_temp_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[temp])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(all_pval[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>all_reef_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[reef])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(all_pval[<span class="dv">3</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>all_species_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[species])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(all_pval[<span class="dv">4</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>all_s_pco2_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[species<span class="sc">~</span>X<span class="sc">~</span>pCO[<span class="dv">2</span>]])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(all_pval[<span class="dv">5</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>all_s_reef_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[species<span class="sc">~</span>X<span class="sc">~</span>reef])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(all_pval[<span class="dv">6</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>)))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>all_s_temp_pval <span class="ot">&lt;-</span><span class="fu">substitute</span>(<span class="fu">italic</span>(P[species<span class="sc">~</span>X<span class="sc">~</span>temp])<span class="sc">==</span>p, <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">format</span>(all_pval[<span class="dv">7</span>,<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">1</span>)))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># species</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>species_pca_plot <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(all_pca, <span class="at">data =</span> all_df, </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">"species"</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#shape = "species",</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#shape = "fpco2",</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#fill = "species",               </span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"S. siderea"</span>, <span class="st">"P. strigosa"</span>, <span class="st">"P. astreoides"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#867796"</span>, <span class="st">"#73CCD2"</span>, <span class="st">"#D2D69B"</span>)) <span class="sc">+</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.1</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.16</span>, <span class="fl">0.9</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>)) <span class="sc">+</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.18</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.108</span>, <span class="at">label =</span> <span class="fu">deparse</span>(all_species_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>all_temp_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(all_pca, <span class="at">data =</span> all_df, </span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#shape = "fpco2",</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">"ftemp"</span>,               </span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>))<span class="sc">+</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"transparent"</span>))<span class="sc">+</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.11</span>, <span class="fl">0.9</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.19</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.118</span>, <span class="at">label =</span> <span class="fu">deparse</span>(all_temp_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.17</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.14</span>, <span class="at">label =</span> <span class="fu">deparse</span>(all_s_temp_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="co"># pco2</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>all_pco2_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(all_pca, <span class="at">data =</span> all_df, </span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#shape = "ftemp",</span></span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.19</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.118</span>, <span class="at">label =</span> <span class="fu">deparse</span>(all_pco2_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.17</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.14</span>, <span class="at">label =</span> <span class="fu">deparse</span>(all_s_pco2_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.18</span>, <span class="fl">0.9</span>), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="figure-4" class="level3">
<h3 class="anchored" data-anchor-id="figure-4">Figure 4</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 851 - 858</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(species_pca_plot, all_pco2_pca, all_temp_pca, <span class="at">nrow =</span><span class="dv">1</span>, <span class="at">labels =</span> <span class="st">"AUTO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/species%20PCA%20plot-1.png" class="img-fluid figure-img" width="1248"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure4_SpeciesPCA.pdf"</span>, <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure4_SpeciesPCA.png"</span>, <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure4_SpeciesPCA.tiff"</span>, <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="correlation-matrices-and-scatter-plots" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrices-and-scatter-plots">Correlation Matrices and Scatter Plots</h2>
<section id="correlation-matrix-ssid" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrix-ssid">Correlation Matrix SSID</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 893 - 914</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create new correlation dataframe for SSID</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>sid_corr_df <span class="ot">&lt;-</span> s_df[,<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">11</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shape =</span> <span class="fu">case_when</span>(ftemp <span class="sc">==</span> <span class="st">"28"</span> <span class="sc">~</span> <span class="st">"19"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                           ftemp <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"21"</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">case_when</span>(fpco2 <span class="sc">==</span> <span class="st">"300"</span> <span class="sc">~</span> <span class="st">"#b2abd2"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"#5e3c99"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"680"</span> <span class="sc">~</span> <span class="st">"#fdb863"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"3290"</span> <span class="sc">~</span> <span class="st">"#e66101"</span>))</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot correlation matrix and scatter plot of all SSID physiology  </span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">"Figures/Supplemental_Figures/SSID_PhysCorrelations.png"</span>, <span class="at">width =</span> <span class="fl">240.57</span>, <span class="at">height =</span> <span class="fl">164.025</span>, <span class="at">units=</span><span class="st">'mm'</span>, <span class="at">res =</span> <span class="dv">300</span>)  </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">corrgram</span>(sid_corr_df, <span class="at">order =</span> <span class="cn">FALSE</span>, <span class="at">lower.panel =</span> panel.fill.R2, <span class="at">upper.panel =</span> panel.pts.col, <span class="at">text.panel =</span> panel.txt.brdr,</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">col.regions =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#ffffcc"</span>, <span class="st">"#c7e9b4"</span>, <span class="st">"#225ea8"</span>)), </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> sid_corr_df<span class="sc">$</span>color, <span class="at">pch =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(sid_corr_df<span class="sc">$</span>shape)),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"symbiont </span><span class="sc">\n</span><span class="st">density"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">protein"</span>, <span class="st">"chlorophyll a"</span>, <span class="st">"color </span><span class="sc">\n</span><span class="st">intensity"</span>, <span class="st">"calcification </span><span class="sc">\n</span><span class="st">rate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">carbohydrate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">lipid"</span>)) </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Passing parameter %&gt;% brings up error. Switching to pipe operator |&gt; bypasses the error. Mutate function not found, fixed by specifying dplyr package. The same procedure was executed to fix the error on the case_when function. PNG unable to open, so I created a folder as described in line 1104 to allow png to resume. Corrgram function not found, so I specified that it was inside the corrgram package and the chunk fully ran.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create new correlation dataframe for SSID</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sid_corr_df <span class="ot">&lt;-</span> s_df[,<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">11</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)] <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">shape =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(ftemp <span class="sc">==</span> <span class="st">"28"</span> <span class="sc">~</span> <span class="st">"19"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                           ftemp <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"21"</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(fpco2 <span class="sc">==</span> <span class="st">"300"</span> <span class="sc">~</span> <span class="st">"#b2abd2"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"#5e3c99"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"680"</span> <span class="sc">~</span> <span class="st">"#fdb863"</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"3290"</span> <span class="sc">~</span> <span class="st">"#e66101"</span>))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot correlation matrix and scatter plot of all SSID physiology  </span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">"Figures/Supplemental_Figures/SSID_PhysCorrelations.png"</span>, <span class="at">width =</span> <span class="fl">240.57</span>, <span class="at">height =</span> <span class="fl">164.025</span>, <span class="at">units=</span><span class="st">'mm'</span>, <span class="at">res =</span> <span class="dv">300</span>)  </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>corrgram<span class="sc">::</span><span class="fu">corrgram</span>(sid_corr_df, <span class="at">order =</span> <span class="cn">FALSE</span>, <span class="at">lower.panel =</span> panel.fill.R2, <span class="at">upper.panel =</span> panel.pts.col, <span class="at">text.panel =</span> panel.txt.brdr,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">col.regions =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#ffffcc"</span>, <span class="st">"#c7e9b4"</span>, <span class="st">"#225ea8"</span>)), </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> sid_corr_df<span class="sc">$</span>color, <span class="at">pch =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(sid_corr_df<span class="sc">$</span>shape)),</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"symbiont </span><span class="sc">\n</span><span class="st">density"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">protein"</span>, <span class="st">"chlorophyll a"</span>, <span class="st">"color </span><span class="sc">\n</span><span class="st">intensity"</span>, <span class="st">"calcification </span><span class="sc">\n</span><span class="st">rate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">carbohydrate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">lipid"</span>)) </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-matrix-pstr" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrix-pstr">Correlation Matrix PSTR</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 916 - 938</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create new correlation dataframe for SSID</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>dip_corr_df <span class="ot">&lt;-</span> p_df[,<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">11</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shape =</span> <span class="fu">case_when</span>(ftemp <span class="sc">==</span> <span class="st">"28"</span> <span class="sc">~</span> <span class="st">"19"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                           ftemp <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"21"</span>),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">case_when</span>(fpco2 <span class="sc">==</span> <span class="st">"300"</span> <span class="sc">~</span> <span class="st">"#b2abd2"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"#5e3c99"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"680"</span> <span class="sc">~</span> <span class="st">"#fdb863"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"3290"</span> <span class="sc">~</span> <span class="st">"#e66101"</span>))</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot correlation matrix and scatter plot of all PSTR physiology</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">"Figures/Supplemental_Figures/PSTR_PhysCorrelations.png"</span>, <span class="at">width =</span> <span class="fl">240.57</span>, <span class="at">height =</span> <span class="fl">164.025</span>, <span class="at">units=</span><span class="st">'mm'</span>, <span class="at">res =</span> <span class="dv">300</span>) </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">corrgram</span>(dip_corr_df, <span class="at">order =</span> <span class="cn">FALSE</span>, <span class="at">lower.panel=</span>panel.fill.R2, <span class="at">upper.panel=</span>panel.pts.col, <span class="at">text.panel=</span>panel.txt.brdr,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">col.regions=</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#ffffcc"</span>, <span class="st">"#c7e9b4"</span>, <span class="st">"#225ea8"</span>)), </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> dip_corr_df<span class="sc">$</span>color, <span class="at">pch =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(dip_corr_df<span class="sc">$</span>shape)),</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"symbiont </span><span class="sc">\n</span><span class="st">density"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">protein"</span>, <span class="st">"chlorophyll a"</span>, <span class="st">"color </span><span class="sc">\n</span><span class="st">intensity"</span>, <span class="st">"calcification </span><span class="sc">\n</span><span class="st">rate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">carbohydrate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">lipid"</span>)) </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Same adjustments were made as in the previous example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create new correlation dataframe for SSID</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>dip_corr_df <span class="ot">&lt;-</span> p_df[,<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">11</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)] <span class="sc">|&gt;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">shape =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(ftemp <span class="sc">==</span> <span class="st">"28"</span> <span class="sc">~</span> <span class="st">"19"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                           ftemp <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"21"</span>),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(fpco2 <span class="sc">==</span> <span class="st">"300"</span> <span class="sc">~</span> <span class="st">"#b2abd2"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"#5e3c99"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"680"</span> <span class="sc">~</span> <span class="st">"#fdb863"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"3290"</span> <span class="sc">~</span> <span class="st">"#e66101"</span>))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot correlation matrix and scatter plot of all PSTR physiology</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">"Figures/Supplemental_Figures/PSTR_PhysCorrelations.png"</span>, <span class="at">width =</span> <span class="fl">240.57</span>, <span class="at">height =</span> <span class="fl">164.025</span>, <span class="at">units=</span><span class="st">'mm'</span>, <span class="at">res =</span> <span class="dv">300</span>) </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>corrgram<span class="sc">::</span><span class="fu">corrgram</span>(dip_corr_df, <span class="at">order =</span> <span class="cn">FALSE</span>, <span class="at">lower.panel=</span>panel.fill.R2, <span class="at">upper.panel=</span>panel.pts.col, <span class="at">text.panel=</span>panel.txt.brdr,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">col.regions=</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#ffffcc"</span>, <span class="st">"#c7e9b4"</span>, <span class="st">"#225ea8"</span>)), </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> dip_corr_df<span class="sc">$</span>color, <span class="at">pch =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(dip_corr_df<span class="sc">$</span>shape)),</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"symbiont </span><span class="sc">\n</span><span class="st">density"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">protein"</span>, <span class="st">"chlorophyll a"</span>, <span class="st">"color </span><span class="sc">\n</span><span class="st">intensity"</span>, <span class="st">"calcification </span><span class="sc">\n</span><span class="st">rate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">carbohydrate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">lipid"</span>)) </span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-matrix-past" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrix-past">Correlation matrix PAST</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 940 - 962</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create new correlation dataframe for SSID</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>por_corr_df <span class="ot">&lt;-</span> a_df[,<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">11</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">shape =</span> <span class="fu">case_when</span>(ftemp <span class="sc">==</span> <span class="st">"28"</span> <span class="sc">~</span> <span class="st">"19"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                           ftemp <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"21"</span>),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">case_when</span>(fpco2 <span class="sc">==</span> <span class="st">"300"</span> <span class="sc">~</span> <span class="st">"#b2abd2"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"#5e3c99"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"680"</span> <span class="sc">~</span> <span class="st">"#fdb863"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"3290"</span> <span class="sc">~</span> <span class="st">"#e66101"</span>))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot correlation matrix and scatter plot of all PAST physiology</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">"Figures/Supplemental_Figures/PAST_PhysCorrelations.png"</span>, <span class="at">width =</span> <span class="fl">240.57</span>, <span class="at">height =</span> <span class="fl">164.025</span>, <span class="at">units=</span><span class="st">'mm'</span>, <span class="at">res =</span> <span class="dv">300</span>) </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="fu">corrgram</span>(por_corr_df, <span class="at">order =</span> <span class="cn">FALSE</span>, <span class="at">lower.panel=</span>panel.fill.R2, <span class="at">upper.panel=</span>panel.pts.col, <span class="at">text.panel=</span>panel.txt.brdr,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">col.regions=</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#ffffcc"</span>, <span class="st">"#c7e9b4"</span>, <span class="st">"#225ea8"</span>)), </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> por_corr_df<span class="sc">$</span>color, <span class="at">pch =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(por_corr_df<span class="sc">$</span>shape)),</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"symbiont </span><span class="sc">\n</span><span class="st">density"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">protein"</span>, <span class="st">"chlorophyll a"</span>, <span class="st">"color </span><span class="sc">\n</span><span class="st">intensity"</span>, <span class="st">"calcification </span><span class="sc">\n</span><span class="st">rate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">carbohydrate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">lipid"</span>)) </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Same adjustments were made as in previous.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create new correlation dataframe for SSID</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>por_corr_df <span class="ot">&lt;-</span> a_df[,<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">11</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)] <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">shape =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(ftemp <span class="sc">==</span> <span class="st">"28"</span> <span class="sc">~</span> <span class="st">"19"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                           ftemp <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"21"</span>),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(fpco2 <span class="sc">==</span> <span class="st">"300"</span> <span class="sc">~</span> <span class="st">"#b2abd2"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"420"</span> <span class="sc">~</span> <span class="st">"#5e3c99"</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"680"</span> <span class="sc">~</span> <span class="st">"#fdb863"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                            fpco2 <span class="sc">==</span> <span class="st">"3290"</span> <span class="sc">~</span> <span class="st">"#e66101"</span>))</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot correlation matrix and scatter plot of all PAST physiology</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">"Figures/Supplemental_Figures/PAST_PhysCorrelations.png"</span>, <span class="at">width =</span> <span class="fl">240.57</span>, <span class="at">height =</span> <span class="fl">164.025</span>, <span class="at">units=</span><span class="st">'mm'</span>, <span class="at">res =</span> <span class="dv">300</span>) </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>corrgram<span class="sc">::</span><span class="fu">corrgram</span>(por_corr_df, <span class="at">order =</span> <span class="cn">FALSE</span>, <span class="at">lower.panel=</span>panel.fill.R2, <span class="at">upper.panel=</span>panel.pts.col, <span class="at">text.panel=</span>panel.txt.brdr,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">col.regions=</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#ffffcc"</span>, <span class="st">"#c7e9b4"</span>, <span class="st">"#225ea8"</span>)), </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> por_corr_df<span class="sc">$</span>color, <span class="at">pch =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(por_corr_df<span class="sc">$</span>shape)),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"symbiont </span><span class="sc">\n</span><span class="st">density"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">protein"</span>, <span class="st">"chlorophyll a"</span>, <span class="st">"color </span><span class="sc">\n</span><span class="st">intensity"</span>, <span class="st">"calcification </span><span class="sc">\n</span><span class="st">rate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">carbohydrate"</span>, <span class="st">"host </span><span class="sc">\n</span><span class="st">lipid"</span>)) </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="figure-2" class="level3">
<h3 class="anchored" data-anchor-id="figure-2">Figure 2</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 967 - 993</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ssid_corr_plot <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">"Figures/Supplemental_Figures/SSID_PhysCorrelations.png"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>pstr_corr_plot <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">"Figures/Supplemental_Figures/PSTR_PhysCorrelations.png"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>past_corr_plot <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">"Figures/Supplemental_Figures/PAST_PhysCorrelations.png"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>ssid_corr_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background_image</span>(ssid_corr_plot) <span class="sc">+</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"  A)   "</span>), <span class="fu">italic</span>(<span class="st">"S. siderea"</span>))))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>pstr_corr_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background_image</span>(pstr_corr_plot) <span class="sc">+</span> </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"  B)   "</span>), <span class="fu">italic</span>(<span class="st">"P. strigosa"</span>))))</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>past_corr_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">background_image</span>(past_corr_plot) <span class="sc">+</span> </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"  C)   "</span>), <span class="fu">italic</span>(<span class="st">"P. asteroides"</span>))))</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(ssid_corr_plot, pstr_corr_plot, past_corr_plot, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/save%20all%20species%20correlation/scatter%20plots-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure2_PhysCorrelations.pdf"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.1</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure2_PhysCorrelations.png"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.1</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure2_PhysCorrelations.tiff"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="fl">3.1</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="plasticity" class="level2">
<h2 class="anchored" data-anchor-id="plasticity">Plasticity</h2>
<section id="siderastrea" class="level3">
<h3 class="anchored" data-anchor-id="siderastrea">Siderastrea</h3>
<section id="ssid-distance-analysis" class="level4">
<h4 class="anchored" data-anchor-id="ssid-distance-analysis">SSID Distance analysis</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1025 - 1073</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the PCA distance with custom function</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>sid_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> s_pca, <span class="co"># the PCA dataframe containing the PCA eigenvalues</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> s_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>,<span class="dv">2</span>)], <span class="co"># the condition/treatment data corresponding to samples</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_ID =</span> <span class="st">"coral"</span>, <span class="co"># the name of column that provide unique ID per sample (if blank, will pull rownames for this)</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">num_pca =</span>  <span class="st">"all"</span>, <span class="co"># the number of PCAs to include in analysis (default is 'all', but you can specify another number with a minimum of "2" PCAs)</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">control_col =</span> <span class="st">"treat2"</span>, <span class="co"># what the 'treatment' column is called</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">control_lvl =</span> <span class="st">"420_28"</span>, <span class="co"># control level of the treatment </span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">group =</span> <span class="st">"colony"</span>) <span class="co"># the grouping column (i.e., colony)</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># with strong random effects of colony??</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># marginal R2 --&gt; fixed v random effect variance: likely more variance at colony level over treatment</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>ssid_dist_mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> sid_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.00269526 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ssid_dist_mod2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> sid_dist)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>ssid_dist_mod2b <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> tank), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> sid_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.0126655 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ssid_dist_mod3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">+</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> sid_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>ssid_dist_mod4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">+</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> sid_dist)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ssid_dist_mod5 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> sid_dist)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>ssid_dist_mod6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> sid_dist) <span class="co"># best fit</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check for best-fit model</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>ssid_plast_aic <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(ssid_dist_mod, ssid_dist_mod2, ssid_dist_mod2b, ssid_dist_mod3, ssid_dist_mod4, ssid_dist_mod5, ssid_dist_mod6)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(ssid_plast_aic)</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Best-fit GLMM with Gamma log link</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>ssid_dist_glm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> tank), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> sid_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.0126655 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>ssid_glm_out <span class="ot">&lt;-</span> <span class="fu">summary</span>(ssid_dist_glm) <span class="co"># summary output of the GLM</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="do">## conditional and marginal R2</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_nakagawa</span>(ssid_dist_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.553
     Marginal R2: 0.313</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Conditional R2: 0.542 -- fixed and random effects</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     Marginal R2: 0.307 -- fixed effects only</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Below info taken from appendix 3 of Gok A, Ngendahimana DK, Fagerholm CL, French RH, Sun J, Bruckman LS (2017) Predictive models of poly(ethylene-terephthalate) film degradation under multi-factor accelerated weathering exposures. PLoS ONE 12(5): e0177614. https://doi.org/10.1371/journal.pone.0177614</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># "Marginal and conditional are R2 values for generalized mixed-effects models</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculated using the r.squaredGLMM function of the MuMIn [1] package that</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># implements a method developed by Nakagawa and Schielzeth [2]. Marginal R2</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># provides the variance explained only by fixed effects and conditional R2</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># provides the variance explained by the entire model, i.e., both fixed effects </span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># and random effects. Fitted R2 is analogous to adjusted R2 generalized for </span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co"># measuring explained variation in linear mixed-effects models [3]."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plenty of warnings with dropped columns. If this interferes with later steps, then may cause issues. For now, this does not need to be alterred.</p>
</section>
<section id="bootstrapping" class="level4">
<h4 class="anchored" data-anchor-id="bootstrapping">Bootstrapping</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1075 - 1090</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Pull the treatment and distance data from the model</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>newdata_ssid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ssid_dist_glm<span class="sc">@</span>frame[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap distances using custom bootstrap function</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>ssid_boot_out <span class="ot">&lt;-</span> <span class="fu">replicate</span>(bootnum, <span class="fu">bootFUN</span>(<span class="at">model =</span> ssid_dist_glm, <span class="at">newdata =</span> newdata_ssid)) </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the mean, 95% lowerCI, and 95% upperCI from the boot matrix and add it to dataframe</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>ssid_boot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sid_dist, <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(ssid_boot_out, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))))))</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ssid_boot)[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"estimate"</span>, <span class="st">"lowerci"</span>, <span class="st">"upperci"</span>) <span class="co"># rename mean/CI columns</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="do">## save as rda object</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(ssid_boot, <span class="at">file =</span> <span class="st">"Data/Bootstrap/SSID_PlastBoot.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running this code chunk takes an incredibly long amount of time. EVAL should be set to false, but to ensure the process is correct, all should be run once to ensure it matches what is known.</p>
<p>In order to allow data to save, created folders within my directory to allow the file path to execute</p>
</section>
<section id="distance-plot" class="level4">
<h4 class="anchored" data-anchor-id="distance-plot">Distance Plot</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1092 - 1123</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load boot data</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"Data/Bootstrap/SSID_PlastBoot.rda"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>ssid_boot<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(ssid_boot<span class="sc">$</span>fpco2, ssid_boot<span class="sc">$</span>ftemp, <span class="at">sep =</span> <span class="st">"_"</span>) <span class="co"># need to rename treatments with the mean pCO2, not temp-specific ones</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>ssid_boot<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(ssid_boot<span class="sc">$</span>treat2,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300_28"</span>, <span class="st">"300_31"</span>, <span class="st">"420_31"</span>, <span class="st">"680_28"</span>, <span class="st">"680_31"</span>, <span class="st">"3290_28"</span>, <span class="st">"3290_31"</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial; 28C"</span>, <span class="st">"pre industrial; 31C"</span>, <span class="st">"current; 31C"</span>, <span class="st">"end-of-century; 28C"</span>, <span class="st">"end-of-century; 31C"</span>, <span class="st">"extreme; 28C"</span>, <span class="st">"extreme; 31C"</span>)) <span class="co"># adjust treatment levels</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Plasticity plot</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>ssid_plast_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ssid_boot, <span class="fu">aes</span>(<span class="at">x =</span> reef, <span class="at">y =</span> estimate, <span class="at">color =</span> treat2, <span class="at">fill =</span> treat2, <span class="at">shape =</span> treat2)) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>)), <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> reef, <span class="at">y =</span> dist), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.3</span>, <span class="at">dodge.width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lowerci, <span class="at">ymax =</span>upperci), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">stroke =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>, <span class="st">"#e66101"</span>)) <span class="sc">+</span> </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"#fdb863"</span>, <span class="st">"white"</span>, <span class="st">"#e66101"</span>, <span class="st">"white"</span>)) <span class="sc">+</span> </span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"PC distance from control"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"F"</span> <span class="ot">=</span> <span class="st">"Offshore"</span>, <span class="st">"N"</span> <span class="ot">=</span> <span class="st">"Inshore"</span>)) <span class="sc">+</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"A)   "</span>), <span class="fu">italic</span>(<span class="st">"S. siderea"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Model output and R2</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>ssid_glm_out <span class="co"># summary output of the GLMER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: dist ~ reef * fpco2 + ftemp + (1 | colony) + (1 | tank)
   Data: sid_dist

     AIC      BIC   logLik deviance df.resid 
   218.4    245.4    -97.2    194.4       58 

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.92121 -0.66739 -0.00235  0.42107  2.51040 

Random effects:
 Groups   Name        Variance Std.Dev.
 tank     (Intercept) 0.01358  0.1165  
 colony   (Intercept) 0.03209  0.1791  
 Residual             0.08867  0.2978  
Number of obs: 70, groups:  tank, 21; colony, 11

Fixed effects:
                 Estimate Std. Error  t value Pr(&gt;|z|)    
(Intercept)      1.050285   0.005612  187.162   &lt;2e-16 ***
reefN            0.009748   0.005645    1.727   0.0842 .  
fpco2420         0.378248   0.005645   67.008   &lt;2e-16 ***
fpco2680         0.222661   0.005658   39.355   &lt;2e-16 ***
fpco23290        0.443635   0.005627   78.839   &lt;2e-16 ***
ftemp31          0.001807   0.005620    0.321   0.7479    
reefN:fpco2420  -0.770755   0.005628 -136.941   &lt;2e-16 ***
reefN:fpco2680  -0.445511   0.005611  -79.399   &lt;2e-16 ***
reefN:fpco23290 -0.329679   0.005632  -58.535   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) reefN  fp2420 fp2680 f23290 ftmp31 rN:242 rN:268
reefN       -0.003                                                 
fpco2420     0.001 -0.002                                          
fpco2680    -0.005  0.001 -0.001                                   
fpco23290    0.003  0.001 -0.001  0.005                            
ftemp31     -0.005 -0.002  0.000 -0.005  0.001                     
rfN:fpc2420  0.001  0.001 -0.002  0.005 -0.001  0.001              
rfN:fpc2680 -0.005 -0.002  0.002  0.003  0.005 -0.004  0.005       
rfN:fp23290 -0.001 -0.002  0.002  0.001 -0.001  0.000  0.001  0.000
optimizer (Nelder_Mead) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.0126655 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_nakagawa</span>(ssid_dist_glm) <span class="co"># conditional and marginal R2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.553
     Marginal R2: 0.313</code></pre>
</div>
</div>
</section>
</section>
<section id="pseudodiploria" class="level3">
<h3 class="anchored" data-anchor-id="pseudodiploria">Pseudodiploria</h3>
<section id="pstr-distance-analysis" class="level4">
<h4 class="anchored" data-anchor-id="pstr-distance-analysis">PSTR distance analysis</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1131 - 1171</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the PCA distance with custom function</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>dip_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> p_pca, <span class="co"># the PCA dataframe containing the PCA eigenvalues</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> p_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>,<span class="dv">2</span>)], <span class="co"># the condition/treatment data corresponding to samples</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_ID =</span> <span class="st">"coral"</span>, <span class="co"># the name of column that provide unique ID per sample (if blank, will pull rownames for this)</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">num_pca =</span>  <span class="st">"all"</span>, <span class="co"># the number of PCAs to include in analysis (default is 'all', but you can specify another number with a minimum of 2 PCAs)</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">control_col =</span> <span class="st">"treat2"</span>, <span class="co"># what the 'treatment' column is called</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">control_lvl =</span> <span class="st">"420_28"</span>, <span class="co"># control level of the treatment </span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">group =</span> <span class="st">"colony"</span>) <span class="co"># the grouping column (i.e., colony)</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Model selection (via AIC)</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>pstr_dist_mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> dip_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 4 columns / coefficients</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.00414046 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>pstr_dist_mod2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> dip_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.0065652 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>pstr_dist_mod3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">+</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> dip_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pstr_dist_mod4 &lt;- glmer(dist ~ reef + fpco2 + ftemp + (1 | colony), family = Gamma(link = "log"), data = dip_dist) # singular fit </span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pstr_dist_mod5 &lt;- glmer(dist ~ reef * (fpco2 + ftemp) + (1 | colony), family = Gamma(link = "log"), data = dip_dist) # singular fit </span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>pstr_dist_mod6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> dip_dist) <span class="co"># best fit model</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check for best-fit model</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>pstr_plast_aic <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(pstr_dist_mod, pstr_dist_mod2, pstr_dist_mod3, pstr_dist_mod6)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(pstr_plast_aic)</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="do">##### </span><span class="al">NOTE</span><span class="do">: nly one sample remains in current day at 31C so need to drop this treatment (clarify in the)</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="do">### Also, because N=2 inshore and N=3 offshore for PSTR, going to pool these by RZ for plasticity here (also fits best-fit model)</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>dip_dist <span class="ot">&lt;-</span> <span class="fu">filter</span>(dip_dist, fpco2 <span class="sc">!=</span> <span class="st">"420"</span>) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Best-fit GLMM with Gamma log link</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>pstr_dist_glm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> dip_dist)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>pstr_glm_out <span class="ot">&lt;-</span> <span class="fu">summary</span>(pstr_dist_glm) <span class="co"># summary output of the GLM</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a><span class="do">## conditional and marginal R2</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_nakagawa</span>(pstr_dist_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.244
     Marginal R2: 0.198</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   Conditional R2: 0.232 -- fixed and random effects</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#      Marginal R2: 0.188 -- fixed effects only</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrapping-1" class="level4">
<h4 class="anchored" data-anchor-id="bootstrapping-1">Bootstrapping</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1173 - 1188</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Pull the treatment and distance data from the model</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>newdata_pstr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pstr_dist_glm<span class="sc">@</span>frame[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap distances using custom bootstrap function</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>pstr_boot_out <span class="ot">&lt;-</span> <span class="fu">replicate</span>(bootnum, <span class="fu">bootFUN</span>(<span class="at">model =</span> pstr_dist_glm, <span class="at">newdata =</span> newdata_pstr)) </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the mean, 95% lowerCI, and 95% upperCI from the boot matrix and add it to dataframe</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>pstr_boot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dip_dist, <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(pstr_boot_out, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))))))</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pstr_boot)[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"estimate"</span>, <span class="st">"lowerci"</span>, <span class="st">"upperci"</span>) <span class="co"># rename mean/CI columns</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="do">## save as rda object</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(pstr_boot, <span class="at">file =</span> <span class="st">"Data/Bootstrap/PSTR_PlastBoot.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running this code chunk takes an incredibly long amount of time. EVAL should be set to false, but to ensure the process is correct, all should be run once to ensure it matches what is known.</p>
</section>
<section id="distance-plot-1" class="level4">
<h4 class="anchored" data-anchor-id="distance-plot-1">Distance plot</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1190 - 1221</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load boot data</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"Data/Bootstrap/PSTR_PlastBoot.rda"</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>pstr_boot<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(pstr_boot<span class="sc">$</span>fpco2, pstr_boot<span class="sc">$</span>ftemp, <span class="at">sep =</span> <span class="st">"_"</span>) <span class="co"># need to rename treatments with the mean pCO2, not temp-specific ones</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>pstr_boot<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(pstr_boot<span class="sc">$</span>treat2,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300_28"</span>, <span class="st">"300_31"</span>, <span class="st">"680_28"</span>, <span class="st">"680_31"</span>, <span class="st">"3290_28"</span>, <span class="st">"3290_31"</span>),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial; 28C"</span>, <span class="st">"pre industrial; 31C"</span>, <span class="st">"end-of-century; 28C"</span>, <span class="st">"end-of-century; 31C"</span>, <span class="st">"extreme; 28C"</span>, <span class="st">"extreme; 31C"</span>)) <span class="co"># adjust treatment levels</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Plasticity plot</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>pstr_plast_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pstr_boot, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> estimate, <span class="at">color =</span> treat2, <span class="at">fill =</span> treat2, <span class="at">shape =</span> treat2)) <span class="sc">+</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>)), <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> dist), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.3</span>, <span class="at">dodge.width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lowerci, <span class="at">ymax =</span>upperci), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">stroke =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>, <span class="st">"#e66101"</span>)) <span class="sc">+</span> </span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"#fdb863"</span>, <span class="st">"white"</span>, <span class="st">"#e66101"</span>, <span class="st">"white"</span>)) <span class="sc">+</span> </span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"P"</span> <span class="ot">=</span> <span class="st">" Reefs pooled"</span>)) <span class="sc">+</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"B)   "</span>), <span class="fu">italic</span>(<span class="st">"P. strigosa"</span>))))</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Model output and R2</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>pstr_glm_out <span class="co"># summary output of the GLM</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: dist ~ fpco2 + ftemp + (1 | colony)
   Data: dip_dist

     AIC      BIC   logLik deviance df.resid 
    97.5    104.8    -42.7     85.5       19 

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.70079 -0.72697  0.05779  0.77668  2.01138 

Random effects:
 Groups   Name        Variance Std.Dev.
 colony   (Intercept) 0.007898 0.08887 
 Residual             0.137879 0.37132 
Number of obs: 25, groups:  colony, 5

Fixed effects:
            Estimate Std. Error t value Pr(&gt;|z|)    
(Intercept)  1.27912    0.14767   8.662   &lt;2e-16 ***
fpco2680    -0.33844    0.19338  -1.750   0.0801 .  
fpco23290   -0.05892    0.18739  -0.314   0.7532    
ftemp31      0.22671    0.17289   1.311   0.1898    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
          (Intr) fp2680 f23290
fpco2680  -0.579              
fpco23290 -0.578  0.484       
ftemp31   -0.334  0.066  0.012</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_nakagawa</span>(pstr_dist_glm) <span class="co"># conditional and marginal R2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.244
     Marginal R2: 0.198</code></pre>
</div>
</div>
</section>
</section>
<section id="porites" class="level3">
<h3 class="anchored" data-anchor-id="porites">Porites</h3>
<section id="past-distance-analysis" class="level4">
<h4 class="anchored" data-anchor-id="past-distance-analysis">Past Distance Analysis</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1229 - 1264</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the PCA distance with custom function</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>por_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> a_pca, <span class="co"># the PCA dataframe containing the PCA eigenvalues</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> a_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>, <span class="dv">2</span>)], <span class="co"># the condition/treatment data corresponding to samples</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">sample_ID =</span> <span class="st">"coral"</span>, <span class="co"># the name of column that provide unique ID per sample (if blank, will pull rownames for this)</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">num_pca =</span>  <span class="st">"all"</span>, <span class="co"># the number of PCAs to include in analysis (default is 'all', but you can specify another number with a minimum of 2 PCAs)</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">control_col =</span> <span class="st">"treat2"</span>, <span class="co"># what the 'treatment' column is called</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">control_lvl =</span> <span class="st">"420_28"</span>, <span class="co"># control level of the treatment </span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">group =</span> <span class="st">"colony"</span>) <span class="co"># the grouping column (i.e., colony). If blank, will assume control level grouping only!</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Model selection (via AIC)</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>past_dist_mod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> por_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.0134209 (tol = 0.002, component 1)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>past_dist_mod2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> por_dist)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>past_dist_mod3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">+</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> por_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>past_dist_mod4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">+</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> por_dist)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>past_dist_mod5 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> por_dist)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>past_dist_mod6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> por_dist) <span class="co"># best fit</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>past_dist_mod6b <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> tank), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> por_dist) </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># check for best-fit model</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>past_plast_aic <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(past_dist_mod, past_dist_mod2, past_dist_mod3, past_dist_mod4, past_dist_mod5, past_dist_mod6, past_dist_mod6b)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(past_plast_aic)</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Best-fit GLMM with Gamma log link</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>past_dist_glm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> tank), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> por_dist)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>past_glm_out <span class="ot">&lt;-</span> <span class="fu">summary</span>(past_dist_glm) <span class="co"># summary output of the GLM</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="do">## conditional and marginal R2</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_nakagawa</span>(past_dist_glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.500
     Marginal R2: 0.147</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Conditional R2: 0.493 -- fixed and random effects</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     Marginal R2: 0.145 -- fixed effects only</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bootstrapping-2" class="level4">
<h4 class="anchored" data-anchor-id="bootstrapping-2">Bootstrapping</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1266 - 1281</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Pull the treatment and distance data from the model</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>newdata_past <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(past_dist_glm<span class="sc">@</span>frame[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap distances using custom bootstrap function</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>past_boot_out <span class="ot">&lt;-</span> <span class="fu">replicate</span>(bootnum, <span class="fu">bootFUN</span>(<span class="at">model =</span> past_dist_glm, <span class="at">newdata =</span> newdata_past))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the mean, 95% lowerCI, and 95% upperCI from the boot matrix and add it to dataframe</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>past_boot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(por_dist, <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(past_boot_out, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))))))</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(past_boot)[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"estimate"</span>, <span class="st">"lowerci"</span>, <span class="st">"upperci"</span>) <span class="co"># rename mean/CI columns</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="do">## save as rda object</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(past_boot, <span class="at">file =</span> <span class="st">"Data/Bootstrap/PAST_PlastBoot.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Received error of non-conformable arguments on line 1540. Going line by line through bootFUN in custom functions doc, nothing fails. Made an attempt to directly put the function into the code chunk. The code ran with no errors, but the data points were different than the original figure and the confidence intervals were lost for this species. The other species came out as expected.</p>
<p>This is a major issue, which must be resolved, but since we have the data file that the author used, we will proceed with the included file.</p>
</section>
<section id="distance-plot-2" class="level4">
<h4 class="anchored" data-anchor-id="distance-plot-2">Distance Plot</h4>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1283 - 1314</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load boot data</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"Data/Bootstrap/PAST_PlastBoot.rda"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>past_boot<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(past_boot<span class="sc">$</span>fpco2, past_boot<span class="sc">$</span>ftemp, <span class="at">sep =</span> <span class="st">"_"</span>) <span class="co"># need to rename treatments with the mean pCO2, not temp-specific ones</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>past_boot<span class="sc">$</span>treat2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(past_boot<span class="sc">$</span>treat2,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300_28"</span>, <span class="st">"300_31"</span>, <span class="st">"420_31"</span>, <span class="st">"680_28"</span>, <span class="st">"680_31"</span>, <span class="st">"3290_28"</span>, <span class="st">"3290_31"</span>),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial; 28C"</span>, <span class="st">"pre industrial; 31C"</span>, <span class="st">"current; 31C"</span>, <span class="st">"end-of-century; 28C"</span>, <span class="st">"end-of-century; 31C"</span>, <span class="st">"extreme; 28C"</span>, <span class="st">"extreme; 31C"</span>)) <span class="co"># adjust treatment levels</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Plasticity plot</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>past_plast_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(past_boot, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> estimate, <span class="at">color =</span> treat2, <span class="at">fill =</span> treat2, <span class="at">shape =</span> treat2)) <span class="sc">+</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>)), <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> dist), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.3</span>, <span class="at">dodge.width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lowerci, <span class="at">ymax =</span>upperci), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">stroke =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.55</span>)) <span class="sc">+</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>, <span class="st">"#e66101"</span>)) <span class="sc">+</span> </span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"#fdb863"</span>, <span class="st">"white"</span>, <span class="st">"#e66101"</span>, <span class="st">"white"</span>)) <span class="sc">+</span> </span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span> <span class="ot">=</span> <span class="st">" Reefs pooled"</span>)) <span class="sc">+</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"C)   "</span>), <span class="fu">italic</span>(<span class="st">"P. astreoides"</span>))))</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Model output and R2</span></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>past_glm_out <span class="co"># summary output of the GLM</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: dist ~ fpco2 + ftemp + (1 | colony) + (1 | tank)
   Data: por_dist

     AIC      BIC   logLik deviance df.resid 
   142.4    158.3    -63.2    126.4       46 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.6543 -0.5670 -0.1035  0.5470  2.2029 

Random effects:
 Groups   Name        Variance Std.Dev.
 tank     (Intercept) 0.001233 0.03512 
 colony   (Intercept) 0.037406 0.19341 
 Residual             0.056156 0.23697 
Number of obs: 54, groups:  tank, 21; colony, 11

Fixed effects:
            Estimate Std. Error t value Pr(&gt;|z|)    
(Intercept)  1.03344    0.12525   8.251  &lt; 2e-16 ***
fpco2420    -0.04516    0.11478  -0.393 0.693972    
fpco2680     0.03277    0.07852   0.417 0.676442    
fpco23290    0.12410    0.08225   1.509 0.131338    
ftemp31      0.26204    0.06856   3.822 0.000132 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
          (Intr) fp2420 fp2680 f23290
fpco2420  -0.153                     
fpco2680  -0.318  0.380              
fpco23290 -0.353  0.306  0.526       
ftemp31   -0.166 -0.379 -0.073  0.068</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_nakagawa</span>(past_dist_glm) <span class="co"># conditional and marginal R2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.500
     Marginal R2: 0.147</code></pre>
</div>
</div>
</section>
</section>
<section id="figure-3" class="level3">
<h3 class="anchored" data-anchor-id="figure-3">Figure 3</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1322 - 1329</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(ssid_plast_plot, pstr_plast_plot, past_plast_plot, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Duplicated `override.aes` is ignored.
Duplicated `override.aes` is ignored.
Duplicated `override.aes` is ignored.
Duplicated `override.aes` is ignored.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/plot%20and%20save%20all%20species%20plasticity-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure3_PhysPlasticity.pdf"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure3_PhysPlasticity.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Final_Figures/Figure3_PhysPlasticity.tiff"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grDevices::dev.off(): agg could not write to the given file</code></pre>
</div>
</div>
</section>
</section>
<section id="figure-s1" class="level2">
<h2 class="anchored" data-anchor-id="figure-s1">Figure S1</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1356 - 1401</p>
<p>Link is forbidden and I am unable to download. Since the raw data is included in the repository, I will proceed with their data.</p>
<section id="s1-actual-plot" class="level3">
<h3 class="anchored" data-anchor-id="s1-actual-plot">S1 Actual Plot</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1403 - 1488</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Load the site lat/lon locations from .csv</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Site =</span> <span class="fu">c</span>(<span class="st">"PHMR"</span>, <span class="st">"SCMR"</span>),</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lon =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">88.572760</span>, <span class="sc">-</span><span class="fl">88.261440</span>),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lat =</span> <span class="fu">c</span>(<span class="fl">16.189870</span>, <span class="fl">16.116670</span>))</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="do">## convert sampling points to spatial points and applying projection to points</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>LongLat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sites<span class="sc">$</span>lon, sites<span class="sc">$</span>lat) <span class="co"># make lat/lon data frame</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>sitePTS <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(LongLat) <span class="co"># convert data frame to spatialpoints object</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>proj <span class="ot">&lt;-</span> <span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84"</span> <span class="co"># this is the projection that will be applied to data</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(sitePTS) <span class="ot">&lt;-</span> proj <span class="co"># apply specified projection</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="do">### Open sst_BZ_cropped.nc file</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>raster_path <span class="ot">&lt;-</span> <span class="st">"Data/Raw_data/sst_BZ_cropped.nc"</span> <span class="co"># specify the path to the Day SST netCDF (no path here since its in current working directory)</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>sst_raster <span class="ot">&lt;-</span> <span class="fu">brick</span>(raster_path, <span class="at">varname =</span> <span class="st">"sst"</span>) <span class="co"># create raster brick of daily SST data</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(sst_raster) # sometimes I plot to quickly have R plot this to make sure I am getting multiple layers and reasonable values</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>netCDF <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(raster_path) <span class="co"># next, 'open' the netCDF to pull the time element that is extracted from the 'history' parameter</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(netCDF,<span class="dv">0</span>,<span class="st">"history"</span>)[[<span class="dv">2</span>]] <span class="co"># pull the 'history' parameter (this has all the file names that we can pull dates per layer from)</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe of the pulled file name and then removed text strings per file (now each layer in the raster brick)</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="fu">strsplit</span>(history, <span class="st">" "</span>)[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">249</span><span class="sc">:-</span><span class="dv">250</span>)]) <span class="sc">%&gt;%</span> <span class="co"># Range for night: -3290:-3296; Range for day: -3291:-3297)</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">gsub</span>(<span class="st">"AQUA_MODIS."</span>, <span class="st">""</span>, time), <span class="co"># removes 'AQUA_MODIS.' from the file names</span></span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">gsub</span>(<span class="st">".L3m.MO.SST.sst.4km.nc"</span>, <span class="st">""</span>, time)) <span class="co"># removes '.L3m.DAY.SST4.sst4.4km_subset.nc' from the file names</span></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="co"># make new column of above data frame that converts the numbers to a date string</span></span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>dates<span class="sc">$</span>date_time <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(<span class="fu">substr</span>(dates<span class="sc">$</span>time, <span class="dv">1</span>, <span class="dv">4</span>), <span class="fu">substr</span>(dates<span class="sc">$</span>time, <span class="dv">5</span>, <span class="dv">6</span>), <span class="fu">substr</span>(dates<span class="sc">$</span>time, <span class="dv">7</span>, <span class="dv">8</span>), <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a><span class="do">### Extract SST from raster by site (plus the 5 km buffer) and convert to usable data frame</span></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>site_SST <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(sst_raster, sitePTS, <span class="at">fun =</span> mean) <span class="co"># this will take the mean SST within the buffer per site, resulting in one value per layer</span></span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the extracted matrix to final data frame</span></span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a>site_SST_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">t</span>(site_SST), dates<span class="sc">$</span>date_time) <span class="co"># creates extensible time-series object, t is used to transpose the matrix because xts assumes dates are along lines, not columns. This also adds the time element of the layers since it was not present in the matrix</span></span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a>site_SST_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(<span class="fu">t</span>(site_SST_xts)), <span class="fu">coredata</span>(<span class="fu">t</span>(site_SST_xts))) <span class="co"># convert xts object to data frame</span></span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a>site_SST_df<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(site_SST_df<span class="sc">$</span>date), <span class="dv">1</span>)) <span class="co"># add ID to identify unique sampling sites</span></span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>site_SST_df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># remove this column since it is repetitive </span></span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a>site_SST_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(site_SST_df, date, sst, X2002.<span class="fl">12.01</span><span class="sc">:</span>X2021.<span class="fl">11.01</span>) <span class="co"># convert from wide to long format (note the first date is 31 Dec 2004 so this can be removed downstream)</span></span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a><span class="co"># update the data frame for for better dates and site IDs</span></span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a>sst_gps <span class="ot">&lt;-</span> site_SST_long <span class="sc">%&gt;%</span> <span class="fu">separate</span>(date, <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>)) <span class="co"># create year, month, and day column columns</span></span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a>sst_gps<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">paste</span>(sst_gps<span class="sc">$</span>month, sst_gps<span class="sc">$</span>day, sst_gps<span class="sc">$</span>year, <span class="at">sep =</span> <span class="st">"/"</span>) <span class="co"># creates a combined date column (XYear.Month)</span></span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a>sst_gps <span class="ot">&lt;-</span> <span class="fu">spread</span>(sst_gps, site, sst) <span class="co"># converts from long to wide format</span></span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a>sst_gps <span class="ot">&lt;-</span> sst_gps <span class="sc">%&gt;%</span> </span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">PHMR =</span> <span class="st">`</span><span class="at">1</span><span class="st">`</span>,</span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">SCMR =</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span>,</span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-53"><a href="#cb102-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-54"><a href="#cb102-54" aria-hidden="true" tabindex="-1"></a><span class="do">## convert data from wide to long</span></span>
<span id="cb102-55"><a href="#cb102-55" aria-hidden="true" tabindex="-1"></a>sst_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(sst_gps, site, sst, PHMR<span class="sc">:</span>SCMR) <span class="sc">%&gt;%</span> </span>
<span id="cb102-56"><a href="#cb102-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">gsub</span>(<span class="st">"X2"</span>, <span class="st">"2"</span>, date), <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>))</span>
<span id="cb102-57"><a href="#cb102-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-58"><a href="#cb102-58" aria-hidden="true" tabindex="-1"></a>p_mean <span class="ot">&lt;-</span> sst_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"PHMR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb102-59"><a href="#cb102-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb102-60"><a href="#cb102-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-61"><a href="#cb102-61" aria-hidden="true" tabindex="-1"></a>s_mean <span class="ot">&lt;-</span> sst_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"SCMR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb102-62"><a href="#cb102-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb102-63"><a href="#cb102-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-64"><a href="#cb102-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-65"><a href="#cb102-65" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sst_long, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> sst, <span class="at">colour =</span> site)) <span class="sc">+</span></span>
<span id="cb102-66"><a href="#cb102-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">28</span>), <span class="at">colour =</span> <span class="st">"#4393c3"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb102-67"><a href="#cb102-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(sst_long<span class="sc">$</span>date), <span class="at">y =</span> <span class="fl">31.2</span>, <span class="at">label =</span> <span class="st">"31C treat"</span>, <span class="at">colour =</span> <span class="st">"#b2182b"</span>) <span class="sc">+</span></span>
<span id="cb102-68"><a href="#cb102-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">31</span>), <span class="at">colour =</span> <span class="st">"#b2182b"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb102-69"><a href="#cb102-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(sst_long<span class="sc">$</span>date), <span class="at">y =</span> <span class="fl">27.8</span>, <span class="at">label =</span> <span class="st">"28C treat"</span>, <span class="at">colour =</span> <span class="st">"#4393c3"</span>) <span class="sc">+</span></span>
<span id="cb102-70"><a href="#cb102-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> sst_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"PHMR"</span>), <span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">colour =</span> <span class="st">"#e9aa2b"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb102-71"><a href="#cb102-71" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate("text", x = min(sst_long$date), y = p_mean[[1]] + 0.2, label = paste0("mean: ", round(p_mean[[1]], 2), "C"), colour = "#e9aa2b") +</span></span>
<span id="cb102-72"><a href="#cb102-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> sst_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"SCMR"</span>), <span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">colour =</span> <span class="st">"#00a08b"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb102-73"><a href="#cb102-73" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate("text", x = min(sst_long$date), y = s_mean[[1]] - 0.2, label = paste0("mean: ", round(s_mean[[1]], 2), "C"), colour = "#00a08b") +  </span></span>
<span id="cb102-74"><a href="#cb102-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb102-75"><a href="#cb102-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PHMR (inshore)"</span>, <span class="st">"SCMR (offshore)"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e9aa2b"</span>, <span class="st">"#00a08b"</span>)) <span class="sc">+</span></span>
<span id="cb102-76"><a href="#cb102-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"SST (C)"</span>) <span class="sc">+</span></span>
<span id="cb102-77"><a href="#cb102-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb102-78"><a href="#cb102-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.13</span>))</span>
<span id="cb102-79"><a href="#cb102-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-80"><a href="#cb102-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S1_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb102-81"><a href="#cb102-81" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S1_Fig.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb102-82"><a href="#cb102-82" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S1_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the data file taken from the repository, the analysis went further, but because of an error in the rename function, the code needed the specification of the dplyr package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Load the site lat/lon locations from .csv</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Site =</span> <span class="fu">c</span>(<span class="st">"PHMR"</span>, <span class="st">"SCMR"</span>),</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lon =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">88.572760</span>, <span class="sc">-</span><span class="fl">88.261440</span>),</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lat =</span> <span class="fu">c</span>(<span class="fl">16.189870</span>, <span class="fl">16.116670</span>))</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="do">## convert sampling points to spatial points and applying projection to points</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>LongLat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sites<span class="sc">$</span>lon, sites<span class="sc">$</span>lat) <span class="co"># make lat/lon data frame</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>sitePTS <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(LongLat) <span class="co"># convert data frame to spatialpoints object</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>proj <span class="ot">&lt;-</span> <span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84"</span> <span class="co"># this is the projection that will be applied to data</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(sitePTS) <span class="ot">&lt;-</span> proj <span class="co"># apply specified projection</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="do">### Open sst_BZ_cropped.nc file</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>raster_path <span class="ot">&lt;-</span> <span class="st">"Data/Raw_data/sst_BZ_cropped.nc"</span> <span class="co"># specify the path to the Day SST netCDF (no path here since its in current working directory)</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>sst_raster <span class="ot">&lt;-</span> <span class="fu">brick</span>(raster_path, <span class="at">varname =</span> <span class="st">"sst"</span>) <span class="co"># create raster brick of daily SST data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vobjtovarid4: **** WARNING **** I was asked to get a varid for dimension named record BUT this dimension HAS NO DIMVAR! Code will probably fail at this point"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(sst_raster) # sometimes I plot to quickly have R plot this to make sure I am getting multiple layers and reasonable values</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>netCDF <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(raster_path) <span class="co"># next, 'open' the netCDF to pull the time element that is extracted from the 'history' parameter</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> <span class="fu">ncatt_get</span>(netCDF,<span class="dv">0</span>,<span class="st">"history"</span>)[[<span class="dv">2</span>]] <span class="co"># pull the 'history' parameter (this has all the file names that we can pull dates per layer from)</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe of the pulled file name and then removed text strings per file (now each layer in the raster brick)</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="fu">strsplit</span>(history, <span class="st">" "</span>)[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">20</span>, <span class="sc">-</span><span class="dv">249</span><span class="sc">:-</span><span class="dv">250</span>)]) <span class="sc">%&gt;%</span> <span class="co"># Range for night: -3290:-3296; Range for day: -3291:-3297)</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">gsub</span>(<span class="st">"AQUA_MODIS."</span>, <span class="st">""</span>, time), <span class="co"># removes 'AQUA_MODIS.' from the file names</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">gsub</span>(<span class="st">".L3m.MO.SST.sst.4km.nc"</span>, <span class="st">""</span>, time)) <span class="co"># removes '.L3m.DAY.SST4.sst4.4km_subset.nc' from the file names</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># make new column of above data frame that converts the numbers to a date string</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>dates<span class="sc">$</span>date_time <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(<span class="fu">substr</span>(dates<span class="sc">$</span>time, <span class="dv">1</span>, <span class="dv">4</span>), <span class="fu">substr</span>(dates<span class="sc">$</span>time, <span class="dv">5</span>, <span class="dv">6</span>), <span class="fu">substr</span>(dates<span class="sc">$</span>time, <span class="dv">7</span>, <span class="dv">8</span>), <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="do">### Extract SST from raster by site (plus the 5 km buffer) and convert to usable data frame</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>site_SST <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(sst_raster, sitePTS, <span class="at">fun =</span> mean) <span class="co"># this will take the mean SST within the buffer per site, resulting in one value per layer</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the extracted matrix to final data frame</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>site_SST_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">t</span>(site_SST), dates<span class="sc">$</span>date_time) <span class="co"># creates extensible time-series object, t is used to transpose the matrix because xts assumes dates are along lines, not columns. This also adds the time element of the layers since it was not present in the matrix</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>site_SST_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(<span class="fu">t</span>(site_SST_xts)), <span class="fu">coredata</span>(<span class="fu">t</span>(site_SST_xts))) <span class="co"># convert xts object to data frame</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>site_SST_df<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(site_SST_df<span class="sc">$</span>date), <span class="dv">1</span>)) <span class="co"># add ID to identify unique sampling sites</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>site_SST_df<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># remove this column since it is repetitive </span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>site_SST_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(site_SST_df, date, sst, X2002.<span class="fl">12.01</span><span class="sc">:</span>X2021.<span class="fl">11.01</span>) <span class="co"># convert from wide to long format (note the first date is 31 Dec 2004 so this can be removed downstream)</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co"># update the data frame for for better dates and site IDs</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>sst_gps <span class="ot">&lt;-</span> site_SST_long <span class="sc">%&gt;%</span> <span class="fu">separate</span>(date, <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>)) <span class="co"># create year, month, and day column columns</span></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>sst_gps<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">paste</span>(sst_gps<span class="sc">$</span>month, sst_gps<span class="sc">$</span>day, sst_gps<span class="sc">$</span>year, <span class="at">sep =</span> <span class="st">"/"</span>) <span class="co"># creates a combined date column (XYear.Month)</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>sst_gps <span class="ot">&lt;-</span> <span class="fu">spread</span>(sst_gps, site, sst) <span class="co"># converts from long to wide format</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>sst_gps <span class="ot">&lt;-</span> sst_gps <span class="sc">%&gt;%</span> </span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">PHMR =</span> <span class="st">`</span><span class="at">1</span><span class="st">`</span>,</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">SCMR =</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span>,</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="do">## convert data from wide to long</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>sst_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(sst_gps, site, sst, PHMR<span class="sc">:</span>SCMR) <span class="sc">%&gt;%</span> </span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">gsub</span>(<span class="st">"X2"</span>, <span class="st">"2"</span>, date), <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>))</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>p_mean <span class="ot">&lt;-</span> sst_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"PHMR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>s_mean <span class="ot">&lt;-</span> sst_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"SCMR"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sst_long, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> sst, <span class="at">colour =</span> site)) <span class="sc">+</span></span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">28</span>), <span class="at">colour =</span> <span class="st">"#4393c3"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(sst_long<span class="sc">$</span>date), <span class="at">y =</span> <span class="fl">31.2</span>, <span class="at">label =</span> <span class="st">"31C treat"</span>, <span class="at">colour =</span> <span class="st">"#b2182b"</span>) <span class="sc">+</span></span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">31</span>), <span class="at">colour =</span> <span class="st">"#b2182b"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(sst_long<span class="sc">$</span>date), <span class="at">y =</span> <span class="fl">27.8</span>, <span class="at">label =</span> <span class="st">"28C treat"</span>, <span class="at">colour =</span> <span class="st">"#4393c3"</span>) <span class="sc">+</span></span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> sst_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"PHMR"</span>), <span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">colour =</span> <span class="st">"#e9aa2b"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate("text", x = min(sst_long$date), y = p_mean[[1]] + 0.2, label = paste0("mean: ", round(p_mean[[1]], 2), "C"), colour = "#e9aa2b") +</span></span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> sst_long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"SCMR"</span>), <span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="at">colour =</span> <span class="st">"#00a08b"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">#annotate("text", x = min(sst_long$date), y = s_mean[[1]] - 0.2, label = paste0("mean: ", round(s_mean[[1]], 2), "C"), colour = "#00a08b") +  </span></span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"PHMR (inshore)"</span>, <span class="st">"SCMR (offshore)"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e9aa2b"</span>, <span class="st">"#00a08b"</span>)) <span class="sc">+</span></span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"SST (C)"</span>) <span class="sc">+</span></span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/SST%20plot%20for%20Fig%20S1%20fixed-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S1_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S1_Fig.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S1_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="figure-s3" class="level2">
<h2 class="anchored" data-anchor-id="figure-s3">Figure S3</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1509 - 1541</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Read in the water chem values from the experiment</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>chem <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data/Raw_data/Exp_waterchem.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>), <span class="co"># convert date to date format)</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">pco2 =</span> <span class="fu">factor</span>(pco2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>, <span class="st">"extreme"</span>)), <span class="co"># convert to factors</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> <span class="fu">factor</span>(temp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(date, pco2, temp, param, treat) <span class="sc">%&gt;%</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(value),</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'date', 'pco2', 'temp', 'param'. You can
override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>dodge <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">7</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">alk =</span> <span class="st">"A)  Total alkalinity"</span>, <span class="at">co2 =</span> <span class="st">"B)  CO2"</span>, <span class="at">co3 =</span> <span class="st">"C)  CO3"</span>, <span class="at">dic =</span> <span class="st">"D)  DIC"</span>, <span class="at">hco3 =</span> <span class="st">"E)  HCO3"</span>, <span class="at">mpco2 =</span> <span class="st">"F)  CO2 seawater"</span>, <span class="at">mtemp =</span> <span class="st">"G)  Temperature (C)"</span>, <span class="at">pHc =</span> <span class="st">"H)  pH calculated"</span>, <span class="at">pHm =</span> <span class="st">"I)  pH measured"</span>, <span class="at">sal =</span> <span class="st">"J)  Salinity"</span>, <span class="at">sat =</span> <span class="st">"K)  Aragonite saturation state"</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chem, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> mean, <span class="at">colour =</span> pco2, <span class="at">shape =</span> temp, <span class="at">group =</span> treat)) <span class="sc">+</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> dodge) <span class="sc">+</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> sd, <span class="at">ymax =</span> mean <span class="sc">+</span> sd, <span class="at">group =</span> treat), <span class="at">width =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">position =</span> dodge, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_continuous(trans = 'log2') +</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>)) <span class="sc">+</span> </span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> param, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">param =</span> labels)) <span class="sc">+</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.83</span>, <span class="fl">0.11</span>), <span class="at">legend.box =</span> <span class="st">"horizontal"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/water%20chem%20through%20time-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S3_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)  </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S3_Fig.png"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S3_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After copying in the data from the experiment, everything ran correctly.</p>
</section>
<section id="figure-s4" class="level2">
<h2 class="anchored" data-anchor-id="figure-s4">Figure S4</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1551 - 1561</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>reef_pca_all <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(s_reef_pca, p_reef_pca, a_reef_pca, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>trt_pca_all <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(s_pt_pca, p_pt_pca, a_pt_pca, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"D)"</span>, <span class="st">"E)"</span>, <span class="st">"F)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Duplicated `override.aes` is ignored.
Duplicated `override.aes` is ignored.
Duplicated `override.aes` is ignored.
Duplicated `override.aes` is ignored.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(reef_pca_all, trt_pca_all, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/PCA%20plot%20reefs-1.png" class="img-fluid figure-img" width="1248"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S4_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S4_Fig.png"</span>, <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S4_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">450</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything ran as expected.</p>
</section>
<section id="figure-s5" class="level2">
<h2 class="anchored" data-anchor-id="figure-s5">Figure S5</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1571 - 1599</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="do">## subset for the physiology parameters per species and convert from wide to long format</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>df_withT_phys <span class="ot">&lt;-</span> <span class="fu">gather</span>(df_withT, param, value, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">17</span>, <span class="dv">34</span>, <span class="dv">38</span><span class="sc">:</span><span class="dv">39</span>, <span class="dv">42</span>))[,<span class="sc">-</span><span class="dv">13</span><span class="sc">:-</span><span class="dv">33</span>]</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>df_noT_phys <span class="ot">&lt;-</span> <span class="fu">filter</span>(df_withT_phys, species <span class="sc">!=</span> <span class="st">"T"</span>) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>() <span class="co"># dropping U. tenuifolia samples</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder the parameters and assign labels for plotting</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>df_noT_phys <span class="ot">&lt;-</span> df_noT_phys <span class="sc">%&gt;%</span> </span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">param =</span> <span class="fu">factor</span>(param, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"carb"</span>, <span class="st">"lipid"</span>, <span class="st">"pro"</span>, <span class="st">"host"</span>, <span class="st">"chla"</span>, <span class="st">"den"</span>, <span class="st">"red"</span>, <span class="st">"sum"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Carbohydrate (mg cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>)), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Lipid (mg cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>)), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Protein (mg cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>)), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Total Host (mg cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>)), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Chlorophyll a ("</span><span class="sc">*</span>mu,<span class="st">"g cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>)), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Density (10"</span><span class="sc">^</span><span class="dv">6</span>,<span class="st">"cells cm"</span><span class="sc">^-</span><span class="dv">2</span>,<span class="st">")"</span>)), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Red"</span>,<span class="st">" channel"</span>)), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Sum"</span>,<span class="st">" channel"</span>)))),</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">species =</span> <span class="fu">factor</span>(species, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"P"</span>, <span class="st">"A"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"A)  "</span>), <span class="fu">italic</span>(<span class="st">"Siderastrea siderea"</span>))), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"B)  "</span>), <span class="fu">italic</span>(<span class="st">"Pseudodiploria strigosa"</span>))), <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"C)  "</span>), <span class="fu">italic</span>(<span class="st">"Porites astreoides"</span>))))))</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot all phys for all species (mean, SE, and raw observations)</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_noT_phys, <span class="fu">aes</span>(<span class="at">x =</span> fpco2, <span class="at">y =</span> value, <span class="at">color =</span> ftemp)) <span class="sc">+</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(), <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(), <span class="at">panel.background=</span><span class="fu">element_blank</span>(), <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">1</span>), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>, <span class="fl">0.985</span>), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">+</span> </span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_sdl, <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">mult =</span> <span class="dv">1</span>), <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28 °C"</span>, <span class="st">"31 °C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>))<span class="sc">+</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(param <span class="sc">~</span> species, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>, <span class="at">x =</span> alab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/all%20coral%20physiology%20plot-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S5_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>, <span class="at">dpi =</span> <span class="dv">500</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S5_Fig.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">dpi =</span> <span class="dv">650</span>) </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S5_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">13</span>, <span class="at">dpi =</span> <span class="dv">400</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="s6" class="level2">
<h2 class="anchored" data-anchor-id="s6">S6</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1609 - 1659</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>all_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(all_pca, <span class="at">data =</span> all_df, </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.11</span>, <span class="fl">0.9</span>), <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.108</span>, <span class="at">label =</span> <span class="fu">deparse</span>(all_reef_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.128</span>, <span class="at">label =</span> <span class="fu">deparse</span>(all_s_reef_pval), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a><span class="co"># pco2 * temp</span></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>all_df<span class="sc">$</span>pco2_f <span class="ot">&lt;-</span> <span class="fu">factor</span>(all_df<span class="sc">$</span>pco2, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial; 28C"</span>, <span class="st">"pre industrial; 31C"</span>, <span class="st">"current; 31C"</span>, <span class="st">"current; 28C"</span>, <span class="st">"end-of-century; 28C"</span>, <span class="st">"end-of-century; 31C"</span>, <span class="st">"extreme; 28C"</span>, <span class="st">"extreme; 31C"</span>))</span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>all_pt_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(all_pca, <span class="at">data =</span> all_df,</span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="st">"pco2_f"</span>,</span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.size =</span> <span class="dv">5</span>,</span>
<span id="cb117-35"><a href="#cb117-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb117-36"><a href="#cb117-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb117-37"><a href="#cb117-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb117-38"><a href="#cb117-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb117-39"><a href="#cb117-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb117-40"><a href="#cb117-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb117-41"><a href="#cb117-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb117-42"><a href="#cb117-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb117-43"><a href="#cb117-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#d1e5f0"</span>, <span class="st">"#fddbc7"</span>, <span class="st">"#f4a582"</span>, <span class="st">"#92c5de"</span>, <span class="st">"#4393c3"</span>, <span class="st">"#d6604d"</span>, <span class="st">"#2166ac"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb117-44"><a href="#cb117-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#d1e5f0"</span>, <span class="st">"#fddbc7"</span>, <span class="st">"#f4a582"</span>, <span class="st">"#92c5de"</span>, <span class="st">"#4393c3"</span>, <span class="st">"#d6604d"</span>, <span class="st">"#2166ac"</span>, <span class="st">"#b2182b"</span>)) <span class="sc">+</span></span>
<span id="cb117-45"><a href="#cb117-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb117-46"><a href="#cb117-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.5</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb117-47"><a href="#cb117-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected.</p>
<section id="save-figure" class="level3">
<h3 class="anchored" data-anchor-id="save-figure">Save figure</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1661 - 1668</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(all_reef_pca, all_pt_pca, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labels =</span> <span class="st">"AUTO"</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Duplicated `override.aes` is ignored.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/save%20fig%20s11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S6_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="fl">4.5</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S6_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="fl">4.5</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S6_Fig.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="fl">4.5</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected.</p>
</section>
</section>
<section id="figure-s7" class="level2">
<h2 class="anchored" data-anchor-id="figure-s7">Figure S7</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1678 - 1700</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">## subset for host or symbiont physiology</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>sid_pca_df_host <span class="ot">&lt;-</span> s_df[,<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">22</span><span class="sc">:</span><span class="dv">23</span>)] <span class="co"># host only phys (lipid, protein, carb)</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>sid_pca_df_symb <span class="ot">&lt;-</span> s_df[,<span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>)] <span class="co"># symbiont only phys (chla, density, color intensity)</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="do">## run the adonis for HOST phys</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co">#s_pca_host_mod &lt;- adonis2(sid_pca_df_host ~ reef * ftemp * fpco2, data = s_df, method = 'eu', permutations = 1000) # below is the model with non sig interactions removed:</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>s_pca_host_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(sid_pca_df_host <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef, <span class="at">data =</span> s_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co">#s_pca_host_mod # view SSID adonis output</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="do">## run the adonis for SYMB phys</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="co">#s_pca_symb_mod &lt;- adonis2(sid_pca_df_symb ~ reef * ftemp * fpco2, data = s_df, method = 'eu', permutations = 1000) # below is the model with non sig interactions removed:</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>s_pca_symb_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(sid_pca_df_symb <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef, <span class="at">data =</span> s_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum)</span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co">#s_pca_symb_mod # view SSID adonis output</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="do">## perform principal component analysis (PCA)</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>s_pca_host <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(sid_pca_df_host, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>s_pca_symb <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(sid_pca_df_symb, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected.</p>
<section id="s7-plot" class="level3">
<h3 class="anchored" data-anchor-id="s7-plot">S7 Plot</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1702 - 1854</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Temperature PCAs</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST temperature</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>sid_host_temp_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca_host, <span class="at">data =</span> s_df, </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>         <span class="co">#shape = "fpco2",</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"ftemp"</span>,               </span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>))<span class="sc">+</span></span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"transparent"</span>))<span class="sc">+</span></span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"S. siderea"</span>),<span class="st">" host"</span>)))</span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB temperature</span></span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>sid_symb_temp_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca_symb, <span class="at">data =</span> s_df, </span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>         <span class="co">#shape = "fpco2",</span></span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"ftemp"</span>,               </span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb122-43"><a href="#cb122-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb122-44"><a href="#cb122-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb122-45"><a href="#cb122-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb122-46"><a href="#cb122-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb122-47"><a href="#cb122-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>))<span class="sc">+</span></span>
<span id="cb122-48"><a href="#cb122-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"transparent"</span>))<span class="sc">+</span></span>
<span id="cb122-49"><a href="#cb122-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb122-50"><a href="#cb122-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb122-51"><a href="#cb122-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"S. siderea"</span>),<span class="st">" symbionts"</span>)))</span>
<span id="cb122-52"><a href="#cb122-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-53"><a href="#cb122-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-54"><a href="#cb122-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-55"><a href="#cb122-55" aria-hidden="true" tabindex="-1"></a><span class="do">## pCO2 PCAs</span></span>
<span id="cb122-56"><a href="#cb122-56" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST pco2</span></span>
<span id="cb122-57"><a href="#cb122-57" aria-hidden="true" tabindex="-1"></a>sid_host_pco2_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca_host, <span class="at">data =</span> s_df, </span>
<span id="cb122-58"><a href="#cb122-58" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb122-59"><a href="#cb122-59" aria-hidden="true" tabindex="-1"></a>                          <span class="co">#shape = "ftemp",</span></span>
<span id="cb122-60"><a href="#cb122-60" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb122-61"><a href="#cb122-61" aria-hidden="true" tabindex="-1"></a>                          <span class="at">shape =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb122-62"><a href="#cb122-62" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-63"><a href="#cb122-63" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb122-64"><a href="#cb122-64" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb122-65"><a href="#cb122-65" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb122-66"><a href="#cb122-66" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-67"><a href="#cb122-67" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb122-68"><a href="#cb122-68" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb122-69"><a href="#cb122-69" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb122-70"><a href="#cb122-70" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb122-71"><a href="#cb122-71" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb122-72"><a href="#cb122-72" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb122-73"><a href="#cb122-73" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb122-74"><a href="#cb122-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb122-75"><a href="#cb122-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb122-76"><a href="#cb122-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb122-77"><a href="#cb122-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb122-78"><a href="#cb122-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb122-79"><a href="#cb122-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-80"><a href="#cb122-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-81"><a href="#cb122-81" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB pco2</span></span>
<span id="cb122-82"><a href="#cb122-82" aria-hidden="true" tabindex="-1"></a>sid_symb_pco2_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca_symb, <span class="at">data =</span> s_df, </span>
<span id="cb122-83"><a href="#cb122-83" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb122-84"><a href="#cb122-84" aria-hidden="true" tabindex="-1"></a>                          <span class="co">#shape = "ftemp",</span></span>
<span id="cb122-85"><a href="#cb122-85" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb122-86"><a href="#cb122-86" aria-hidden="true" tabindex="-1"></a>                          <span class="at">shape =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb122-87"><a href="#cb122-87" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-88"><a href="#cb122-88" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb122-89"><a href="#cb122-89" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb122-90"><a href="#cb122-90" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb122-91"><a href="#cb122-91" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-92"><a href="#cb122-92" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb122-93"><a href="#cb122-93" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb122-94"><a href="#cb122-94" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb122-95"><a href="#cb122-95" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb122-96"><a href="#cb122-96" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb122-97"><a href="#cb122-97" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb122-98"><a href="#cb122-98" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb122-99"><a href="#cb122-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb122-100"><a href="#cb122-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb122-101"><a href="#cb122-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb122-102"><a href="#cb122-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb122-103"><a href="#cb122-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb122-104"><a href="#cb122-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-105"><a href="#cb122-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-106"><a href="#cb122-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-107"><a href="#cb122-107" aria-hidden="true" tabindex="-1"></a><span class="do">## Reef PCAs</span></span>
<span id="cb122-108"><a href="#cb122-108" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST reef</span></span>
<span id="cb122-109"><a href="#cb122-109" aria-hidden="true" tabindex="-1"></a>sid_host_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca_host, <span class="at">data =</span> s_df,  </span>
<span id="cb122-110"><a href="#cb122-110" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb122-111"><a href="#cb122-111" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb122-112"><a href="#cb122-112" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-113"><a href="#cb122-113" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb122-114"><a href="#cb122-114" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb122-115"><a href="#cb122-115" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb122-116"><a href="#cb122-116" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-117"><a href="#cb122-117" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb122-118"><a href="#cb122-118" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb122-119"><a href="#cb122-119" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb122-120"><a href="#cb122-120" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb122-121"><a href="#cb122-121" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.hjust =</span> <span class="sc">-</span><span class="fl">0.6</span>, </span>
<span id="cb122-122"><a href="#cb122-122" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb122-123"><a href="#cb122-123" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb122-124"><a href="#cb122-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb122-125"><a href="#cb122-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb122-126"><a href="#cb122-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb122-127"><a href="#cb122-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) </span>
<span id="cb122-128"><a href="#cb122-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-129"><a href="#cb122-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-130"><a href="#cb122-130" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB reef</span></span>
<span id="cb122-131"><a href="#cb122-131" aria-hidden="true" tabindex="-1"></a>sid_symb_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(s_pca_symb, <span class="at">data =</span> s_df,  </span>
<span id="cb122-132"><a href="#cb122-132" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb122-133"><a href="#cb122-133" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb122-134"><a href="#cb122-134" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-135"><a href="#cb122-135" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb122-136"><a href="#cb122-136" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb122-137"><a href="#cb122-137" aria-hidden="true" tabindex="-1"></a>                          <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb122-138"><a href="#cb122-138" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb122-139"><a href="#cb122-139" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb122-140"><a href="#cb122-140" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb122-141"><a href="#cb122-141" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb122-142"><a href="#cb122-142" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb122-143"><a href="#cb122-143" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.hjust =</span> <span class="sc">-</span><span class="fl">0.6</span>, </span>
<span id="cb122-144"><a href="#cb122-144" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb122-145"><a href="#cb122-145" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb122-146"><a href="#cb122-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb122-147"><a href="#cb122-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb122-148"><a href="#cb122-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb122-149"><a href="#cb122-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected.</p>
</section>
<section id="arranging-and-plotting" class="level3">
<h3 class="anchored" data-anchor-id="arranging-and-plotting">Arranging and plotting</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1856 - 1870</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine PCAs by treatment for common legend:</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>ssid_host_symb_temp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(sid_host_temp_pca, sid_symb_temp_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># temperature</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>ssid_host_symb_pco2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(sid_host_pco2_pca, sid_symb_pco2_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># pCO2</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>ssid_host_symb_reef <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(sid_host_reef_pca, sid_symb_reef_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># reef</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Add all together for final figure:</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(ssid_host_symb_temp, ssid_host_symb_pco2, ssid_host_symb_reef, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/combined%20SSID%20host%20v%20symb%20PCA%20plot-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S7_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S7_Fig.png"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S7_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">450</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected</p>
</section>
</section>
<section id="figure-s8" class="level2">
<h2 class="anchored" data-anchor-id="figure-s8">Figure S8</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1880 - 1902</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">## subset for host or symbiont physiology</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>dip_pca_df_host <span class="ot">&lt;-</span> p_df[,<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">22</span><span class="sc">:</span><span class="dv">23</span>)] <span class="co"># host only phys (lipid, protein, carb)</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>dip_pca_df_symb <span class="ot">&lt;-</span> p_df[,<span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>)] <span class="co"># symbiont only phys (chla, density, color intensity)</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="do">## run the adonis for HOST phys</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co">#p_pca_host_mod &lt;- adonis2(dip_pca_df_host ~ reef * ftemp * fpco2, data = p_df, method = 'eu', permutations = 1000) # below is the model with non sig interactions removed:</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>p_pca_host_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(dip_pca_df_host <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef, <span class="at">data =</span> p_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co">#p_pca_host_mod # view PSTR adonis output</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="do">## run the adonis for SYMB phys</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co">#p_pca_symb_mod &lt;- adonis2(dip_pca_df_symb ~ reef * ftemp * fpco2, data = p_df, method = 'eu', permutations = 1000) # below is the model with non sig interactions removed:</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>p_pca_symb_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(dip_pca_df_symb <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef, <span class="at">data =</span> p_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum)</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co">#p_pca_symb_mod # view PSTR adonis output</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="do">## perform principal component analysis (PCA)</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>p_pca_host <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(dip_pca_df_host, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>p_pca_symb <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(dip_pca_df_symb, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected.</p>
<section id="plot-pstr" class="level3">
<h3 class="anchored" data-anchor-id="plot-pstr">Plot PSTR</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 1904 - 2056</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Temperature PCAs</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST temperature</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>dip_host_temp_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca_host, <span class="at">data =</span> p_df, </span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#shape = "fpco2",</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"ftemp"</span>,               </span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>))<span class="sc">+</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"transparent"</span>))<span class="sc">+</span></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"P. strigosa"</span>),<span class="st">" host"</span>)))</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB temperature</span></span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>dip_symb_temp_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca_symb, <span class="at">data =</span> p_df, </span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#shape = "fpco2",</span></span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>                              <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"ftemp"</span>,               </span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>))<span class="sc">+</span></span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"transparent"</span>))<span class="sc">+</span></span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"P. strigosa"</span>),<span class="st">" symbionts"</span>)))</span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a><span class="do">## pCO2 PCAs</span></span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST pco2</span></span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a>dip_host_pco2_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca_host, <span class="at">data =</span> p_df, </span>
<span id="cb126-58"><a href="#cb126-58" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb126-59"><a href="#cb126-59" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#shape = "ftemp",</span></span>
<span id="cb126-60"><a href="#cb126-60" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb126-61"><a href="#cb126-61" aria-hidden="true" tabindex="-1"></a>                              <span class="at">shape =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb126-62"><a href="#cb126-62" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-63"><a href="#cb126-63" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb126-64"><a href="#cb126-64" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb126-65"><a href="#cb126-65" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb126-66"><a href="#cb126-66" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-67"><a href="#cb126-67" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb126-68"><a href="#cb126-68" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb126-69"><a href="#cb126-69" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb126-70"><a href="#cb126-70" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb126-71"><a href="#cb126-71" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb126-72"><a href="#cb126-72" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb126-73"><a href="#cb126-73" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb126-74"><a href="#cb126-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb126-75"><a href="#cb126-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb126-76"><a href="#cb126-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb126-77"><a href="#cb126-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb126-78"><a href="#cb126-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb126-79"><a href="#cb126-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-80"><a href="#cb126-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-81"><a href="#cb126-81" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB pco2</span></span>
<span id="cb126-82"><a href="#cb126-82" aria-hidden="true" tabindex="-1"></a>dip_symb_pco2_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca_symb, <span class="at">data =</span> p_df, </span>
<span id="cb126-83"><a href="#cb126-83" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb126-84"><a href="#cb126-84" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#shape = "ftemp",</span></span>
<span id="cb126-85"><a href="#cb126-85" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb126-86"><a href="#cb126-86" aria-hidden="true" tabindex="-1"></a>                              <span class="at">shape =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb126-87"><a href="#cb126-87" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-88"><a href="#cb126-88" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb126-89"><a href="#cb126-89" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb126-90"><a href="#cb126-90" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb126-91"><a href="#cb126-91" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-92"><a href="#cb126-92" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb126-93"><a href="#cb126-93" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb126-94"><a href="#cb126-94" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb126-95"><a href="#cb126-95" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb126-96"><a href="#cb126-96" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb126-97"><a href="#cb126-97" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb126-98"><a href="#cb126-98" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb126-99"><a href="#cb126-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb126-100"><a href="#cb126-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb126-101"><a href="#cb126-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb126-102"><a href="#cb126-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb126-103"><a href="#cb126-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb126-104"><a href="#cb126-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-105"><a href="#cb126-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-106"><a href="#cb126-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-107"><a href="#cb126-107" aria-hidden="true" tabindex="-1"></a><span class="do">## Reef PCAs</span></span>
<span id="cb126-108"><a href="#cb126-108" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST reef</span></span>
<span id="cb126-109"><a href="#cb126-109" aria-hidden="true" tabindex="-1"></a>dip_host_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca_host, <span class="at">data =</span> p_df,  </span>
<span id="cb126-110"><a href="#cb126-110" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb126-111"><a href="#cb126-111" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb126-112"><a href="#cb126-112" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-113"><a href="#cb126-113" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb126-114"><a href="#cb126-114" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb126-115"><a href="#cb126-115" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb126-116"><a href="#cb126-116" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-117"><a href="#cb126-117" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb126-118"><a href="#cb126-118" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb126-119"><a href="#cb126-119" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb126-120"><a href="#cb126-120" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb126-121"><a href="#cb126-121" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="sc">-</span><span class="fl">0.6</span>, </span>
<span id="cb126-122"><a href="#cb126-122" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb126-123"><a href="#cb126-123" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb126-124"><a href="#cb126-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb126-125"><a href="#cb126-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb126-126"><a href="#cb126-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb126-127"><a href="#cb126-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb126-128"><a href="#cb126-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-129"><a href="#cb126-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-130"><a href="#cb126-130" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB reef</span></span>
<span id="cb126-131"><a href="#cb126-131" aria-hidden="true" tabindex="-1"></a>dip_symb_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(p_pca_symb, <span class="at">data =</span> p_df,  </span>
<span id="cb126-132"><a href="#cb126-132" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb126-133"><a href="#cb126-133" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb126-134"><a href="#cb126-134" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-135"><a href="#cb126-135" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb126-136"><a href="#cb126-136" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb126-137"><a href="#cb126-137" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb126-138"><a href="#cb126-138" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb126-139"><a href="#cb126-139" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb126-140"><a href="#cb126-140" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb126-141"><a href="#cb126-141" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb126-142"><a href="#cb126-142" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb126-143"><a href="#cb126-143" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="sc">-</span><span class="fl">0.6</span>, </span>
<span id="cb126-144"><a href="#cb126-144" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb126-145"><a href="#cb126-145" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb126-146"><a href="#cb126-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb126-147"><a href="#cb126-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb126-148"><a href="#cb126-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb126-149"><a href="#cb126-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected</p>
</section>
<section id="arranging-and-plotting-1" class="level3">
<h3 class="anchored" data-anchor-id="arranging-and-plotting-1">Arranging and Plotting</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2058 - 2072</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine PCAs by treatment for common legend:</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>PSTR_host_symb_temp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(dip_host_temp_pca, dip_symb_temp_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># temperature</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>PSTR_host_symb_pco2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(dip_host_pco2_pca, dip_symb_pco2_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># pCO2</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>PSTR_host_symb_reef <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(dip_host_reef_pca, dip_symb_reef_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># reef</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Add all together for final figure:</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(PSTR_host_symb_temp, PSTR_host_symb_pco2, PSTR_host_symb_reef, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/combined%20PSTR%20host%20v%20symb%20PCA%20plot-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S8_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S8_Fig.png"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S8_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">450</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected.</p>
</section>
</section>
<section id="figure-s9" class="level2">
<h2 class="anchored" data-anchor-id="figure-s9">Figure S9</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2082 - 2104</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">## subset for host or symbiont physiology</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>por_pca_df_host <span class="ot">&lt;-</span> a_df[,<span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">22</span><span class="sc">:</span><span class="dv">23</span>)] <span class="co"># host only phys (lipid, protein, carb)</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>por_pca_df_symb <span class="ot">&lt;-</span> a_df[,<span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>)] <span class="co"># symbiont only phys (chla, density, color intensity)</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="do">## run the adonis for HOST phys</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co">#a_pca_host_mod &lt;- adonis2(por_pca_df_host ~ reef * ftemp * fpco2, data = a_df, method = 'eu', permutations = 1000) # below is the model with non sig interactions removed:</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>a_pca_host_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(por_pca_df_host <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef, <span class="at">data =</span> a_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum)</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co">#a_pca_host_mod # view PAST adonis output</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="do">## run the adonis for SYMB phys</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="co">#a_pca_symb_mod &lt;- adonis2(por_pca_df_symb ~ reef * ftemp * fpco2, data = a_df, method = 'eu', permutations = 1000) # below is the model with non sig interactions removed:</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>a_pca_symb_mod <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(por_pca_df_symb <span class="sc">~</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef, <span class="at">data =</span> a_df, <span class="at">method =</span> <span class="st">'eu'</span>, <span class="at">permutations =</span> bootnum)</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a><span class="co">#a_pca_symb_mod # view PAST adonis output</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="do">## perform principal component analysis (PCA)</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>a_pca_host <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(por_pca_df_host, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>a_pca_symb <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(por_pca_df_symb, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected</p>
<section id="plot-past" class="level3">
<h3 class="anchored" data-anchor-id="plot-past">Plot PAST</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2106 - 2258</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Temperature PCAs</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST temperature</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>por_host_temp_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca_host, <span class="at">data =</span> a_df, </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#shape = "fpco2",</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"ftemp"</span>,               </span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>))<span class="sc">+</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"transparent"</span>))<span class="sc">+</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"P. astreoides"</span>),<span class="st">" host"</span>)))</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB temperature</span></span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>por_symb_temp_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca_symb, <span class="at">data =</span> a_df, </span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#shape = "fpco2",</span></span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>                              <span class="at">shape =</span> <span class="st">"ftemp"</span>,</span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"ftemp"</span>,               </span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-45"><a href="#cb130-45" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb130-46"><a href="#cb130-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb130-47"><a href="#cb130-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"#b2182b"</span>))<span class="sc">+</span></span>
<span id="cb130-48"><a href="#cb130-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"temperature"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4393c3"</span>, <span class="st">"transparent"</span>))<span class="sc">+</span></span>
<span id="cb130-49"><a href="#cb130-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb130-50"><a href="#cb130-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb130-51"><a href="#cb130-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"P. astreoides"</span>),<span class="st">" symbionts"</span>)))</span>
<span id="cb130-52"><a href="#cb130-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-53"><a href="#cb130-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-54"><a href="#cb130-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-55"><a href="#cb130-55" aria-hidden="true" tabindex="-1"></a><span class="do">## pCO2 PCAs</span></span>
<span id="cb130-56"><a href="#cb130-56" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST pco2</span></span>
<span id="cb130-57"><a href="#cb130-57" aria-hidden="true" tabindex="-1"></a>por_host_pco2_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca_host, <span class="at">data =</span> a_df, </span>
<span id="cb130-58"><a href="#cb130-58" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb130-59"><a href="#cb130-59" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#shape = "ftemp",</span></span>
<span id="cb130-60"><a href="#cb130-60" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb130-61"><a href="#cb130-61" aria-hidden="true" tabindex="-1"></a>                              <span class="at">shape =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb130-62"><a href="#cb130-62" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-63"><a href="#cb130-63" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb130-64"><a href="#cb130-64" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb130-65"><a href="#cb130-65" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb130-66"><a href="#cb130-66" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-67"><a href="#cb130-67" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb130-68"><a href="#cb130-68" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-69"><a href="#cb130-69" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb130-70"><a href="#cb130-70" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb130-71"><a href="#cb130-71" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb130-72"><a href="#cb130-72" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-73"><a href="#cb130-73" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb130-74"><a href="#cb130-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb130-75"><a href="#cb130-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb130-76"><a href="#cb130-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb130-77"><a href="#cb130-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb130-78"><a href="#cb130-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb130-79"><a href="#cb130-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-80"><a href="#cb130-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-81"><a href="#cb130-81" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB pco2</span></span>
<span id="cb130-82"><a href="#cb130-82" aria-hidden="true" tabindex="-1"></a>por_symb_pco2_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca_symb, <span class="at">data =</span> a_df, </span>
<span id="cb130-83"><a href="#cb130-83" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb130-84"><a href="#cb130-84" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#shape = "ftemp",</span></span>
<span id="cb130-85"><a href="#cb130-85" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb130-86"><a href="#cb130-86" aria-hidden="true" tabindex="-1"></a>                              <span class="at">shape =</span> <span class="st">"fpco2"</span>,</span>
<span id="cb130-87"><a href="#cb130-87" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-88"><a href="#cb130-88" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb130-89"><a href="#cb130-89" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb130-90"><a href="#cb130-90" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb130-91"><a href="#cb130-91" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-92"><a href="#cb130-92" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb130-93"><a href="#cb130-93" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-94"><a href="#cb130-94" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb130-95"><a href="#cb130-95" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb130-96"><a href="#cb130-96" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="fl">1.5</span>, </span>
<span id="cb130-97"><a href="#cb130-97" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-98"><a href="#cb130-98" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb130-99"><a href="#cb130-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb130-100"><a href="#cb130-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb130-101"><a href="#cb130-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial"</span>, <span class="st">"current"</span>, <span class="st">"end-of-century"</span>, <span class="st">"extreme"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>))<span class="sc">+</span></span>
<span id="cb130-102"><a href="#cb130-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb130-103"><a href="#cb130-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb130-104"><a href="#cb130-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-105"><a href="#cb130-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-106"><a href="#cb130-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-107"><a href="#cb130-107" aria-hidden="true" tabindex="-1"></a><span class="do">## Reef PCAs</span></span>
<span id="cb130-108"><a href="#cb130-108" aria-hidden="true" tabindex="-1"></a><span class="co"># HOST reef</span></span>
<span id="cb130-109"><a href="#cb130-109" aria-hidden="true" tabindex="-1"></a>por_host_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca_host, <span class="at">data =</span> a_df,  </span>
<span id="cb130-110"><a href="#cb130-110" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb130-111"><a href="#cb130-111" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb130-112"><a href="#cb130-112" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-113"><a href="#cb130-113" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb130-114"><a href="#cb130-114" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb130-115"><a href="#cb130-115" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb130-116"><a href="#cb130-116" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-117"><a href="#cb130-117" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb130-118"><a href="#cb130-118" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-119"><a href="#cb130-119" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb130-120"><a href="#cb130-120" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb130-121"><a href="#cb130-121" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="sc">-</span><span class="fl">0.6</span>, </span>
<span id="cb130-122"><a href="#cb130-122" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-123"><a href="#cb130-123" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb130-124"><a href="#cb130-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb130-125"><a href="#cb130-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb130-126"><a href="#cb130-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb130-127"><a href="#cb130-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb130-128"><a href="#cb130-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-129"><a href="#cb130-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-130"><a href="#cb130-130" aria-hidden="true" tabindex="-1"></a><span class="co"># SYMB reef</span></span>
<span id="cb130-131"><a href="#cb130-131" aria-hidden="true" tabindex="-1"></a>por_symb_reef_pca <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(a_pca_symb, <span class="at">data =</span> a_df,  </span>
<span id="cb130-132"><a href="#cb130-132" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colour =</span> <span class="st">"reef"</span>,</span>
<span id="cb130-133"><a href="#cb130-133" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> <span class="st">"reef"</span>,</span>
<span id="cb130-134"><a href="#cb130-134" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-135"><a href="#cb130-135" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.type =</span> <span class="st">"t"</span>, <span class="co"># displaying ellipses with multivariate t-distributions for small n producing heavier tails</span></span>
<span id="cb130-136"><a href="#cb130-136" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.level =</span> <span class="fl">0.95</span>, <span class="co"># using 95% CI for all ellipses</span></span>
<span id="cb130-137"><a href="#cb130-137" aria-hidden="true" tabindex="-1"></a>                              <span class="at">frame.alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb130-138"><a href="#cb130-138" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb130-139"><a href="#cb130-139" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.colour =</span> <span class="st">"grey29"</span>, </span>
<span id="cb130-140"><a href="#cb130-140" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-141"><a href="#cb130-141" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>,         </span>
<span id="cb130-142"><a href="#cb130-142" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.size =</span> <span class="dv">4</span>, </span>
<span id="cb130-143"><a href="#cb130-143" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.hjust =</span> <span class="sc">-</span><span class="fl">0.6</span>, </span>
<span id="cb130-144"><a href="#cb130-144" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-145"><a href="#cb130-145" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadings.label.repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb130-146"><a href="#cb130-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb130-147"><a href="#cb130-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"reef environment"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"offshore"</span>, <span class="st">"inshore"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#00a08b"</span>, <span class="st">"#e9aa2b"</span>)) <span class="sc">+</span></span>
<span id="cb130-148"><a href="#cb130-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">keyheight =</span> <span class="fl">0.3</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))), <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))) <span class="sc">+</span></span>
<span id="cb130-149"><a href="#cb130-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected</p>
</section>
<section id="arranging-and-plotting-2" class="level3">
<h3 class="anchored" data-anchor-id="arranging-and-plotting-2">Arranging and Plotting</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2260 - 2273</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine PCAs by treatment for common legend:</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>PAST_host_symb_temp <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(por_host_temp_pca, por_symb_temp_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># temperature</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>PAST_host_symb_pco2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(por_host_pco2_pca, por_symb_pco2_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># pCO2</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>PAST_host_symb_reef <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(por_host_reef_pca, por_symb_reef_pca,<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"right"</span>)  <span class="co"># reef</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Add all together for final figure:</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(PAST_host_symb_temp, PAST_host_symb_pco2, PAST_host_symb_reef, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/combined%20PAST%20host%20v%20symb%20PCA%20plot-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S9_Fig.pdf"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">useDingbats=</span><span class="cn">FALSE</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S9_Fig.png"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">650</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Supplemental_Figures/S9_Fig.tiff"</span>, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected.</p>
</section>
</section>
<section id="removed-figure-with-host-vs-symb" class="level2">
<h2 class="anchored" data-anchor-id="removed-figure-with-host-vs-symb">Removed figure with host vs symb</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2295 - 2374</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Notes for how to use PCAplast function are in earlier uses as well as in the 'CustomFunctions.R' file</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### SSID</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># host</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>ssid_host_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> s_pca_host,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> s_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>)],</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sample_ID =</span> <span class="st">"coral"</span>, </span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">num_pca =</span>  <span class="st">"all"</span>, </span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_col =</span> <span class="st">"treat2"</span>,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_lvl =</span> <span class="st">"420_28"</span>,</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">"colony"</span>)</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="co"># symbiont</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>ssid_symb_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> s_pca_symb, </span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> s_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>)],</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sample_ID =</span> <span class="st">"coral"</span>, </span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">num_pca =</span>  <span class="st">"all"</span>, </span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_col =</span> <span class="st">"treat2"</span>,</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_lvl =</span> <span class="st">"420_28"</span>,</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">"colony"</span>)</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a><span class="do">#### PSTR</span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="co"># host</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a>pstr_host_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> p_pca_host, </span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> p_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>)],</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sample_ID =</span> <span class="st">"coral"</span>, </span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>                           <span class="at">num_pca =</span>  <span class="st">"all"</span>, </span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_col =</span> <span class="st">"treat2"</span>,</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_lvl =</span> <span class="st">"420_28"</span>,</span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">"colony"</span>)</span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a><span class="co"># symbiont</span></span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a>pstr_symb_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> p_pca_symb, </span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> p_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>)],</span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sample_ID =</span> <span class="st">"coral"</span>, </span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a>                           <span class="at">num_pca =</span>  <span class="st">"all"</span>, </span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_col =</span> <span class="st">"treat2"</span>,</span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_lvl =</span> <span class="st">"420_28"</span>,</span>
<span id="cb133-40"><a href="#cb133-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">"colony"</span>)</span>
<span id="cb133-41"><a href="#cb133-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-42"><a href="#cb133-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-43"><a href="#cb133-43" aria-hidden="true" tabindex="-1"></a><span class="do">#### PAST</span></span>
<span id="cb133-44"><a href="#cb133-44" aria-hidden="true" tabindex="-1"></a><span class="co"># host</span></span>
<span id="cb133-45"><a href="#cb133-45" aria-hidden="true" tabindex="-1"></a>past_host_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> a_pca_host, </span>
<span id="cb133-46"><a href="#cb133-46" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> a_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>)],</span>
<span id="cb133-47"><a href="#cb133-47" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sample_ID =</span> <span class="st">"coral"</span>, </span>
<span id="cb133-48"><a href="#cb133-48" aria-hidden="true" tabindex="-1"></a>                           <span class="at">num_pca =</span>  <span class="st">"all"</span>, </span>
<span id="cb133-49"><a href="#cb133-49" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_col =</span> <span class="st">"treat2"</span>,</span>
<span id="cb133-50"><a href="#cb133-50" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_lvl =</span> <span class="st">"420_28"</span>,</span>
<span id="cb133-51"><a href="#cb133-51" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">"colony"</span>)</span>
<span id="cb133-52"><a href="#cb133-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-53"><a href="#cb133-53" aria-hidden="true" tabindex="-1"></a><span class="co"># symbiont</span></span>
<span id="cb133-54"><a href="#cb133-54" aria-hidden="true" tabindex="-1"></a>past_symb_dist <span class="ot">&lt;-</span> <span class="fu">PCAplast</span>(<span class="at">pca =</span> a_pca_symb, </span>
<span id="cb133-55"><a href="#cb133-55" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> a_df[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>, <span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">27</span>)],</span>
<span id="cb133-56"><a href="#cb133-56" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sample_ID =</span> <span class="st">"coral"</span>, </span>
<span id="cb133-57"><a href="#cb133-57" aria-hidden="true" tabindex="-1"></a>                           <span class="at">num_pca =</span>  <span class="st">"all"</span>, </span>
<span id="cb133-58"><a href="#cb133-58" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_col =</span> <span class="st">"treat2"</span>,</span>
<span id="cb133-59"><a href="#cb133-59" aria-hidden="true" tabindex="-1"></a>                           <span class="at">control_lvl =</span> <span class="st">"420_28"</span>,</span>
<span id="cb133-60"><a href="#cb133-60" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">"colony"</span>)</span>
<span id="cb133-61"><a href="#cb133-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-62"><a href="#cb133-62" aria-hidden="true" tabindex="-1"></a><span class="do">#### Combined data by host or symbiont</span></span>
<span id="cb133-63"><a href="#cb133-63" aria-hidden="true" tabindex="-1"></a><span class="do">## Host:</span></span>
<span id="cb133-64"><a href="#cb133-64" aria-hidden="true" tabindex="-1"></a>host_dist <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ssid_host_dist, pstr_host_dist, past_host_dist)</span>
<span id="cb133-65"><a href="#cb133-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-66"><a href="#cb133-66" aria-hidden="true" tabindex="-1"></a><span class="do">## Symbionts:</span></span>
<span id="cb133-67"><a href="#cb133-67" aria-hidden="true" tabindex="-1"></a>symb_dist <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ssid_symb_dist, pstr_symb_dist, past_symb_dist)</span>
<span id="cb133-68"><a href="#cb133-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-69"><a href="#cb133-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-70"><a href="#cb133-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-71"><a href="#cb133-71" aria-hidden="true" tabindex="-1"></a><span class="co"># add a 'part' label for combining datasets</span></span>
<span id="cb133-72"><a href="#cb133-72" aria-hidden="true" tabindex="-1"></a>host_dist<span class="sc">$</span>part <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"host"</span>, <span class="fu">nrow</span>(host_dist))</span>
<span id="cb133-73"><a href="#cb133-73" aria-hidden="true" tabindex="-1"></a>symb_dist<span class="sc">$</span>part <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"symb"</span>, <span class="fu">nrow</span>(symb_dist))</span>
<span id="cb133-74"><a href="#cb133-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-75"><a href="#cb133-75" aria-hidden="true" tabindex="-1"></a><span class="co"># combine datasets</span></span>
<span id="cb133-76"><a href="#cb133-76" aria-hidden="true" tabindex="-1"></a>combined_dist <span class="ot">&lt;-</span> <span class="fu">rbind</span>(host_dist, symb_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Everything runs as expected</p>
<section id="plasticity-analysis" class="level3">
<h3 class="anchored" data-anchor-id="plasticity-analysis">Plasticity analysis</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2376 - 2395</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Model selection (via AIC)</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>comb_dist_mod  <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> reef <span class="sc">*</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 18 columns / coefficients</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>comb_dist_mod2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> reef <span class="sc">*</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>comb_dist_mod3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> reef <span class="sc">+</span> fpco2 <span class="sc">*</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>comb_dist_mod4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> reef <span class="sc">+</span> part <span class="sc">+</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist) <span class="co"># best fit</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>comb_dist_mod5 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> reef <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>comb_dist_mod6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>comb_dist_mod7 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> species <span class="sc">*</span> part <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>comb_dist_mod8 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> reef <span class="sc">*</span> species <span class="sc">*</span> part <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 2 columns / coefficients</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>comb_dist_mod9 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist) <span class="co"># close second fit</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>comb_dist_mod10 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp) <span class="sc">+</span> reef <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist) </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>comb_dist_mod11 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp <span class="sc">+</span> reef) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check for best-fit model</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>comb_plast_aic <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(comb_dist_mod, comb_dist_mod2, comb_dist_mod3, comb_dist_mod4, comb_dist_mod5, comb_dist_mod6, comb_dist_mod7, comb_dist_mod8, comb_dist_mod9, comb_dist_mod10, comb_dist_mod11)</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(comb_plast_aic)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-model" class="level3">
<h3 class="anchored" data-anchor-id="final-model">Final Model</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2397 - 2405</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Best-fit GLMM with Gamma log link</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>comb_dist_glm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(dist <span class="sc">~</span> species <span class="sc">*</span> part <span class="sc">*</span> (fpco2 <span class="sc">+</span> ftemp) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> colony), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> combined_dist)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>comb_glm_out <span class="ot">&lt;-</span> <span class="fu">summary</span>(comb_dist_glm) <span class="co"># summary output of the GLM</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model failed to converge, but no error.</p>
</section>
<section id="bootstrapping-3" class="level3">
<h3 class="anchored" data-anchor-id="bootstrapping-3">Bootstrapping</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Pull the treatment and distance data from the model</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>newdata_comb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(comb_dist_glm<span class="sc">@</span>frame[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap distances using custom bootstrap function</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>comb_boot_out <span class="ot">&lt;-</span> <span class="fu">replicate</span>(bootnum, <span class="fu">bootFUN</span>(<span class="at">model =</span> comb_dist_glm, <span class="at">newdata =</span> newdata_comb)) </span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the mean, 95% lowerCI, and 95% upperCI from the boot matrix and add it to dataframe</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>comb_boot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(combined_dist, <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(comb_boot_out, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))))))</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(comb_boot)[<span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"estimate"</span>, <span class="st">"lowerci"</span>, <span class="st">"upperci"</span>) <span class="co"># rename mean/CI columns</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="do">## save as rda object</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(comb_boot, <span class="at">file =</span> <span class="st">"Data/Bootstrap/HostVSymb_PlastBoot.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first portion of the chunk ran smoothly, though it took several hours to run through. However, at the line where column names were assigned, there was an error that names [18] must be the same length as the vector [12]. The comb_boot frame has 12 columns, but the columns which had names being reassigned were 16-18 and didn’t exist. To solve this, I will run the code to reassign names [10:12].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Pull the treatment and distance data from the model</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>newdata_comb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(comb_dist_glm<span class="sc">@</span>frame[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap distances using custom bootstrap function</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>comb_boot_out <span class="ot">&lt;-</span> <span class="fu">replicate</span>(bootnum, <span class="fu">bootFUN</span>(<span class="at">model =</span> comb_dist_glm, <span class="at">newdata =</span> newdata_comb)) </span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the mean, 95% lowerCI, and 95% upperCI from the boot matrix and add it to dataframe</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>comb_boot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(combined_dist, <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">apply</span>(comb_boot_out, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">mean</span>(x), <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))))))</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(comb_boot)[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"estimate"</span>, <span class="st">"lowerci"</span>, <span class="st">"upperci"</span>) <span class="co"># rename mean/CI columns</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="do">## save as rda object</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(comb_boot, <span class="at">file =</span> <span class="st">"Data/Bootstrap/HostVSymb_PlastBoot.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="species-labels" class="level3">
<h3 class="anchored" data-anchor-id="species-labels">Species labels</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2422 - 2439</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load bootstrap data from above</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"Data/Bootstrap/HostVSymb_PlastBoot.rda"</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding pretty species labels for all dataframes</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>comb_boot <span class="ot">&lt;-</span> comb_boot <span class="sc">%&gt;%</span> </span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species =</span> <span class="fu">factor</span>(species, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"P"</span>, <span class="st">"A"</span>), </span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">"A) "</span>)<span class="sc">~</span> <span class="fu">italic</span>(<span class="st">" Siderastrea siderea"</span>)), </span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">"B) "</span>)<span class="sc">~</span> <span class="fu">italic</span>(<span class="st">" Pseudodiploria strigosa"</span>)), </span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">"C) "</span>)<span class="sc">~</span> <span class="fu">italic</span>(<span class="st">" Porites astreoides"</span>)))),</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">part =</span> <span class="fu">factor</span>(part, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"host"</span>, <span class="st">"symb"</span>),</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Coral host"</span>,</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Algal symbiont"</span>)),</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">factor</span>(treat2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"288_28"</span>, <span class="st">"311_31"</span>, <span class="st">"405_31"</span>, <span class="st">"673_28"</span>, <span class="st">"701_31"</span>, <span class="st">"3285_28"</span>, <span class="st">"3309_31"</span>),</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial; 28C"</span>, <span class="st">"pre industrial; 31C"</span>, <span class="st">"current; 31C"</span>, <span class="st">"end-of-century; 28C"</span>, <span class="st">"end-of-century; 31C"</span>, <span class="st">"extreme; 28C"</span>, <span class="st">"extreme; 31C"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Runs smoothly.</p>
</section>
<section id="plotting" class="level3">
<h3 class="anchored" data-anchor-id="plotting">Plotting</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2441 - 2464</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot host v symbiont plasticity per species</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comb_boot, <span class="fu">aes</span>(<span class="at">x =</span> part, <span class="at">y =</span> estimate, <span class="at">color =</span> treat, <span class="at">fill =</span> treat, <span class="at">shape =</span> treat)) <span class="sc">+</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),  <span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), <span class="at">strip.background =</span> <span class="fu">element_blank</span>(), <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>)), <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> part, <span class="at">y =</span> dist), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.3</span>, <span class="at">dodge.width =</span> <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lowerci, <span class="at">ymax =</span> upperci), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"#b2abd2"</span>, <span class="st">"#5e3c99"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#fdb863"</span>, <span class="st">"#e66101"</span>, <span class="st">"#e66101"</span>)) <span class="sc">+</span> </span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#b2abd2"</span>, <span class="st">"white"</span>, <span class="st">"white"</span>, <span class="st">"#fdb863"</span>, <span class="st">"white"</span>, <span class="st">"#e66101"</span>, <span class="st">"white"</span>)) <span class="sc">+</span> </span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"PC distance from control"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_x_discrete(labels = c("F" = "Offshore", "N" = "Inshore")) +</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_grid(species ~ part, labeller = label_parsed) +</span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>( <span class="sc">~</span> species, <span class="at">labeller =</span> label_parsed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Reproducing_Coral_Reef_Community_Structure_Analyses_files/figure-html/host%20v%20symb%20plasticity%20plots-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("Figures/Supplemental_Figures/FigureS9_hostVsymb_plasticity.pdf", width = 11, height = 3.5, useDingbats=FALSE)</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("Figures/Supplemental_Figures/FigureS9_hostVsymb_plasticity.png", width = 11, height = 3.5, dpi = 650)</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("Figures/Supplemental_Figures/FigureS9_hostVsymb_plasticity.tiff", width = 11, height = 3.5, dpi = 650)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Runs smoothly.</p>
</section>
</section>
<section id="table-a" class="level2">
<h2 class="anchored" data-anchor-id="table-a">Table A</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2479 - 2528</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create sample size table (phys)</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>N_phys_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(df_90<span class="sc">$</span>colony, <span class="fu">paste</span>(df_90<span class="sc">$</span>fpco2, df_90<span class="sc">$</span>ftemp, <span class="at">sep =</span> <span class="st">"_"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Var1, <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"reef"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Var2, <span class="fu">c</span>(<span class="st">"pCO2"</span>, <span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">colony =</span> <span class="fu">substr</span>(Species, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Species =</span> <span class="fu">substr</span>(Species, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">pCO2 =</span> <span class="fu">factor</span>(pCO2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"3290"</span>, <span class="st">"680"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial (uatm)"</span>, <span class="st">"current day (uatm)"</span>, <span class="st">"end-of-century (uatm)"</span>, <span class="st">"extreme (uatm)"</span>)),</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Treatment =</span> <span class="fu">factor</span>(Treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Species, reef, pCO2, Treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(Freq)) <span class="sc">%&gt;%</span> </span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">!=</span> <span class="st">"T"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(reef, n) <span class="sc">%&gt;%</span> </span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">paste</span>(Species, pCO2, Treatment, <span class="at">sep =</span> <span class="st">"_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">`</span><span class="at">Offshore</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">F</span><span class="st">`</span>, <span class="st">`</span><span class="at">Inshore</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">N</span><span class="st">`</span>, <span class="st">`</span><span class="at"> </span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">pCO2</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Species', 'reef', 'pCO2'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create sample size table (plasticity)</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>N_plast_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ssid_boot, pstr_boot, past_boot) </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>N_plast_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(N_plast_table<span class="sc">$</span>colony, <span class="fu">paste</span>(N_plast_table<span class="sc">$</span>fpco2, N_plast_table<span class="sc">$</span>ftemp, <span class="at">sep =</span> <span class="st">"_"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Var1, <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"reef"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Var2, <span class="fu">c</span>(<span class="st">"pCO2"</span>, <span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">colony =</span> <span class="fu">substr</span>(Species, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at"> Species</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">substr</span>(Species, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">pCO2 =</span> <span class="fu">factor</span>(pCO2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"300"</span>, <span class="st">"420"</span>, <span class="st">"3290"</span>, <span class="st">"680"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre industrial (uatm)"</span>, <span class="st">"current day (uatm)"</span>, <span class="st">"end-of-century (uatm)"</span>, <span class="st">"extreme (uatm)"</span>)),</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at"> Treatment</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(Treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"28C"</span>, <span class="st">"31C"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="st">`</span><span class="at"> Species</span><span class="st">`</span>, reef, pCO2, <span class="st">`</span><span class="at"> Treatment</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(Freq)) <span class="sc">%&gt;%</span> </span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at"> Species</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">"T"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(reef, n) <span class="sc">%&gt;%</span> </span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">paste</span>(<span class="st">`</span><span class="at"> Species</span><span class="st">`</span>, pCO2, <span class="st">`</span><span class="at"> Treatment</span><span class="st">`</span>, <span class="at">sep =</span> <span class="st">"_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">`</span><span class="at"> Offshore</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"F"</span>, <span class="st">`</span><span class="at"> Inshore</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"N"</span>, <span class="st">`</span><span class="at">  </span><span class="st">`</span> <span class="ot">=</span> pCO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by ' Species', 'reef', 'pCO2'. You can
override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine both tables into single one</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>N_table <span class="ot">&lt;-</span> <span class="fu">merge</span>(N_phys_table, N_plast_table, <span class="at">by =</span> <span class="st">"group"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Update with nice formatting</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>Table_S1 <span class="ot">&lt;-</span> <span class="fu">kable</span>(N_table[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">7</span><span class="sc">:-</span><span class="dv">9</span>)], <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Physiology N"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Plasticity N"</span> <span class="ot">=</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Siderastrea Siderea"</span>, <span class="dv">17</span>, <span class="dv">24</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Pseudodiploria strigosa"</span>, <span class="dv">9</span>, <span class="dv">16</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Porites astreoides"</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>Table_S1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Physiology N
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Plasticity N
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Offshore</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Inshore</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Offshore</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Inshore</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="8">
<td colspan="6" style="border-bottom: 1px solid"><em><strong>Porites astreoides</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">current day (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">current day (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">end-of-century (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">end-of-century (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">extreme (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">extreme (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pre industrial (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pre industrial (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even" data-grouplength="8">
<td colspan="6" style="border-bottom: 1px solid"><em><strong>Pseudodiploria strigosa</strong></em></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">current day (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">current day (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">end-of-century (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">end-of-century (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">extreme (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">extreme (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pre industrial (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pre industrial (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd" data-grouplength="8">
<td colspan="6" style="border-bottom: 1px solid"><em><strong>Siderastrea Siderea</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">current day (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">current day (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">end-of-century (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">end-of-century (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">extreme (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">extreme (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pre industrial (uatm)</td>
<td style="text-align: left;">28C</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pre industrial (uatm)</td>
<td style="text-align: left;">31C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Runs smoothly.</p>
</section>
<section id="table-b" class="level2">
<h2 class="anchored" data-anchor-id="table-b">Table B</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2538 - 2556</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine AICs for different PERMANOVAs</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>pca_AICs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Species"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"S. siderea"</span>, <span class="st">"P. strigosa"</span>, <span class="st">"P. astreoides"</span>),</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"full"</span> <span class="ot">=</span> <span class="fu">c</span>(s_pca_aic_full, p_pca_aic_full, a_pca_aic_full),</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"best"</span> <span class="ot">=</span> <span class="fu">c</span>(s_pca_aic_final, p_pca_aic_final, a_pca_aic_final))</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="do">## update formatting of text </span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>pca_AICs <span class="ot">&lt;-</span> pca_AICs <span class="sc">%&gt;%</span> </span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Full interactive model AIC"</span> <span class="ot">=</span> <span class="st">"full"</span>,</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Best fit (additive) model AIC"</span> <span class="ot">=</span> <span class="st">"best"</span>)</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>Table_S2 <span class="ot">&lt;-</span> <span class="fu">kable</span>(pca_AICs, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>Table_S2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Species</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Full interactive model AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Best fit (additive) model AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-style: italic;">S. siderea</td>
<td style="text-align: right;">692.3</td>
<td style="text-align: right;">678.5</td>
</tr>
<tr class="even">
<td style="text-align: left; font-style: italic;">P. strigosa</td>
<td style="text-align: right;">696.9</td>
<td style="text-align: right;">685.8</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-style: italic;">P. astreoides</td>
<td style="text-align: right;">500.5</td>
<td style="text-align: right;">497.1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Runs smoothly.</p>
</section>
<section id="table-c" class="level2">
<h2 class="anchored" data-anchor-id="table-c">Table C</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2566 - 2602</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Make Table S3 with correct labels</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>plast_aic <span class="ot">&lt;-</span> ssid_plast_aic <span class="sc">%&gt;%</span> </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(pstr_plast_aic, past_plast_aic) <span class="sc">%&gt;%</span> <span class="co"># combine all PERMANOVA model outputs</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Name, <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="cn">NA</span>, <span class="st">"Formula"</span>)) <span class="sc">%&gt;%</span> <span class="co"># create column for species ID and formula </span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod2b"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(ssid_dist_mod2b<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula), <span class="co"># replace model name with model</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod2"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(ssid_dist_mod2<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod3"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(ssid_dist_mod3<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod4"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(ssid_dist_mod4<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod5"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(ssid_dist_mod5<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod6b"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(past_dist_mod6b<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod6"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(ssid_dist_mod6<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(ssid_dist_mod<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"fpco2"</span>, <span class="st">"pCO2"</span>, Formula), <span class="co"># rename the formula components </span></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature"</span>, Formula),</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"reef"</span>, <span class="st">"reef environment"</span>, Formula),</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"dist ~ "</span>, <span class="st">""</span>, Formula)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AIC =</span> <span class="fu">round</span>(AIC, <span class="dv">1</span>), <span class="co"># round the columns</span></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">BIC =</span> <span class="fu">round</span>(BIC, <span class="dv">1</span>),</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2_conditional =</span> <span class="fu">round</span>(R2_conditional, <span class="dv">3</span>),</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2_marginal =</span> <span class="fu">round</span>(R2_marginal, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">`</span><span class="at">Model formula</span><span class="st">`</span> <span class="ot">=</span> Formula,</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Conditional R2</span><span class="st">`</span> <span class="ot">=</span> R2_conditional,</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Marginal R2</span><span class="st">`</span> <span class="ot">=</span> R2_marginal)</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>Table_S3 <span class="ot">&lt;-</span> <span class="fu">kable</span>(plast_aic[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>)], <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Siderastrea Siderea"</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Pseudodiploria strigosa"</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Porites astreoides"</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">11</span>,<span class="dv">17</span>), <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"lightgrey"</span>)</span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a>Table_S3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model formula</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AICc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AICc_wt</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="7">
<td colspan="4" style="border-bottom: 1px solid"><em><strong>Siderastrea Siderea</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment * pCO2 * temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">223.2</td>
<td style="text-align: right;">233.4873</td>
<td style="text-align: right;">0.0017361</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment * pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">218.8</td>
<td style="text-align: right;">223.3292</td>
<td style="text-align: right;">0.2788580</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-weight: bold; background-color: lightgrey !important;" data-indentlevel="1">reef environment * pCO2 + temperature + (1 &amp;#124; colony) + (1 &amp;#124; tank)</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">218.4</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">223.9184</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">0.2076980</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment + pCO2 * temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">225.6</td>
<td style="text-align: right;">229.3310</td>
<td style="text-align: right;">0.0138711</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment + pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">221.6</td>
<td style="text-align: right;">224.0069</td>
<td style="text-align: right;">0.1987060</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment * (pCO2 + temperature) + (1 &amp;#124; colony)</td>
<td style="text-align: right;">220.1</td>
<td style="text-align: right;">225.6018</td>
<td style="text-align: right;">0.0895125</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">222.1</td>
<td style="text-align: right;">223.9000</td>
<td style="text-align: right;">0.2096185</td>
</tr>
<tr class="odd" data-grouplength="4">
<td colspan="4" style="border-bottom: 1px solid"><em><strong>Pseudodiploria strigosa</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment * pCO2 * temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">110.7</td>
<td style="text-align: right;">148.8848</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment * pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">106.0</td>
<td style="text-align: right;">120.7046</td>
<td style="text-align: right;">0.0028901</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment + pCO2 * temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">106.9</td>
<td style="text-align: right;">121.5565</td>
<td style="text-align: right;">0.0018877</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-weight: bold; background-color: lightgrey !important;" data-indentlevel="1">pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">102.8</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">109.0213</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">0.9952222</td>
</tr>
<tr class="even" data-grouplength="7">
<td colspan="4" style="border-bottom: 1px solid"><em><strong>Porites astreoides</strong></em></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment * pCO2 * temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">153.1</td>
<td style="text-align: right;">165.7001</td>
<td style="text-align: right;">0.0000071</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment * pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">145.9</td>
<td style="text-align: right;">152.2004</td>
<td style="text-align: right;">0.0060675</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment + pCO2 * temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">146.2</td>
<td style="text-align: right;">151.3315</td>
<td style="text-align: right;">0.0093691</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment + pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">142.3</td>
<td style="text-align: right;">145.5092</td>
<td style="text-align: right;">0.1721882</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment * (pCO2 + temperature) + (1 &amp;#124; colony)</td>
<td style="text-align: right;">147.9</td>
<td style="text-align: right;">155.4966</td>
<td style="text-align: right;">0.0011675</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-weight: bold; background-color: lightgrey !important;" data-indentlevel="1">pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">140.4</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">142.8670</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">0.6452680</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2 + temperature + (1 &amp;#124; colony) + (1 &amp;#124; tank)</td>
<td style="text-align: right;">142.4</td>
<td style="text-align: right;">145.5832</td>
<td style="text-align: right;">0.1659326</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Runs smoothly.</p>
</section>
<section id="table-d" class="level2">
<h2 class="anchored" data-anchor-id="table-d">Table D</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2614 - 2646</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="do">## combine model output</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>pca_mod_out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(s_pca_mod, p_pca_mod, a_pca_mod) <span class="co"># combine all PERMANOVA model outputs</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>pca_mod_out<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pca_mod_out) <span class="co"># add column for rownames</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>pca_mod_out<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"SSID"</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">"PSTR"</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">"PAST"</span>, <span class="dv">5</span>)) <span class="co"># add column for species ID</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>pca_mod_out <span class="ot">&lt;-</span> pca_mod_out[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">7</span>)] <span class="co"># reorder columns so treatment is first</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="do">## update formatting of text </span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>pca_mod_out <span class="ot">&lt;-</span> pca_mod_out <span class="sc">%&gt;%</span> </span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SumOfSqs =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(SumOfSqs), <span class="dv">0</span>), <span class="co"># round values</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(R2), <span class="dv">3</span>),</span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">F</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">F</span><span class="st">`</span>), <span class="dv">2</span>),</span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>), <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[0-9]"</span>, <span class="st">""</span>, treat), <span class="co"># rename the treatment IDs</span></span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"fpco"</span>, <span class="st">"pCO2"</span>, treat),</span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature"</span>, treat),</span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"reef"</span>, <span class="st">"reef environment"</span>, treat)) <span class="sc">%&gt;%</span> </span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"P-value"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>, <span class="co"># rename columns</span></span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">" "</span> <span class="ot">=</span> treat,</span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sum of Squares"</span> <span class="ot">=</span> SumOfSqs)</span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb160-23"><a href="#cb160-23" aria-hidden="true" tabindex="-1"></a>Table_S4 <span class="ot">&lt;-</span> <span class="fu">kable</span>(pca_mod_out[<span class="sc">-</span><span class="dv">7</span>], <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-24"><a href="#cb160-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-25"><a href="#cb160-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Siderastrea Siderea"</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-26"><a href="#cb160-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Pseudodiploria strigosa"</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-27"><a href="#cb160-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Porites astreoides"</span>, <span class="dv">11</span>, <span class="dv">15</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb160-28"><a href="#cb160-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>), <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb160-29"><a href="#cb160-29" aria-hidden="true" tabindex="-1"></a>Table_S4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum of Squares</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="5">
<td colspan="6" style="border-bottom: 1px solid"><em><strong>Siderastrea Siderea</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">59423</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">7.93</td>
<td style="text-align: right;">0.00050</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">temperature</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9320</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">3.73</td>
<td style="text-align: right;">0.04598</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">24705</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">9.89</td>
<td style="text-align: right;">0.00200</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Residual</td>
<td style="text-align: right; font-style: italic;">80</td>
<td style="text-align: right; font-style: italic;">199740</td>
<td style="text-align: right; font-style: italic;">0.682</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Total</td>
<td style="text-align: right; font-style: italic;">85</td>
<td style="text-align: right; font-style: italic;">292988</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="odd" data-grouplength="5">
<td colspan="6" style="border-bottom: 1px solid"><em><strong>Pseudodiploria strigosa</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101796</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">14.87</td>
<td style="text-align: right;">0.00100</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">temperature</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">519372</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">75.84</td>
<td style="text-align: right;">0.00050</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">30444</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0.22289</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Residual</td>
<td style="text-align: right; font-style: italic;">71</td>
<td style="text-align: right; font-style: italic;">486202</td>
<td style="text-align: right; font-style: italic;">0.430</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Total</td>
<td style="text-align: right; font-style: italic;">76</td>
<td style="text-align: right; font-style: italic;">1130099</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="odd" data-grouplength="5">
<td colspan="6" style="border-bottom: 1px solid"><em><strong>Porites astreoides</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">724</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.47176</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">temperature</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27051</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">19.66</td>
<td style="text-align: right;">0.00050</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">30537</td>
<td style="text-align: right;">0.216</td>
<td style="text-align: right;">7.40</td>
<td style="text-align: right;">0.00050</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Residual</td>
<td style="text-align: right; font-style: italic;">62</td>
<td style="text-align: right; font-style: italic;">85309</td>
<td style="text-align: right; font-style: italic;">0.603</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Total</td>
<td style="text-align: right; font-style: italic;">67</td>
<td style="text-align: right; font-style: italic;">141417</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Runs smoothly.</p>
</section>
<section id="table-e" class="level2">
<h2 class="anchored" data-anchor-id="table-e">Table E</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2658 - 2702</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="do">## combine model output per species</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>dist_mod_out <span class="ot">&lt;-</span> <span class="fu">rbind.fill</span>(<span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">rownames</span>(ssid_glm_out[[<span class="st">"coefficients"</span>]]), ssid_glm_out[[<span class="st">"coefficients"</span>]]),</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">rownames</span>(<span class="fu">data.frame</span>(<span class="fu">unlist</span>(<span class="fu">r2_nakagawa</span>(ssid_dist_glm)))), <span class="at">Estimate =</span> <span class="fu">unlist</span>(<span class="fu">r2_nakagawa</span>(ssid_dist_glm))),</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">rownames</span>(pstr_glm_out[[<span class="st">"coefficients"</span>]]), pstr_glm_out[[<span class="st">"coefficients"</span>]]),</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">rownames</span>(<span class="fu">data.frame</span>(<span class="fu">unlist</span>(<span class="fu">r2_nakagawa</span>(pstr_dist_glm)))), <span class="at">Estimate =</span> <span class="fu">unlist</span>(<span class="fu">r2_nakagawa</span>(pstr_dist_glm))),</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">rownames</span>(past_glm_out[[<span class="st">"coefficients"</span>]]), past_glm_out[[<span class="st">"coefficients"</span>]]),</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">rownames</span>(<span class="fu">data.frame</span>(<span class="fu">unlist</span>(<span class="fu">r2_nakagawa</span>(past_dist_glm)))), <span class="at">Estimate =</span> <span class="fu">unlist</span>(<span class="fu">r2_nakagawa</span>(past_dist_glm))) )</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>dist_mod_out<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"SSID"</span>, <span class="dv">11</span>), <span class="fu">rep</span>(<span class="st">"PSTR"</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="st">"PAST"</span>, <span class="dv">7</span>)) <span class="co"># add column for species ID\</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="do">## update formatting of text </span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>dist_mod_out <span class="ot">&lt;-</span> dist_mod_out <span class="sc">%&gt;%</span> </span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Estimate =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(Estimate), <span class="dv">3</span>), <span class="co"># round values</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Std..Error =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(Std..Error), <span class="dv">3</span>),</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">t.value =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(t.value), <span class="dv">2</span>),</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pr...z.. =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(Pr...z..), <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[.]"</span>, <span class="st">" "</span>, treat), <span class="co"># rename the treatment IDs</span></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, treat),</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"2420"</span>, <span class="st">"-current"</span>, treat),</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"2680"</span>, <span class="st">"-EOC"</span>, treat),</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"23290"</span>, <span class="st">"-extreme"</span>, treat),</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[0-9]"</span>, <span class="st">""</span>, treat),</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"fpco"</span>, <span class="st">"pCO2"</span>, treat),</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature (31C)"</span>, treat),</span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"reefN"</span>, <span class="st">"reef environment (offshore)"</span>, treat),</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"R_conditionalConditionalR"</span>, <span class="st">"Conditional R2"</span>, treat),</span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"R_marginalMarginalR"</span>, <span class="st">"Marginal R2"</span>, treat)) <span class="sc">%&gt;%</span> </span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">" "</span> <span class="ot">=</span> treat, <span class="co"># rename columns</span></span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Standard error"</span> <span class="ot">=</span> Std..Error,</span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Statistic"</span> <span class="ot">=</span> t.value,</span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"P-value"</span> <span class="ot">=</span> Pr...z..)</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>Table_S5 <span class="ot">&lt;-</span> <span class="fu">kable</span>(dist_mod_out[,<span class="sc">-</span><span class="dv">6</span>], <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Siderastrea Siderea"</span>, <span class="dv">1</span>, <span class="dv">11</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Pseudodiploria strigosa"</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-39"><a href="#cb161-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Porites astreoides"</span>, <span class="dv">18</span>, <span class="dv">24</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb161-40"><a href="#cb161-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">11</span>,<span class="dv">16</span><span class="sc">:</span><span class="dv">17</span>,<span class="dv">23</span><span class="sc">:</span><span class="dv">24</span>), <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb161-41"><a href="#cb161-41" aria-hidden="true" tabindex="-1"></a>Table_S5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Standard error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="11">
<td colspan="5" style="border-bottom: 1px solid"><em><strong>Siderastrea Siderea</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">(Intercept)</td>
<td style="text-align: right;">1.050</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">187.16</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment (offshore)</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">0.084</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2-current</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">67.01</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2-EOC</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">39.36</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2-extreme</td>
<td style="text-align: right;">0.444</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">78.84</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">temperature (31C)</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.748</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment (offshore):pCO2-current</td>
<td style="text-align: right;">-0.771</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-136.94</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment (offshore):pCO2-EOC</td>
<td style="text-align: right;">-0.446</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-79.40</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">reef environment (offshore):pCO2-extreme</td>
<td style="text-align: right;">-0.330</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-58.53</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Conditional R2</td>
<td style="text-align: right; font-style: italic;">0.553</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Marginal R2</td>
<td style="text-align: right; font-style: italic;">0.313</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="odd" data-grouplength="6">
<td colspan="5" style="border-bottom: 1px solid"><em><strong>Pseudodiploria strigosa</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">(Intercept)</td>
<td style="text-align: right;">1.279</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">8.66</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2-EOC</td>
<td style="text-align: right;">-0.338</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">-1.75</td>
<td style="text-align: right;">0.080</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2-extreme</td>
<td style="text-align: right;">-0.059</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.753</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">temperature (31C)</td>
<td style="text-align: right;">0.227</td>
<td style="text-align: right;">0.173</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">0.190</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Conditional R2</td>
<td style="text-align: right; font-style: italic;">0.244</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Marginal R2</td>
<td style="text-align: right; font-style: italic;">0.198</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even" data-grouplength="7">
<td colspan="5" style="border-bottom: 1px solid"><em><strong>Porites astreoides</strong></em></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">(Intercept)</td>
<td style="text-align: right;">1.033</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">8.25</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2-current</td>
<td style="text-align: right;">-0.045</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">-0.39</td>
<td style="text-align: right;">0.694</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2-EOC</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.676</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">pCO2-extreme</td>
<td style="text-align: right;">0.124</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">1.51</td>
<td style="text-align: right;">0.131</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">temperature (31C)</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">3.82</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Conditional R2</td>
<td style="text-align: right; font-style: italic;">0.500</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Marginal R2</td>
<td style="text-align: right; font-style: italic;">0.147</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Runs smoothly.</p>
</section>
<section id="table-f" class="level2">
<h2 class="anchored" data-anchor-id="table-f">Table F</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2714 - 2741</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="do">## combine model output</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>all_pca_mod<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">rownames</span>(all_pca_mod) <span class="co"># add column for rownames</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>all_pca_mod <span class="ot">&lt;-</span> all_pca_mod[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)] <span class="co"># reorder columns so treatment is first</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="do">## update formatting of text </span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>all_pca_mod <span class="ot">&lt;-</span> all_pca_mod <span class="sc">%&gt;%</span> </span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SumOfSqs =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(SumOfSqs), <span class="dv">0</span>), <span class="co"># round values</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(R2), <span class="dv">3</span>),</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">F</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">F</span><span class="st">`</span>), <span class="dv">2</span>),</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>), <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[0-9]"</span>, <span class="st">""</span>, treat), <span class="co"># rename the treatment IDs</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"fpco"</span>, <span class="st">"pCO2"</span>, treat),</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature"</span>, treat),</span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"reef"</span>, <span class="st">"reef environment"</span>, treat)) <span class="sc">%&gt;%</span> </span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"P-value"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>, <span class="co"># rename columns</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">" "</span> <span class="ot">=</span> treat,</span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sum of Squares"</span> <span class="ot">=</span> SumOfSqs)</span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a>Table_S6 <span class="ot">&lt;-</span> <span class="fu">kable</span>(all_pca_mod, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>Table_S6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Received error of subscript out of bounds. There seems to be three rows, so the 2nd and 3rd rows will be put in italics instead to avoid subscript error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="do">## combine model output</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>all_pca_mod<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">rownames</span>(all_pca_mod) <span class="co"># add column for rownames</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>all_pca_mod <span class="ot">&lt;-</span> all_pca_mod[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)] <span class="co"># reorder columns so treatment is first</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="do">## update formatting of text </span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>all_pca_mod <span class="ot">&lt;-</span> all_pca_mod <span class="sc">%&gt;%</span> </span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SumOfSqs =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(SumOfSqs), <span class="dv">0</span>), <span class="co"># round values</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(R2), <span class="dv">3</span>),</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">F</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">F</span><span class="st">`</span>), <span class="dv">2</span>),</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>), <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[0-9]"</span>, <span class="st">""</span>, treat), <span class="co"># rename the treatment IDs</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"fpco"</span>, <span class="st">"pCO2"</span>, treat),</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature"</span>, treat),</span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"reef"</span>, <span class="st">"reef environment"</span>, treat)) <span class="sc">%&gt;%</span> </span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"P-value"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>, <span class="co"># rename columns</span></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">" "</span> <span class="ot">=</span> treat,</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sum of Squares"</span> <span class="ot">=</span> SumOfSqs)</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>Table_S6 <span class="ot">&lt;-</span> <span class="fu">kable</span>(all_pca_mod, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a>Table_S6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum of Squares</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">2588852</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">25.2</td>
<td style="text-align: right;">5e-04</td>
</tr>
<tr class="even">
<td style="text-align: left; font-style: italic;">Residual</td>
<td style="text-align: right; font-style: italic;">214</td>
<td style="text-align: right; font-style: italic;">1293204</td>
<td style="text-align: right; font-style: italic;">0.333</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-style: italic;">Total</td>
<td style="text-align: right; font-style: italic;">231</td>
<td style="text-align: right; font-style: italic;">3882055</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="table-g" class="level2">
<h2 class="anchored" data-anchor-id="table-g">Table G</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2754 - 2800</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="do">## combine model output</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>pca_host_mod_out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(s_pca_host_mod, p_pca_host_mod, a_pca_host_mod) <span class="co"># combine all PERMANOVA model outputs</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>pca_symb_mod_out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(s_pca_symb_mod, p_pca_symb_mod, a_pca_symb_mod) <span class="co"># combine all PERMANOVA model outputs</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pca_host_mod_out, pca_symb_mod_out)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pca_host_symb_mod_out) <span class="co"># add column for rownames</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"SSID"</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">"PSTR"</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">"PAST"</span>, <span class="dv">5</span>)) <span class="co"># add column for species ID</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out <span class="ot">&lt;-</span> pca_host_symb_mod_out[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">12</span>)] <span class="co"># reorder columns so treatment is first</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a><span class="do">## update formatting of text </span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out <span class="ot">&lt;-</span> pca_host_symb_mod_out <span class="sc">%&gt;%</span> </span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SumOfSqs =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(SumOfSqs), <span class="dv">0</span>), <span class="co"># round values from host</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(R2), <span class="dv">3</span>),</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">F</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">F</span><span class="st">`</span>), <span class="dv">2</span>),</span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>), <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SumOfSqs.1 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(SumOfSqs<span class="fl">.1</span>), <span class="dv">0</span>), <span class="co"># round values from symbiont</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2.1 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(R2<span class="fl">.1</span>), <span class="dv">3</span>),</span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">F.1</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">F.1</span><span class="st">`</span>), <span class="dv">2</span>),</span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Pr(&gt;F).1</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Pr(&gt;F).1</span><span class="st">`</span>), <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[0-9]"</span>, <span class="st">""</span>, treat), <span class="co"># rename the treatment IDs</span></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"fpco"</span>, <span class="st">"pCO2"</span>, treat),</span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature"</span>, treat),</span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"reef"</span>, <span class="st">"reef environment"</span>, treat)) <span class="sc">%&gt;%</span> </span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"P-value"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>, <span class="co"># rename columns</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>         <span class="st">" "</span> <span class="ot">=</span> treat,</span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sum of Squares"</span> <span class="ot">=</span> SumOfSqs,</span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Df "</span> <span class="ot">=</span> Df<span class="fl">.1</span>,</span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sum of Squares "</span> <span class="ot">=</span> SumOfSqs<span class="fl">.1</span>,</span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a>         <span class="st">"R2 "</span> <span class="ot">=</span> R2<span class="fl">.1</span>,</span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a>         <span class="st">"F "</span> <span class="ot">=</span> F<span class="fl">.1</span>,</span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a>         <span class="st">"P-value "</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Pr(&gt;F).1</span><span class="st">`</span>)</span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a>Table_S7 <span class="ot">&lt;-</span> <span class="fu">kable</span>(pca_host_symb_mod_out[<span class="sc">-</span><span class="dv">12</span>], <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Coral host"</span> <span class="ot">=</span> <span class="dv">5</span>, <span class="st">"Algal symbionts"</span> <span class="ot">=</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Siderastrea Siderea"</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Pseudodiploria strigosa"</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-41"><a href="#cb164-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Porites astreoides"</span>, <span class="dv">11</span>, <span class="dv">15</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb164-42"><a href="#cb164-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>), <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb164-43"><a href="#cb164-43" aria-hidden="true" tabindex="-1"></a>Table_S7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Received error that the replacement has 15 rows while the data has 9. The pca_host_symb_mod_out frame has 9 rows, and we are adding in 5 rows in three categories (15). So, I will change the number from 5 to 3 in each and proceed. There was also an error in the combine them with format section for an out of bounds subscript. I will change the subscripts each to be 2:3, 5:6, and 8:9 respectively so that it is within the 9 rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">## combine model output</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>pca_host_mod_out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(s_pca_host_mod, p_pca_host_mod, a_pca_host_mod) <span class="co"># combine all PERMANOVA model outputs</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>pca_symb_mod_out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(s_pca_symb_mod, p_pca_symb_mod, a_pca_symb_mod) <span class="co"># combine all PERMANOVA model outputs</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pca_host_mod_out, pca_symb_mod_out)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pca_host_symb_mod_out) <span class="co"># add column for rownames</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"SSID"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"PSTR"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"PAST"</span>, <span class="dv">3</span>)) <span class="co"># add column for species ID</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out <span class="ot">&lt;-</span> pca_host_symb_mod_out[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">12</span>)] <span class="co"># reorder columns so treatment is first</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="do">## update formatting of text </span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>pca_host_symb_mod_out <span class="ot">&lt;-</span> pca_host_symb_mod_out <span class="sc">%&gt;%</span> </span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SumOfSqs =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(SumOfSqs), <span class="dv">0</span>), <span class="co"># round values from host</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(R2), <span class="dv">3</span>),</span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">F</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">F</span><span class="st">`</span>), <span class="dv">2</span>),</span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>), <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SumOfSqs.1 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(SumOfSqs<span class="fl">.1</span>), <span class="dv">0</span>), <span class="co"># round values from symbiont</span></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2.1 =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(R2<span class="fl">.1</span>), <span class="dv">3</span>),</span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">F.1</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">F.1</span><span class="st">`</span>), <span class="dv">2</span>),</span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Pr(&gt;F).1</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Pr(&gt;F).1</span><span class="st">`</span>), <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[0-9]"</span>, <span class="st">""</span>, treat), <span class="co"># rename the treatment IDs</span></span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"fpco"</span>, <span class="st">"pCO2"</span>, treat),</span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature"</span>, treat),</span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"reef"</span>, <span class="st">"reef environment"</span>, treat)) <span class="sc">%&gt;%</span> </span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"P-value"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>, <span class="co"># rename columns</span></span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a>         <span class="st">" "</span> <span class="ot">=</span> treat,</span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sum of Squares"</span> <span class="ot">=</span> SumOfSqs,</span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Df "</span> <span class="ot">=</span> Df<span class="fl">.1</span>,</span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sum of Squares "</span> <span class="ot">=</span> SumOfSqs<span class="fl">.1</span>,</span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a>         <span class="st">"R2 "</span> <span class="ot">=</span> R2<span class="fl">.1</span>,</span>
<span id="cb165-32"><a href="#cb165-32" aria-hidden="true" tabindex="-1"></a>         <span class="st">"F "</span> <span class="ot">=</span> F<span class="fl">.1</span>,</span>
<span id="cb165-33"><a href="#cb165-33" aria-hidden="true" tabindex="-1"></a>         <span class="st">"P-value "</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Pr(&gt;F).1</span><span class="st">`</span>)</span>
<span id="cb165-34"><a href="#cb165-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-35"><a href="#cb165-35" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb165-36"><a href="#cb165-36" aria-hidden="true" tabindex="-1"></a>Table_S7 <span class="ot">&lt;-</span> <span class="fu">kable</span>(pca_host_symb_mod_out[<span class="sc">-</span><span class="dv">12</span>], <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-37"><a href="#cb165-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb165-38"><a href="#cb165-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Coral host"</span> <span class="ot">=</span> <span class="dv">5</span>, <span class="st">"Algal symbionts"</span> <span class="ot">=</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb165-39"><a href="#cb165-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Siderastrea Siderea"</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-40"><a href="#cb165-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Pseudodiploria strigosa"</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-41"><a href="#cb165-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Porites astreoides"</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb165-42"><a href="#cb165-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb165-43"><a href="#cb165-43" aria-hidden="true" tabindex="-1"></a>Table_S7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coral host
</div></th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Algal symbionts
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum of Squares</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum of Squares</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">F</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="3">
<td colspan="11" style="border-bottom: 1px solid"><em><strong>Siderastrea Siderea</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Model</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">0.06947</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">93229</td>
<td style="text-align: right;">0.318</td>
<td style="text-align: right;">7.47</td>
<td style="text-align: right;">5e-04</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Residual</td>
<td style="text-align: right; font-style: italic;">80</td>
<td style="text-align: right; font-style: italic;">30</td>
<td style="text-align: right; font-style: italic;">0.901</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">80</td>
<td style="text-align: right; font-style: italic;">199684</td>
<td style="text-align: right; font-style: italic;">0.682</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Total</td>
<td style="text-align: right; font-style: italic;">85</td>
<td style="text-align: right; font-style: italic;">34</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">85</td>
<td style="text-align: right; font-style: italic;">292913</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="11" style="border-bottom: 1px solid"><em><strong>Pseudodiploria strigosa</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Model</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.207</td>
<td style="text-align: right;">3.71</td>
<td style="text-align: right;">0.00150</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">643865</td>
<td style="text-align: right;">0.570</td>
<td style="text-align: right;">18.81</td>
<td style="text-align: right;">5e-04</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Residual</td>
<td style="text-align: right; font-style: italic;">71</td>
<td style="text-align: right; font-style: italic;">14</td>
<td style="text-align: right; font-style: italic;">0.793</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">71</td>
<td style="text-align: right; font-style: italic;">486140</td>
<td style="text-align: right; font-style: italic;">0.430</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Total</td>
<td style="text-align: right; font-style: italic;">76</td>
<td style="text-align: right; font-style: italic;">18</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">76</td>
<td style="text-align: right; font-style: italic;">1130005</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="11" style="border-bottom: 1px solid"><em><strong>Porites astreoides</strong></em></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Model</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">0.01199</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">56098</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">8.16</td>
<td style="text-align: right;">5e-04</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Residual</td>
<td style="text-align: right; font-style: italic;">62</td>
<td style="text-align: right; font-style: italic;">10</td>
<td style="text-align: right; font-style: italic;">0.807</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">62</td>
<td style="text-align: right; font-style: italic;">85288</td>
<td style="text-align: right; font-style: italic;">0.603</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em; font-style: italic;" data-indentlevel="1">Total</td>
<td style="text-align: right; font-style: italic;">67</td>
<td style="text-align: right; font-style: italic;">13</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">67</td>
<td style="text-align: right; font-style: italic;">141387</td>
<td style="text-align: right; font-style: italic;">1.000</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="cut-table-hostsymb" class="level2">
<h2 class="anchored" data-anchor-id="cut-table-hostsymb">Cut Table host/symb</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2813 - 2849</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Make Table S3 with correct labels</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>comb_plast_aic <span class="ot">&lt;-</span> comb_plast_aic <span class="sc">%&gt;%</span> </span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bind_rows(pstr_plast_aic, past_plast_aic) %&gt;% # combine all PERMANOVA model outputs</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Name, <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"Formula"</span>)) <span class="sc">%&gt;%</span> <span class="co"># create column for species ID and formula </span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod2"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod2<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula), <span class="co"># replace model name with model</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod3"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod3<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod4"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod4<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod5"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod5<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod6"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod6<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod7"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod7<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod8"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod8<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod9"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod9<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod10"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod10<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod11"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod11<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula),</span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"mod"</span>, <span class="fu">Reduce</span>(paste, <span class="fu">deparse</span>(comb_dist_mod<span class="sc">@</span>call[[<span class="st">"formula"</span>]])), Formula)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"fpco2"</span>, <span class="st">"pCO2"</span>, Formula), <span class="co"># rename the formula components </span></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature"</span>, Formula),</span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"reef"</span>, <span class="st">"reef environment"</span>, Formula),</span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">Formula =</span> <span class="fu">gsub</span>(<span class="st">"dist ~ "</span>, <span class="st">""</span>, Formula)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AIC =</span> <span class="fu">round</span>(AIC, <span class="dv">1</span>), <span class="co"># round the columns</span></span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">BIC =</span> <span class="fu">round</span>(BIC, <span class="dv">1</span>),</span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2_conditional =</span> <span class="fu">round</span>(R2_conditional, <span class="dv">3</span>),</span>
<span id="cb166-23"><a href="#cb166-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">R2_marginal =</span> <span class="fu">round</span>(R2_marginal, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb166-24"><a href="#cb166-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">`</span><span class="at">Model formula</span><span class="st">`</span> <span class="ot">=</span> Formula,</span>
<span id="cb166-25"><a href="#cb166-25" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Conditional R2</span><span class="st">`</span> <span class="ot">=</span> R2_conditional,</span>
<span id="cb166-26"><a href="#cb166-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Marginal R2</span><span class="st">`</span> <span class="ot">=</span> R2_marginal)</span>
<span id="cb166-27"><a href="#cb166-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-28"><a href="#cb166-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb166-29"><a href="#cb166-29" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb166-30"><a href="#cb166-30" aria-hidden="true" tabindex="-1"></a>Table_S8 <span class="ot">&lt;-</span> <span class="fu">kable</span>(comb_plast_aic[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>)], <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-31"><a href="#cb166-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb166-32"><a href="#cb166-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">6</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"lightgrey"</span>)</span>
<span id="cb166-33"><a href="#cb166-33" aria-hidden="true" tabindex="-1"></a>Table_S8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model formula</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AICc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AICc_wt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">species * part * reef environment * pCO2 * temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">923.1</td>
<td style="text-align: right;">982.2465</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">species * part * reef environment * pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">904.6</td>
<td style="text-align: right;">924.2461</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">species * part * reef environment + pCO2 * temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">890.2</td>
<td style="text-align: right;">893.1746</td>
<td style="text-align: right;">0.0045846</td>
</tr>
<tr class="even">
<td style="text-align: left;">species * reef environment + part + pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right;">881.2</td>
<td style="text-align: right;">882.4859</td>
<td style="text-align: right;">0.9600943</td>
</tr>
<tr class="odd">
<td style="text-align: left;">species * part * reef environment * (pCO2 + temperature) + (1 &amp;#124; colony)</td>
<td style="text-align: right;">902.1</td>
<td style="text-align: right;">932.7122</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; background-color: lightgrey !important;">species * part * pCO2 + temperature + (1 &amp;#124; colony)</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">890.2</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">895.7945</td>
<td style="text-align: right; font-weight: bold; background-color: lightgrey !important;">0.0012371</td>
</tr>
<tr class="odd">
<td style="text-align: left;">reef environment * species * part * (pCO2 + temperature) + (1 &amp;#124; colony)</td>
<td style="text-align: right;">902.1</td>
<td style="text-align: right;">932.7122</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">reef environment * species * part * (pCO2 + temperature) + (1 &amp;#124; colony)</td>
<td style="text-align: right;">902.1</td>
<td style="text-align: right;">932.7122</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">species * part * (pCO2 + temperature) + (1 &amp;#124; colony)</td>
<td style="text-align: right;">882.0</td>
<td style="text-align: right;">889.8614</td>
<td style="text-align: right;">0.0240303</td>
</tr>
<tr class="even">
<td style="text-align: left;">species * part * (pCO2 + temperature) + reef environment + (1 &amp;#124; colony)</td>
<td style="text-align: right;">883.5</td>
<td style="text-align: right;">891.9518</td>
<td style="text-align: right;">0.0084495</td>
</tr>
<tr class="odd">
<td style="text-align: left;">species * part * (pCO2 + temperature + reef environment) + (1 &amp;#124; colony)</td>
<td style="text-align: right;">883.9</td>
<td style="text-align: right;">895.2747</td>
<td style="text-align: right;">0.0016042</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Runs smoothly.</p>
<section id="glmm-table-hostsymb" class="level3">
<h3 class="anchored" data-anchor-id="glmm-table-hostsymb">GLMM Table Host/Symb</h3>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2863 - 2902</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="do">## combine model output per species</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>comb_dist_mod_out <span class="ot">&lt;-</span> <span class="fu">rbind.fill</span>(<span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">rownames</span>(comb_glm_out[[<span class="st">"coefficients"</span>]]),</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>                                      comb_glm_out[[<span class="st">"coefficients"</span>]]),</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">rownames</span>(<span class="fu">data.frame</span>(<span class="fu">unlist</span>(<span class="fu">r2_nakagawa</span>(comb_dist_glm)))),</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">Estimate =</span> <span class="fu">unlist</span>(<span class="fu">r2_nakagawa</span>(comb_dist_glm))))</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="do">## update formatting of text </span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>comb_dist_mod_out <span class="ot">&lt;-</span> comb_dist_mod_out <span class="sc">%&gt;%</span> </span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Estimate =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(Estimate), <span class="dv">3</span>), <span class="co"># round values</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Std..Error =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(Std..Error), <span class="dv">3</span>),</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">t.value =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(t.value), <span class="dv">2</span>),</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pr...z.. =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(Pr...z..), <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[.]"</span>, <span class="st">" "</span>, treat), <span class="co"># rename the treatment IDs</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, treat),</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"2420"</span>, <span class="st">"-current"</span>, treat),</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"2680"</span>, <span class="st">"-EOC"</span>, treat),</span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"23290"</span>, <span class="st">"-extreme"</span>, treat),</span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"[0-9]"</span>, <span class="st">""</span>, treat),</span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"fpco"</span>, <span class="st">"pCO2"</span>, treat),</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"ftemp"</span>, <span class="st">"temperature (31C)"</span>, treat),</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"speciesP"</span>, <span class="st">"PSTR"</span>, treat),</span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"speciesA"</span>, <span class="st">"PAST"</span>, treat),</span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"partsymb"</span>, <span class="st">"symbionts"</span>, treat),</span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"R_conditionalConditionalR"</span>, <span class="st">"Conditional R2"</span>, treat),</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">treat =</span> <span class="fu">gsub</span>(<span class="st">"R_marginalMarginalR"</span>, <span class="st">"Marginal R2"</span>, treat)) <span class="sc">%&gt;%</span> </span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">" "</span> <span class="ot">=</span> treat, <span class="co"># rename columns</span></span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Standard error"</span> <span class="ot">=</span> Std..Error,</span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Statistic"</span> <span class="ot">=</span> t.value,</span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"P-value"</span> <span class="ot">=</span> Pr...z..)</span>
<span id="cb167-31"><a href="#cb167-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-32"><a href="#cb167-32" aria-hidden="true" tabindex="-1"></a><span class="do">## combine them with format</span></span>
<span id="cb167-33"><a href="#cb167-33" aria-hidden="true" tabindex="-1"></a>Table_S9 <span class="ot">&lt;-</span> <span class="fu">kable</span>(comb_dist_mod_out, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb167-34"><a href="#cb167-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb167-35"><a href="#cb167-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">31</span><span class="sc">:</span><span class="dv">32</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb167-36"><a href="#cb167-36" aria-hidden="true" tabindex="-1"></a>Table_S9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Standard error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.800</td>
<td style="text-align: right;">0.172</td>
<td style="text-align: right;">4.66</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PSTR</td>
<td style="text-align: right;">0.199</td>
<td style="text-align: right;">0.290</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.492</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PAST</td>
<td style="text-align: right;">-0.357</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">-1.46</td>
<td style="text-align: right;">0.143</td>
</tr>
<tr class="even">
<td style="text-align: left;">symbionts</td>
<td style="text-align: right;">-0.515</td>
<td style="text-align: right;">0.185</td>
<td style="text-align: right;">-2.78</td>
<td style="text-align: right;">0.005</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pCO2-current</td>
<td style="text-align: right;">0.234</td>
<td style="text-align: right;">0.214</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">0.273</td>
</tr>
<tr class="even">
<td style="text-align: left;">pCO2-EOC</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.164</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.974</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pCO2-extreme</td>
<td style="text-align: right;">-0.021</td>
<td style="text-align: right;">0.161</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">0.895</td>
</tr>
<tr class="even">
<td style="text-align: left;">temperature (31C)</td>
<td style="text-align: right;">-0.252</td>
<td style="text-align: right;">0.128</td>
<td style="text-align: right;">-1.96</td>
<td style="text-align: right;">0.050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:symbionts</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.308</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.470</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:symbionts</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">0.270</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">0.011</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:pCO2-current</td>
<td style="text-align: right;">-0.088</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.882</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:pCO2-current</td>
<td style="text-align: right;">-0.568</td>
<td style="text-align: right;">0.339</td>
<td style="text-align: right;">-1.68</td>
<td style="text-align: right;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:pCO2-EOC</td>
<td style="text-align: right;">-0.450</td>
<td style="text-align: right;">0.298</td>
<td style="text-align: right;">-1.51</td>
<td style="text-align: right;">0.131</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:pCO2-EOC</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">0.240</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.833</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:pCO2-extreme</td>
<td style="text-align: right;">-0.154</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">-0.53</td>
<td style="text-align: right;">0.593</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:pCO2-extreme</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">0.245</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.335</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:temperature (31C)</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.774</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:temperature (31C)</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">symbionts:pCO2-current</td>
<td style="text-align: right;">-0.299</td>
<td style="text-align: right;">0.298</td>
<td style="text-align: right;">-1.00</td>
<td style="text-align: right;">0.316</td>
</tr>
<tr class="even">
<td style="text-align: left;">symbionts:pCO2-EOC</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">0.227</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.555</td>
</tr>
<tr class="odd">
<td style="text-align: left;">symbionts:pCO2-extreme</td>
<td style="text-align: right;">0.564</td>
<td style="text-align: right;">0.226</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">0.013</td>
</tr>
<tr class="even">
<td style="text-align: left;">symbionts:temperature (31C)</td>
<td style="text-align: right;">0.524</td>
<td style="text-align: right;">0.181</td>
<td style="text-align: right;">2.89</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:symbionts:pCO2-current</td>
<td style="text-align: right;">0.362</td>
<td style="text-align: right;">0.818</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.659</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:symbionts:pCO2-current</td>
<td style="text-align: right;">0.673</td>
<td style="text-align: right;">0.473</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">0.154</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:symbionts:pCO2-EOC</td>
<td style="text-align: right;">-0.179</td>
<td style="text-align: right;">0.418</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">0.669</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:symbionts:pCO2-EOC</td>
<td style="text-align: right;">-0.180</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">0.590</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:symbionts:pCO2-extreme</td>
<td style="text-align: right;">-0.482</td>
<td style="text-align: right;">0.401</td>
<td style="text-align: right;">-1.20</td>
<td style="text-align: right;">0.229</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:symbionts:pCO2-extreme</td>
<td style="text-align: right;">-0.890</td>
<td style="text-align: right;">0.341</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">0.009</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PSTR:symbionts:temperature (31C)</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">0.350</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.589</td>
</tr>
<tr class="even">
<td style="text-align: left;">PAST:symbionts:temperature (31C)</td>
<td style="text-align: right;">-0.607</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">-2.16</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-style: italic;">Conditional R2</td>
<td style="text-align: right; font-style: italic;">0.302</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left; font-style: italic;">Marginal R2</td>
<td style="text-align: right; font-style: italic;">0.150</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
<td style="text-align: right; font-style: italic;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Runs smoothly.</p>
</section>
</section>
<section id="excel-wb" class="level2">
<h2 class="anchored" data-anchor-id="excel-wb">Excel WB</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2912 - 2966</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Create workbook</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>wb <span class="ot">&lt;-</span> <span class="fu">createWorkbook</span>()</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'Table S1' worksheet</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"Table A - Sample Size"</span>) </span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">x =</span> N_table)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'Table S2' worksheet</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"Table B - PERMANOVA AIC"</span>) </span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">2</span>, <span class="at">x =</span> pca_AICs)</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">2</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'Table S3' worksheet</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"Table C - Plasticity AIC"</span>) </span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">3</span>, <span class="at">x =</span> plast_aic)</span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">3</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'Table S4' worksheet</span></span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"Table D - PERMANOVA"</span>) </span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">4</span>, <span class="at">x =</span> pca_mod_out)</span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">4</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'Table S5' worksheet</span></span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"Table E - Plasticity GLM"</span>) </span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">5</span>, <span class="at">x =</span> dist_mod_out)</span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">5</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'Table S6' worksheet</span></span>
<span id="cb168-30"><a href="#cb168-30" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"Table F - Species PERMANOVA"</span>) </span>
<span id="cb168-31"><a href="#cb168-31" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">6</span>, <span class="at">x =</span> all_pca_mod)</span>
<span id="cb168-32"><a href="#cb168-32" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">6</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-33"><a href="#cb168-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-34"><a href="#cb168-34" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'Table S7' worksheet</span></span>
<span id="cb168-35"><a href="#cb168-35" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"Table G - HostVsymb PERMANOVA"</span>) </span>
<span id="cb168-36"><a href="#cb168-36" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">7</span>, <span class="at">x =</span> pca_host_symb_mod_out)</span>
<span id="cb168-37"><a href="#cb168-37" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">7</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-38"><a href="#cb168-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-39"><a href="#cb168-39" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'HostVsymb Plast AIC' worksheet</span></span>
<span id="cb168-40"><a href="#cb168-40" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"HostVsymb Plast AIC"</span>) </span>
<span id="cb168-41"><a href="#cb168-41" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">8</span>, <span class="at">x =</span> comb_plast_aic)</span>
<span id="cb168-42"><a href="#cb168-42" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-43"><a href="#cb168-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-44"><a href="#cb168-44" aria-hidden="true" tabindex="-1"></a><span class="co"># add 'HostVsymb Plast GLM' worksheet</span></span>
<span id="cb168-45"><a href="#cb168-45" aria-hidden="true" tabindex="-1"></a><span class="fu">addWorksheet</span>(wb, <span class="st">"HostVsymb Plast GLM"</span>) </span>
<span id="cb168-46"><a href="#cb168-46" aria-hidden="true" tabindex="-1"></a><span class="fu">writeData</span>(wb, <span class="at">sheet =</span> <span class="dv">9</span>, <span class="at">x =</span> comb_dist_mod_out)</span>
<span id="cb168-47"><a href="#cb168-47" aria-hidden="true" tabindex="-1"></a><span class="fu">setColWidths</span>(wb, <span class="at">sheet =</span> <span class="dv">9</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">widths =</span> <span class="st">"auto"</span>)</span>
<span id="cb168-48"><a href="#cb168-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-49"><a href="#cb168-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-50"><a href="#cb168-50" aria-hidden="true" tabindex="-1"></a><span class="co"># save workbook</span></span>
<span id="cb168-51"><a href="#cb168-51" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWorkbook</span>(wb, <span class="at">file=</span><span class="st">"Data/Supplemental/Supplemental_Tables.xlsx"</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Runs smoothly.</p>
</section>
<section id="session-info" class="level2">
<h2 class="anchored" data-anchor-id="session-info">Session Info</h2>
<p>Taken from OA_OW_Physiology_manuscript.Rmd lines 2972 - 2976</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 26100)

Matrix products: default


locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] ggrepel_0.9.6      xts_0.14.1         zoo_1.8-13         raster_3.6-32     
 [5] sp_2.2-0           ncdf4_1.24         janitor_2.2.1      rcompanion_2.5.0  
 [9] car_3.1-3          carData_3.0-5      png_0.1-8          MASS_7.3-64       
[13] performance_0.14.0 wesanderson_0.3.7  RColorBrewer_1.1-3 gridGraphics_0.5-1
[17] corrplot_0.95      Hmisc_5.2-3        magick_2.8.5       ggpubr_0.6.0      
[21] vroom_1.6.5        lmerTest_3.1-3     lme4_1.1-36        Matrix_1.7-0      
[25] kableExtra_1.4.0   finalfit_1.0.8     ggfortify_0.4.17   cowplot_1.1.3     
[29] Rmisc_1.5.1        plyr_1.8.9         lattice_0.22-6     shiny_1.10.0      
[33] vegan_2.7-1        permute_0.9-7      lubridate_1.9.4    forcats_1.0.0     
[37] stringr_1.5.1      purrr_1.0.2        tibble_3.2.1       tidyverse_2.0.0   
[41] plotly_4.10.4      openxlsx_4.2.8     corrgram_1.14      tidyr_1.3.1       
[45] ggbiplot_0.6.2     dplyr_1.1.4        ggplot2_3.5.2      broom_1.0.7       
[49] readr_2.1.5        knitr_1.49        

loaded via a namespace (and not attached):
  [1] splines_4.4.1       later_1.4.1         cellranger_1.1.0   
  [4] rpart_4.1.23        lifecycle_1.0.4     Rdpack_2.6.3       
  [7] rstatix_0.7.2       insight_1.3.0       backports_1.5.0    
 [10] magrittr_2.0.3      rmarkdown_2.29      yaml_2.3.10        
 [13] httpuv_1.6.15       zip_2.3.1           gld_2.6.7          
 [16] minqa_1.2.8         multcomp_1.4-28     abind_1.4-8        
 [19] expm_1.0-0          nnet_7.3-19         TH.data_1.1-3      
 [22] sandwich_3.1-1      terra_1.8-54        nortest_1.0-4      
 [25] svglite_2.1.3       codetools_0.2-20    coin_1.4-3         
 [28] xml2_1.3.6          tidyselect_1.2.1    shape_1.4.6.1      
 [31] farver_2.1.2        matrixStats_1.5.0   stats4_4.4.1       
 [34] base64enc_0.1-3     jsonlite_1.8.9      e1071_1.7-16       
 [37] mitml_0.4-5         Formula_1.2-5       survival_3.6-4     
 [40] iterators_1.0.14    systemfonts_1.1.0   foreach_1.5.2      
 [43] tools_4.4.1         ragg_1.3.3          DescTools_0.99.60  
 [46] Rcpp_1.0.13-1       glue_1.8.0          gridExtra_2.3      
 [49] pan_1.9             xfun_0.50           mgcv_1.9-1         
 [52] withr_3.0.2         numDeriv_2016.8-1.1 fastmap_1.2.0      
 [55] boot_1.3-30         digest_0.6.37       timechange_0.3.0   
 [58] R6_2.5.1            mime_0.12           textshaping_0.4.1  
 [61] mice_3.18.0         colorspace_2.1-1    generics_0.1.3     
 [64] data.table_1.16.4   class_7.3-22        httr_1.4.7         
 [67] htmlwidgets_1.6.4   pkgconfig_2.0.3     gtable_0.3.6       
 [70] Exact_3.3           modeltools_0.2-24   lmtest_0.9-40      
 [73] htmltools_0.5.8.1   multcompView_0.1-10 scales_1.3.0       
 [76] lmom_3.2            snakecase_0.11.1    reformulas_0.4.0   
 [79] rstudioapi_0.17.1   tzdb_0.4.0          checkmate_2.3.2    
 [82] nlme_3.1-164        nloptr_2.2.1        proxy_0.4-27       
 [85] rootSolve_1.8.2.4   parallel_4.4.1      libcoin_1.0-10     
 [88] foreign_0.8-86      pillar_1.10.1       vctrs_0.6.5        
 [91] promises_1.3.2      jomo_2.7-6          xtable_1.8-4       
 [94] cluster_2.1.6       htmlTable_2.4.3     evaluate_1.0.1     
 [97] mvtnorm_1.3-3       cli_3.6.3           compiler_4.4.1     
[100] rlang_1.1.4         crayon_1.5.3        ggsignif_0.6.4     
[103] labeling_0.4.3      fs_1.6.5            stringi_1.8.4      
[106] viridisLite_0.4.2   munsell_0.5.1       lazyeval_0.2.2     
[109] glmnet_4.1-9        hms_1.1.3           bit64_4.5.2        
[112] haven_2.5.4         rbibutils_2.3       bit_4.5.0.1        
[115] readxl_1.4.3       </code></pre>
</div>
</div>
<p>Runs smoothly.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>